{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import\"antd/es/message/style/css\";import _message from\"antd/es/message\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(teacherUpdateTask),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(teacherDeleteTask),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(teacherToggleTaskUpload),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(teacherQueryUnsubmit),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(teacherQuerySubmit),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(teacherDownloadSubmit),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(studentUploadHomework),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(studentQuerySubmit),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(studentDeleteHomework),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(queryCourseTaskRes),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(rootHandleTask);import{takeEvery,call,put}from\"redux-saga/effects\";import{TEACHER_DELETE_TASK,TEACHER_QUERY_UNSUBMIT,TEACHER_UPDATE_TASK,TEACHER_QUERY_UNSUBMIT_SUCCESS,TEACHER_QUERY_SUBMIT,TEACHER_QUERY_SUBMIT_SUCCESS,TEACHER_TOGGLE_TASK_UPLOAD,STUDENT_QUERY_SUBMIT,STUDENT_QUERY_SUBMIT_SUCCESS,STUDENT_UPLOAD_HOMEWORK,STUDENT_UPLOAD_HOMEWORK_SUCCESS,STUDENT_DELETE_HOMEWORK,QUERY_COURSE_TASK_SUCCESS,QUERY_COURSE_TASK,TEACHER_DOWNLOAD_SUBMIT,TEACHER_DOWNLOAD_SUBMIT_SUCCESS,STUDENT_DELETE_HOMEWORK_SUCCESS,TEACHER_DELETE_TASK_SUCCESS,TEACHER_TOGGLE_TASK_UPLOAD_SUCCESS,TEACHER_UPDATE_TASK_SUCCESS,TEACHER_UPDATE_TASK_FAILED,STUDENT_UPLOAD_HOMEWORK_FAILED}from\"../../../constants/actionTypes\";import Service from\"../../../lib/Service\";//老师修改任务\nfunction teacherUpdateTask(args){var _args$args,id,taskName,file,teacherCourseId,userId,formData,res,url,Res;return _regeneratorRuntime.wrap(function teacherUpdateTask$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_args$args=args.args,id=_args$args.id,taskName=_args$args.taskName,file=_args$args.file,teacherCourseId=_args$args.teacherCourseId,userId=_args$args.userId;formData=new FormData();formData.append('id',id);formData.append('userId',userId);formData.append('taskName',taskName);formData.append('fileName',file);_context.next=9;return call(Service.post,\"teacher/updateTask\",formData);case 9:res=_context.sent;_context.t0=res.data.error_code;_context.next=_context.t0===0?13:_context.t0===-1?26:30;break;case 13:_message.success('修改任务成功~');url=\"course/queryCourseTask?teacherCourseId=\".concat(teacherCourseId);_context.next=17;return call(Service.get,url);case 17:Res=_context.sent;_context.t1=Res.data.error_code;_context.next=_context.t1===0?21:24;break;case 21:_context.next=23;return put({type:TEACHER_UPDATE_TASK_SUCCESS,payload:Res.data.data,teacherCourseId:teacherCourseId});case 23:return _context.abrupt(\"break\",25);case 24:return _context.abrupt(\"return\",0);case 25:return _context.abrupt(\"break\",30);case 26:_context.next=28;return put({type:TEACHER_UPDATE_TASK_FAILED});case 28:_message.error(\"该文件已存在！\");return _context.abrupt(\"break\",30);case 30:_context.next=34;break;case 32:_context.prev=32;_context.t2=_context[\"catch\"](0);case 34:case\"end\":return _context.stop();}}},_marked,null,[[0,32]]);}//老师删除实验任务\nfunction teacherDeleteTask(args){var _args$args2,taskId,teacherCourseId,data,res;return _regeneratorRuntime.wrap(function teacherDeleteTask$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_args$args2=args.args,taskId=_args$args2.taskId,teacherCourseId=_args$args2.teacherCourseId;data={taskId:taskId};_context2.next=5;return call(Service.post,\"teacher/deleteTask\",data);case 5:res=_context2.sent;_context2.t0=res.data.error_code;_context2.next=_context2.t0===0?9:13;break;case 9:_message.success(\"删除实验任务成功！\");_context2.next=12;return put({type:TEACHER_DELETE_TASK_SUCCESS,taskId:taskId,teacherCourseId:teacherCourseId});case 12:return _context2.abrupt(\"break\",14);case 13:return _context2.abrupt(\"return\",0);case 14:_context2.next=18;break;case 16:_context2.prev=16;_context2.t1=_context2[\"catch\"](0);case 18:case\"end\":return _context2.stop();}}},_marked2,null,[[0,16]]);}//教师开启/关闭实验任务作业的上传\nfunction teacherToggleTaskUpload(args){var _args$args3,taskId,teacherCourseId,data,res;return _regeneratorRuntime.wrap(function teacherToggleTaskUpload$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_args$args3=args.args,taskId=_args$args3.taskId,teacherCourseId=_args$args3.teacherCourseId;data={taskId:taskId};_context3.prev=2;_context3.next=5;return call(Service.post,\"teacher/toggleUpload\",data);case 5:res=_context3.sent;_context3.t0=res.data.error_code;_context3.next=_context3.t0===0?9:_context3.t0===-1?13:15;break;case 9:_message.success(\"操作成功~\");_context3.next=12;return put({type:TEACHER_TOGGLE_TASK_UPLOAD_SUCCESS,taskId:taskId,teacherCourseId:teacherCourseId});case 12:return _context3.abrupt(\"break\",16);case 13:_message.error(\"操作失败！\");return _context3.abrupt(\"break\",16);case 15:return _context3.abrupt(\"return\",0);case 16:_context3.next=20;break;case 18:_context3.prev=18;_context3.t1=_context3[\"catch\"](2);case 20:case\"end\":return _context3.stop();}}},_marked3,null,[[2,18]]);}//教师查看未交作业同学名单\nfunction teacherQueryUnsubmit(args){var _args$args4,teacherCourseId,taskId,url,res;return _regeneratorRuntime.wrap(function teacherQueryUnsubmit$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_args$args4=args.args,teacherCourseId=_args$args4.teacherCourseId,taskId=_args$args4.taskId;url=\"teacher/queryUnSubmit?teacherCourseId=\".concat(teacherCourseId,\"&taskId=\").concat(taskId);_context4.next=5;return call(Service.get,url);case 5:res=_context4.sent;_context4.t0=res.data.error_code;_context4.next=_context4.t0===0?9:12;break;case 9:_context4.next=11;return put({type:TEACHER_QUERY_UNSUBMIT_SUCCESS,payload:res.data.data});case 11:return _context4.abrupt(\"break\",13);case 12:return _context4.abrupt(\"return\",0);case 13:_context4.next=17;break;case 15:_context4.prev=15;_context4.t1=_context4[\"catch\"](0);case 17:case\"end\":return _context4.stop();}}},_marked4,null,[[0,15]]);}//教师查看已交作业名单\nfunction teacherQuerySubmit(data){var _data$data,taskId,rows,page,url,res;return _regeneratorRuntime.wrap(function teacherQuerySubmit$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_data$data=data.data,taskId=_data$data.taskId,rows=_data$data.rows,page=_data$data.page;url=\"teacher/queryWork?taskId=\".concat(taskId,\"&rows=\").concat(rows,\"&page=\").concat(page);_context5.next=5;return call(Service.get,url);case 5:res=_context5.sent;_context5.t0=res.data.error_code;_context5.next=_context5.t0===0?9:12;break;case 9:_context5.next=11;return put({type:TEACHER_QUERY_SUBMIT_SUCCESS,payload:res.data.data});case 11:return _context5.abrupt(\"break\",13);case 12:return _context5.abrupt(\"return\",0);case 13:_context5.next=17;break;case 15:_context5.prev=15;_context5.t1=_context5[\"catch\"](0);case 17:case\"end\":return _context5.stop();}}},_marked5,null,[[0,15]]);}//老师批量下载已提交作业\nfunction teacherDownloadSubmit(args){var _args$args5,taskId,userIdList,callback,hide,data,url,res;return _regeneratorRuntime.wrap(function teacherDownloadSubmit$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_args$args5=args.args,taskId=_args$args5.taskId,userIdList=_args$args5.userIdList,callback=_args$args5.callback,hide=_args$args5.hide;data={taskId:taskId,userIdList:userIdList};url=\"teacher/downloadWorks\";_context6.next=6;return call(Service.post,url,data);case 6:res=_context6.sent;hide();_context6.t0=res.data.error_code;_context6.next=_context6.t0===0?11:15;break;case 11:_context6.next=13;return put({type:TEACHER_DOWNLOAD_SUBMIT_SUCCESS,payload:res.data.data});case 13:callback(true);return _context6.abrupt(\"break\",16);case 15:return _context6.abrupt(\"return\",0);case 16:_context6.next=20;break;case 18:_context6.prev=18;_context6.t1=_context6[\"catch\"](0);case 20:case\"end\":return _context6.stop();}}},_marked6,null,[[0,18]]);}//学生上传任务作业\nfunction studentUploadHomework(args){var _args$args6,userId,studentCourseId,taskId,file,formData,res;return _regeneratorRuntime.wrap(function studentUploadHomework$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_args$args6=args.args,userId=_args$args6.userId,studentCourseId=_args$args6.studentCourseId,taskId=_args$args6.taskId,file=_args$args6.file;formData=new FormData();formData.append(\"userId\",userId);formData.append(\"studentCourseId\",studentCourseId);formData.append(\"taskId\",taskId);file.forEach(function(e){return formData.append(\"file\",e);});_context7.next=9;return call(Service.post,\"resource/uploadWorks\",formData);case 9:res=_context7.sent;_context7.t0=res.data.error_code;_context7.next=_context7.t0===0?13:_context7.t0===-1?17:20;break;case 13:res.data.data.length===0?_message.success(res.data.message):res.data.data.map(function(err){return _message.error(err.message+err.reason);});_context7.next=16;return put({type:STUDENT_UPLOAD_HOMEWORK_SUCCESS});case 16:return _context7.abrupt(\"break\",21);case 17:_context7.next=19;return put({type:STUDENT_UPLOAD_HOMEWORK_FAILED});case 19:return _context7.abrupt(\"break\",21);case 20:return _context7.abrupt(\"return\",0);case 21:_context7.next=25;break;case 23:_context7.prev=23;_context7.t1=_context7[\"catch\"](0);case 25:case\"end\":return _context7.stop();}}},_marked7,null,[[0,23]]);}//学生查看已经上传的作业\nfunction studentQuerySubmit(args){var _args$args7,userId,taskId,url,res;return _regeneratorRuntime.wrap(function studentQuerySubmit$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_args$args7=args.args,userId=_args$args7.userId,taskId=_args$args7.taskId;url=\"student/queryWork?userId=\".concat(userId,\"&taskId=\").concat(taskId);_context8.next=5;return call(Service.get,url);case 5:res=_context8.sent;_context8.t0=res.data.error_code;_context8.next=_context8.t0===0?9:12;break;case 9:_context8.next=11;return put({type:STUDENT_QUERY_SUBMIT_SUCCESS,payload:res.data.data});case 11:return _context8.abrupt(\"break\",13);case 12:return _context8.abrupt(\"return\",0);case 13:_context8.next=17;break;case 15:_context8.prev=15;_context8.t1=_context8[\"catch\"](0);case 17:case\"end\":return _context8.stop();}}},_marked8,null,[[0,15]]);}//学生删除已上传作业\nfunction studentDeleteHomework(args){var _args$args8,userId,workId,data,res;return _regeneratorRuntime.wrap(function studentDeleteHomework$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.prev=0;_args$args8=args.args,userId=_args$args8.userId,workId=_args$args8.workId;data={userId:userId,workId:workId};_context9.next=5;return call(Service.post,\"student/removeWork\",data);case 5:res=_context9.sent;_context9.t0=res.data.error_code;_context9.next=_context9.t0===0?9:_context9.t0===-1?13:14;break;case 9:_message.success(\"删除作业成功~\");_context9.next=12;return put({type:STUDENT_DELETE_HOMEWORK_SUCCESS,payload:workId});case 12:return _context9.abrupt(\"break\",15);case 13:_message.error(\"删除作业失败！\");case 14:return _context9.abrupt(\"return\",0);case 15:_context9.next=19;break;case 17:_context9.prev=17;_context9.t1=_context9[\"catch\"](0);case 19:case\"end\":return _context9.stop();}}},_marked9,null,[[0,17]]);}//老师学生获取任务详情\nfunction queryCourseTaskRes(data){var _data$teacherCourseId,teacherCourseId,courseTask,url,res;return _regeneratorRuntime.wrap(function queryCourseTaskRes$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;_data$teacherCourseId=data.teacherCourseId,teacherCourseId=_data$teacherCourseId.teacherCourseId,courseTask=_data$teacherCourseId.courseTask;url=\"course/queryCourseTask?teacherCourseId=\".concat(teacherCourseId);_context10.next=5;return call(Service.get,url);case 5:res=_context10.sent;_context10.t0=res.data.error_code;_context10.next=_context10.t0===0?9:12;break;case 9:_context10.next=11;return put({type:QUERY_COURSE_TASK_SUCCESS,payload:res.data.data,teacherCourseId:teacherCourseId,courseTask:courseTask});case 11:return _context10.abrupt(\"break\",13);case 12:return _context10.abrupt(\"return\",0);case 13:_context10.next=17;break;case 15:_context10.prev=15;_context10.t1=_context10[\"catch\"](0);case 17:case\"end\":return _context10.stop();}}},_marked10,null,[[0,15]]);}export default function rootHandleTask(){return _regeneratorRuntime.wrap(function rootHandleTask$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeEvery(TEACHER_DELETE_TASK,teacherDeleteTask);case 2:_context11.next=4;return takeEvery(TEACHER_TOGGLE_TASK_UPLOAD,teacherToggleTaskUpload);case 4:_context11.next=6;return takeEvery(TEACHER_QUERY_SUBMIT,teacherQuerySubmit);case 6:_context11.next=8;return takeEvery(TEACHER_QUERY_UNSUBMIT,teacherQueryUnsubmit);case 8:_context11.next=10;return takeEvery(TEACHER_UPDATE_TASK,teacherUpdateTask);case 10:_context11.next=12;return takeEvery(TEACHER_DOWNLOAD_SUBMIT,teacherDownloadSubmit);case 12:_context11.next=14;return takeEvery(STUDENT_QUERY_SUBMIT,studentQuerySubmit);case 14:_context11.next=16;return takeEvery(STUDENT_UPLOAD_HOMEWORK,studentUploadHomework);case 16:_context11.next=18;return takeEvery(STUDENT_DELETE_HOMEWORK,studentDeleteHomework);case 18:_context11.next=20;return takeEvery(QUERY_COURSE_TASK,queryCourseTaskRes);case 20:case\"end\":return _context11.stop();}}},_marked11);}","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/redux/sagas/courseSagas/handleTasks.js"],"names":["teacherUpdateTask","teacherDeleteTask","teacherToggleTaskUpload","teacherQueryUnsubmit","teacherQuerySubmit","teacherDownloadSubmit","studentUploadHomework","studentQuerySubmit","studentDeleteHomework","queryCourseTaskRes","rootHandleTask","takeEvery","call","put","TEACHER_DELETE_TASK","TEACHER_QUERY_UNSUBMIT","TEACHER_UPDATE_TASK","TEACHER_QUERY_UNSUBMIT_SUCCESS","TEACHER_QUERY_SUBMIT","TEACHER_QUERY_SUBMIT_SUCCESS","TEACHER_TOGGLE_TASK_UPLOAD","STUDENT_QUERY_SUBMIT","STUDENT_QUERY_SUBMIT_SUCCESS","STUDENT_UPLOAD_HOMEWORK","STUDENT_UPLOAD_HOMEWORK_SUCCESS","STUDENT_DELETE_HOMEWORK","QUERY_COURSE_TASK_SUCCESS","QUERY_COURSE_TASK","TEACHER_DOWNLOAD_SUBMIT","TEACHER_DOWNLOAD_SUBMIT_SUCCESS","STUDENT_DELETE_HOMEWORK_SUCCESS","TEACHER_DELETE_TASK_SUCCESS","TEACHER_TOGGLE_TASK_UPLOAD_SUCCESS","TEACHER_UPDATE_TASK_SUCCESS","TEACHER_UPDATE_TASK_FAILED","STUDENT_UPLOAD_HOMEWORK_FAILED","Service","args","id","taskName","file","teacherCourseId","userId","formData","FormData","append","post","res","data","error_code","success","url","get","Res","type","payload","error","taskId","rows","page","userIdList","callback","hide","studentCourseId","forEach","e","length","message","map","err","reason","workId","courseTask"],"mappings":"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","sourcesContent":["import { takeEvery, call, put } from \"redux-saga/effects\";\r\nimport {\r\n    TEACHER_DELETE_TASK,\r\n    TEACHER_QUERY_UNSUBMIT,\r\n    TEACHER_UPDATE_TASK,\r\n    TEACHER_QUERY_UNSUBMIT_SUCCESS,\r\n    TEACHER_QUERY_SUBMIT,\r\n    TEACHER_QUERY_SUBMIT_SUCCESS,\r\n    TEACHER_TOGGLE_TASK_UPLOAD,\r\n    STUDENT_QUERY_SUBMIT,\r\n    STUDENT_QUERY_SUBMIT_SUCCESS,\r\n    STUDENT_UPLOAD_HOMEWORK,\r\n    STUDENT_UPLOAD_HOMEWORK_SUCCESS,\r\n    STUDENT_DELETE_HOMEWORK,\r\n    QUERY_COURSE_TASK_SUCCESS,\r\n    QUERY_COURSE_TASK,\r\n    TEACHER_DOWNLOAD_SUBMIT,\r\n    TEACHER_DOWNLOAD_SUBMIT_SUCCESS,\r\n    STUDENT_DELETE_HOMEWORK_SUCCESS,\r\n    TEACHER_DELETE_TASK_SUCCESS,\r\n    TEACHER_TOGGLE_TASK_UPLOAD_SUCCESS,\r\n    TEACHER_UPDATE_TASK_SUCCESS, TEACHER_UPDATE_TASK_FAILED, STUDENT_UPLOAD_HOMEWORK_FAILED\r\n\r\n} from \"../../../constants/actionTypes\";\r\nimport { message } from \"antd\";\r\nimport Service from \"../../../lib/Service\";\r\n\r\n//老师修改任务\r\nfunction* teacherUpdateTask(args) {\r\n    try {\r\n        const {id, taskName, file, teacherCourseId, userId} = args.args;\r\n        const formData = new FormData();\r\n        formData.append('id',id);\r\n        formData.append('userId',userId);\r\n        formData.append('taskName',taskName);\r\n        formData.append('fileName', file);\r\n        const res = yield call(Service.post, \"teacher/updateTask\", formData);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                message.success('修改任务成功~');\r\n                const url = `course/queryCourseTask?teacherCourseId=${teacherCourseId}`;\r\n                const Res = yield call(Service.get, url);\r\n                switch (Res.data.error_code) {\r\n                    case 0:\r\n                        yield put({\r\n                            type:TEACHER_UPDATE_TASK_SUCCESS,\r\n                            payload: Res.data.data,\r\n                            teacherCourseId,\r\n                        });\r\n                        break;\r\n                    default:\r\n                        return 0;\r\n                }\r\n                break;\r\n            case -1:\r\n                yield put({\r\n                    type: TEACHER_UPDATE_TASK_FAILED,\r\n                });\r\n                message.error(\"该文件已存在！\");\r\n                break;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n\r\n//老师删除实验任务\r\nfunction *teacherDeleteTask(args) {\r\n    try {\r\n        const { taskId, teacherCourseId } = args.args;\r\n        const data = {taskId};\r\n        const res = yield call(Service.post, \"teacher/deleteTask\", data );\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                message.success(\"删除实验任务成功！\");\r\n                yield put({\r\n                    type: TEACHER_DELETE_TASK_SUCCESS,\r\n                    taskId: taskId,\r\n                    teacherCourseId: teacherCourseId\r\n                });\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n\r\n//教师开启/关闭实验任务作业的上传\r\nfunction* teacherToggleTaskUpload(args) {\r\n    const {taskId, teacherCourseId} = args.args;\r\n    const data = {taskId};\r\n    try {\r\n        const res = yield call(Service.post, \"teacher/toggleUpload\", data);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                message.success(\"操作成功~\");\r\n                yield put({\r\n                    type: TEACHER_TOGGLE_TASK_UPLOAD_SUCCESS,\r\n                    taskId: taskId,\r\n                    teacherCourseId: teacherCourseId\r\n                });\r\n                break;\r\n            case -1:\r\n                message.error(\"操作失败！\");\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n\r\n//教师查看未交作业同学名单\r\nfunction* teacherQueryUnsubmit(args){\r\n    try {\r\n        const { teacherCourseId, taskId } = args.args;\r\n        const url = `teacher/queryUnSubmit?teacherCourseId=${teacherCourseId}&taskId=${taskId}`;\r\n        const res = yield call(Service.get, url);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n              yield put({\r\n                  type: TEACHER_QUERY_UNSUBMIT_SUCCESS,\r\n                  payload: res.data.data,\r\n              });\r\n              break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n//教师查看已交作业名单\r\nfunction* teacherQuerySubmit(data){\r\n    try {\r\n        const { taskId, rows, page } = data.data;\r\n        const url = `teacher/queryWork?taskId=${taskId}&rows=${rows}&page=${page}`;\r\n        const res = yield call(Service.get, url);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: TEACHER_QUERY_SUBMIT_SUCCESS,\r\n                    payload: res.data.data,\r\n                });\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n//老师批量下载已提交作业\r\nfunction* teacherDownloadSubmit(args){\r\n    try {\r\n        const { taskId, userIdList, callback, hide } = args.args;\r\n        const data = { taskId, userIdList };\r\n        const url = `teacher/downloadWorks`;\r\n        const res = yield call(Service.post, url, data);\r\n        hide()\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: TEACHER_DOWNLOAD_SUBMIT_SUCCESS,\r\n                    payload: res.data.data\r\n                });\r\n                callback(true);\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n\r\n//学生上传任务作业\r\nfunction* studentUploadHomework(args) {\r\n    try {\r\n        const {userId, studentCourseId, taskId, file} = args.args;\r\n        const formData = new FormData;\r\n        formData.append(\"userId\", userId);\r\n        formData.append(\"studentCourseId\", studentCourseId);\r\n        formData.append(\"taskId\", taskId);\r\n        file.forEach(\r\n            e => (\r\n                formData.append(\"file\", e)\r\n            )\r\n        );\r\n        const res = yield call(Service.post, \"resource/uploadWorks\", formData);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                res.data.data.length === 0 ?\r\n                    message.success(res.data.message) :\r\n                    res.data.data.map(err => (message.error(err.message + err.reason)));\r\n                yield put({\r\n                    type: STUDENT_UPLOAD_HOMEWORK_SUCCESS\r\n                });\r\n                break;\r\n            case -1:\r\n                yield  put(\r\n                {\r\n                    type: STUDENT_UPLOAD_HOMEWORK_FAILED,\r\n                }\r\n            );\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n\r\n//学生查看已经上传的作业\r\nfunction* studentQuerySubmit(args){\r\n    try {\r\n        const { userId, taskId } = args.args;\r\n        const url = `student/queryWork?userId=${userId}&taskId=${taskId}`;\r\n        const res = yield call(Service.get, url);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: STUDENT_QUERY_SUBMIT_SUCCESS,\r\n                    payload: res.data.data,\r\n                });\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n\r\n//学生删除已上传作业\r\nfunction *studentDeleteHomework(args) {\r\n    try {\r\n        const {userId, workId} = args.args;\r\n        const data = {userId, workId};\r\n        const res = yield call(Service.post, \"student/removeWork\", data );\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                message.success(\"删除作业成功~\");\r\n                yield put({\r\n                    type: STUDENT_DELETE_HOMEWORK_SUCCESS,\r\n                    payload: workId,\r\n                });\r\n                break;\r\n            case -1:\r\n                message.error(\"删除作业失败！\");\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n//老师学生获取任务详情\r\nfunction* queryCourseTaskRes(data) {\r\n    try {\r\n        const {teacherCourseId, courseTask} = data.teacherCourseId;\r\n        const url = `course/queryCourseTask?teacherCourseId=${teacherCourseId}`;\r\n        const res = yield call(Service.get, url);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type:QUERY_COURSE_TASK_SUCCESS,\r\n                    payload: res.data.data,\r\n                    teacherCourseId,\r\n                    courseTask\r\n                });\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\n\r\nexport default function* rootHandleTask() {\r\n    yield takeEvery(TEACHER_DELETE_TASK, teacherDeleteTask);\r\n    yield takeEvery(TEACHER_TOGGLE_TASK_UPLOAD, teacherToggleTaskUpload);\r\n    yield takeEvery(TEACHER_QUERY_SUBMIT,teacherQuerySubmit);\r\n    yield takeEvery(TEACHER_QUERY_UNSUBMIT,teacherQueryUnsubmit);\r\n    yield takeEvery(TEACHER_UPDATE_TASK,teacherUpdateTask);\r\n    yield takeEvery(TEACHER_DOWNLOAD_SUBMIT, teacherDownloadSubmit);\r\n    yield takeEvery(STUDENT_QUERY_SUBMIT,studentQuerySubmit);\r\n    yield takeEvery(STUDENT_UPLOAD_HOMEWORK, studentUploadHomework);\r\n    yield takeEvery(STUDENT_DELETE_HOMEWORK, studentDeleteHomework);\r\n    yield takeEvery(QUERY_COURSE_TASK, queryCourseTaskRes);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import\"antd/es/modal/style/css\";import _Modal from\"antd/es/modal\";import\"antd/es/table/style/css\";import _Table from\"antd/es/table\";import\"antd/es/menu/style/css\";import _Menu from\"antd/es/menu\";import _objectSpread from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import\"antd/es/dropdown/style/css\";import _Dropdown from\"antd/es/dropdown\";import\"antd/es/button/style/css\";import _Button from\"antd/es/button\";import\"antd/es/input/style/css\";import _Input from\"antd/es/input\";import _slicedToArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from\"react\";import{connect}from\"react-redux\";import*as admin from\"../../redux/actionCreators/admin\";import\"../../static/style/admin.scss\";import{openNotification}from\"../../utils/commonFunction\";var mapStateToState=function mapStateToState(state){return{adminData:state.getIn([\"admin\",\"userManage\",\"adminData\"]),total:state.getIn([\"admin\",\"userManage\",\"adminTotal\"]),addAdminFlag:state.getIn([\"admin\",\"userManage\",\"addAdminFlag\"]),modifyAdminTemp:state.getIn([\"admin\",\"userManage\",\"modifyAdminTemp\"]),addVisible:state.getIn([\"admin\",\"userManage\",\"addVisible\"])};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{handleAdminData:function handleAdminData(args){dispatch(admin.fetchAdministratorData(args));},handleAddAdmin:function handleAddAdmin(args){if(args.userId.length<=6||args.userId.length>=30){openNotification(\"教师编号长度为大于等于6小于等于30的数字，请重新输入\");}else if(args.userName.length<=2||args.userName.length>=30){openNotification(\"教师姓名长度为大于等于2小于等于30的字符，请重新输入\");}else{dispatch(admin.addNewAdmin(args));}},handleModifyAdmin:function handleModifyAdmin(args){dispatch(admin.modifyAdmin(args));}};};var AdminMessage=function AdminMessage(props){var handleAdminData=props.handleAdminData,handleAddAdmin=props.handleAddAdmin,handleModifyAdmin=props.handleModifyAdmin,total=props.total,adminData=props.adminData,addAdminFlag=props.addAdminFlag,modifyAdminTemp=props.modifyAdminTemp,addVisible=props.addVisible;// console.log(adminData)\nvar userId=useRef();var userName=useRef();var phone=useRef();var academy=useState();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),id=_useState2[0],setId=_useState2[1];var isEditing=function isEditing(record){return record.id===id;};var columns=[{key:'1',title:'管理员账号',dataIndex:'userId',editable:true},{key:'2',title:'管理员姓名',render:function render(text,record){return isEditing(record)?/*#__PURE__*/React.createElement(_Input,{ref:userName,defaultValue:record.userName}):/*#__PURE__*/React.createElement(\"span\",null,record.userName);},editable:true},{key:'3',title:'学院',render:function render(text,record){return isEditing(record)?/*#__PURE__*/React.createElement(_Input,{ref:academy,defaultValue:record.academy}):/*#__PURE__*/React.createElement(\"span\",null,record.academy);},editable:true},{key:'4',title:'性别',render:function render(text,record){return isEditing(record)?/*#__PURE__*/React.createElement(_Dropdown,{overlay:menu},/*#__PURE__*/React.createElement(_Button,{style:{padding:\"0 20px\"}},sex)):/*#__PURE__*/React.createElement(\"span\",null,record.sex);},editable:true},{key:'5',title:'',dataIndex:'operation',render:function render(text,record){var editable=isEditing(record);return editable?/*#__PURE__*/React.createElement(\"a\",{onClick:function onClick(){handleModifyAdmin({userId:record.userId,userName:userName.current.state.value,academy:academy.current.state.value,sex:sex});setId(\"\");}},\"\\u4FDD\\u5B58\"):/*#__PURE__*/React.createElement(\"a\",{onClick:function onClick(){return setId(record.id);}},\"\\u4FEE\\u6539\");}}];var $columns=columns.map(function(el){if(!el.editable){return el;}return _objectSpread(_objectSpread({},el),{},{onCell:function onCell(record){return{record:record,dataIndex:el.dataIndex,title:el.title,editing:isEditing(record)};}});});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),addFlag=_useState4[0],changeAddFlag=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),$selectedRowKeys=_useState6[0],changeSelectedRowKeys=_useState6[1];var _useState7=useState(\"男\"),_useState8=_slicedToArray(_useState7,2),sex=_useState8[0],setSex=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),list=_useState10[0],setList=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),presentPage=_useState12[0],setPresentPage=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),selectedRowKeys=_useState14[0],setSelectedRowKeys=_useState14[1];var clearCheck=function clearCheck(){setSelectedRowKeys([]);};function onClick(e){setSex(e.key);}var menu=/*#__PURE__*/React.createElement(_Menu,{onClick:onClick},/*#__PURE__*/React.createElement(_Menu.Item,{style:{textAlign:\"center\"},key:\"\\u7537\"},\"\\u7537\"),/*#__PURE__*/React.createElement(_Menu.Item,{style:{textAlign:\"center\"},key:\"\\u5973\"},\"\\u5973\"));useEffect(function(){changeAddFlag(addVisible);},[addVisible]);useEffect(function(){handleAdminData(presentPage===1?{page:1,type:\"admin\"}:Math.ceil(total/10)>presentPage?{page:presentPage,type:\"admin\"}:{page:presentPage-1,type:\"admin\"});clearCheck();},[modifyAdminTemp]);useEffect(function(){changeAddFlag(false);},[addAdminFlag]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(_Button,{style:{margin:\"0.5rem 0 0 0.5rem\"},onClick:function onClick(){return changeAddFlag(true);},icon:\"plus\"},\"\\u6DFB\\u52A0\\u7BA1\\u7406\\u5458\")),/*#__PURE__*/React.createElement(_Table,{rowKey:function rowKey(record){return record.id;},size:\"middle\",columns:$columns,rowSelection:{selectedRowKeys:selectedRowKeys,onChange:function onChange(selectedRowKeys,selectedRows){var userId=selectedRows.map(function(el){return el.userId;});console.log(selectedRows);setList(userId);changeSelectedRowKeys(userId);setSelectedRowKeys(selectedRowKeys);}},dataSource:Array.from(adminData),pagination:{total:total,defaultCurrent:presentPage,onChange:function onChange(page){handleAdminData({page:page,type:\"admin\"});setPresentPage(page);}}}),/*#__PURE__*/React.createElement(_Modal,{afterClose:function afterClose(){userId.current&&userName.current&&phone.current&&setTimeout(function(){userId.current.state.value=\"\";userName.current.state.value=\"\";phone.current.state.value=\"\";},2000);},title:\"添加管理员\",visible:addFlag,onCancel:function onCancel(){changeAddFlag(false);},okText:\"\\u6DFB\\u52A0\",onOk:function onOk(){handleAddAdmin({type:\"admin\",userId:userId.current.state.value,userName:userName.current.state.value,// phone: phone.current.state.value,\nsex:sex,adminData:adminData});}},/*#__PURE__*/React.createElement(\"div\",{className:\"_wrap row row-start-center\"},/*#__PURE__*/React.createElement(\"label\",null,\"\\u7BA1\\u7406\\u5458\\u8D26\\u53F7\\uFF1A\"),/*#__PURE__*/React.createElement(_Input,{ref:userId})),/*#__PURE__*/React.createElement(\"div\",{className:\"_wrap row row-start-center\"},/*#__PURE__*/React.createElement(\"label\",null,\"\\u7BA1\\u7406\\u5458\\u59D3\\u540D\\uFF1A\"),/*#__PURE__*/React.createElement(_Input,{ref:userName})),/*#__PURE__*/React.createElement(\"div\",{className:\"_wrap row row-start-center\"},/*#__PURE__*/React.createElement(\"label\",null,\"\\u9009\\u62E9\\u6027\\u522B\\uFF1A\"),/*#__PURE__*/React.createElement(_Dropdown,{overlay:menu},/*#__PURE__*/React.createElement(_Button,{style:{padding:\"0 20px\"}},sex)))),/*#__PURE__*/React.createElement(\"style\",null,\"\\n                    ._wrap {\\n                        margin-bottom: 20px;\\n                    }\\n                    .ant-input {\\n                        width: 80%;\\n                    }\\n                    input {\\n                        margin: 20px;\\n                    }\\n                    \"));};export default connect(mapStateToState,mapDispatchToProps)(AdminMessage);","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/components/Administrator/AdminMessage.js"],"names":["React","useEffect","useRef","useState","connect","admin","openNotification","mapStateToState","state","adminData","getIn","total","addAdminFlag","modifyAdminTemp","addVisible","mapDispatchToProps","dispatch","handleAdminData","args","fetchAdministratorData","handleAddAdmin","userId","length","userName","addNewAdmin","handleModifyAdmin","modifyAdmin","AdminMessage","props","phone","academy","id","setId","isEditing","record","columns","key","title","dataIndex","editable","render","text","menu","padding","sex","current","value","$columns","map","el","onCell","editing","addFlag","changeAddFlag","$selectedRowKeys","changeSelectedRowKeys","setSex","list","setList","presentPage","setPresentPage","selectedRowKeys","setSelectedRowKeys","clearCheck","onClick","e","textAlign","page","type","Math","ceil","margin","onChange","selectedRows","console","log","Array","from","defaultCurrent","setTimeout"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {Button, Table, Input,  Modal, Dropdown, Menu} from 'antd';\r\nimport * as admin from \"../../redux/actionCreators/admin\";\r\nimport \"../../static/style/admin.scss\";\r\nimport {openNotification} from \"../../utils/commonFunction\";\r\n\r\nconst mapStateToState = state => ({\r\n    adminData: state.getIn([\"admin\", \"userManage\", \"adminData\"]),\r\n    total: state.getIn([\"admin\", \"userManage\", \"adminTotal\"]),\r\n    addAdminFlag: state.getIn([\"admin\", \"userManage\", \"addAdminFlag\"]),\r\n    modifyAdminTemp: state.getIn([\"admin\", \"userManage\", \"modifyAdminTemp\"]),\r\n    addVisible: state.getIn([\"admin\", \"userManage\", \"addVisible\"]),\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    handleAdminData(args){\r\n        dispatch(admin.fetchAdministratorData(args));\r\n    },\r\n    handleAddAdmin(args) {\r\n        if (args.userId.length <= 6 || args.userId.length >= 30){\r\n            openNotification(\"教师编号长度为大于等于6小于等于30的数字，请重新输入\")\r\n        } else if (args.userName.length <=2 || args.userName.length >=30) {\r\n            openNotification(\"教师姓名长度为大于等于2小于等于30的字符，请重新输入\")\r\n        } else {\r\n            dispatch(admin.addNewAdmin(args));  \r\n        }\r\n    },\r\n    handleModifyAdmin(args) {\r\n        dispatch(admin.modifyAdmin(args));\r\n    }\r\n});\r\n\r\nconst AdminMessage = props => {\r\n    const {\r\n        handleAdminData,\r\n        handleAddAdmin,\r\n        handleModifyAdmin,\r\n        total,\r\n        adminData,\r\n        addAdminFlag,\r\n        modifyAdminTemp,\r\n        addVisible\r\n    } = props;\r\n    // console.log(adminData)\r\n    const userId = useRef();\r\n    const userName = useRef();\r\n    const phone = useRef();\r\n    const academy = useState();\r\n    const [id, setId] = useState(\"\");\r\n    const isEditing = record => record.id === id;\r\n    const columns = [\r\n        {\r\n            key: '1',\r\n            title: '管理员账号',\r\n            dataIndex: 'userId',\r\n            editable: true\r\n        },\r\n        {\r\n            key: '2',\r\n            title: '管理员姓名',\r\n            render: (text, record) => {\r\n                return isEditing(record) ? (\r\n                    <Input ref={userName} defaultValue={record.userName} />\r\n                ):(\r\n                    <span>{record.userName}</span>\r\n                )\r\n            },\r\n            editable: true\r\n        },\r\n        {\r\n            key: '3',\r\n            title: '学院',\r\n            render: (text, record) => {\r\n                return isEditing(record) ? (\r\n                    <Input ref={academy} defaultValue={record.academy} />\r\n                ):(\r\n                    <span>{record.academy}</span>\r\n                )\r\n            },\r\n            editable: true\r\n\r\n        },\r\n        {\r\n            key: '4',\r\n            title: '性别',\r\n            render: (text, record) => {\r\n                return isEditing(record) ? (\r\n                    <Dropdown overlay={menu}>\r\n                        <Button style={{ padding: \"0 20px\" }}>{sex}</Button>\r\n                    </Dropdown>\r\n                ):(\r\n                    <span>{record.sex}</span>\r\n                )\r\n            },\r\n            editable: true\r\n        },\r\n        {\r\n            key: '5',\r\n            title: '',\r\n            dataIndex: 'operation',\r\n            render: (text, record) => {\r\n                const editable = isEditing(record);\r\n                return editable ? (\r\n                    <a\r\n                        onClick={\r\n                            () => {\r\n                                handleModifyAdmin({\r\n                                    userId: record.userId,\r\n                                    userName: userName.current.state.value,\r\n                                    academy: academy.current.state.value,\r\n                                    sex\r\n                                });\r\n                                setId(\"\")\r\n                            }\r\n                        }\r\n                    >\r\n                        保存\r\n                    </a>\r\n                ) : (\r\n                    <a\r\n                        onClick={ () => setId(record.id)}\r\n                    >\r\n                        修改\r\n                    </a>\r\n                )\r\n            }\r\n        }\r\n    ];\r\n    const $columns = columns.map(el => {\r\n        if (!el.editable) {\r\n            return el;\r\n        }\r\n        return {\r\n            ...el,\r\n            onCell: record => ({\r\n                record,\r\n                dataIndex: el.dataIndex,\r\n                title: el.title,\r\n                editing: isEditing(record),\r\n            })\r\n        }\r\n    });\r\n    const [addFlag, changeAddFlag] = useState(false);\r\n    const [$selectedRowKeys, changeSelectedRowKeys] = useState([]);\r\n    const [sex, setSex] = useState(\"男\");\r\n    const [list, setList] = useState([]);\r\n    const [presentPage, setPresentPage ] = useState(1);\r\n    const [selectedRowKeys, setSelectedRowKeys] = useState([]);\r\n    const clearCheck = () => {\r\n        setSelectedRowKeys([])\r\n    };\r\n\r\n    function onClick(e) {\r\n        setSex(e.key);\r\n    }\r\n    const menu = (\r\n        <Menu onClick={onClick}>\r\n            <Menu.Item style={{ textAlign: \"center\" }} key=\"男\">男</Menu.Item>\r\n            <Menu.Item style={{ textAlign: \"center\" }} key=\"女\">女</Menu.Item>\r\n        </Menu>\r\n    );\r\n    useEffect(() => {\r\n        changeAddFlag(addVisible)\r\n    }, [addVisible])\r\n    useEffect(()=> {\r\n        handleAdminData(\r\n            presentPage === 1 ?\r\n                {page: 1, type: \"admin\"} :\r\n                (Math.ceil(total / 10) > presentPage ?\r\n                        {page: presentPage, type: \"admin\"} :\r\n                        {page: presentPage - 1, type: \"admin\"}\r\n                ));\r\n        clearCheck()\r\n    }, [modifyAdminTemp]);\r\n    useEffect(() => {\r\n        changeAddFlag(false)\r\n    },[addAdminFlag]);\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                <Button\r\n                    style={{margin: \"0.5rem 0 0 0.5rem\"}}\r\n                    onClick={ () => changeAddFlag(true)}\r\n                    icon={\"plus\"}\r\n                >\r\n                    添加管理员\r\n                </Button>\r\n            </div>\r\n            {/* 表格 */}\r\n            <Table\r\n                rowKey={record => record.id}\r\n                size={\"middle\"}\r\n                columns={ $columns }\r\n                rowSelection={{\r\n                    selectedRowKeys,\r\n                    onChange: (selectedRowKeys, selectedRows) => {\r\n                        const userId = selectedRows.map(el => {\r\n                            return el.userId;\r\n                        });\r\n                        console.log(selectedRows);\r\n                        setList(userId);\r\n                        changeSelectedRowKeys(userId);\r\n                        setSelectedRowKeys(selectedRowKeys);\r\n                    },\r\n                }}\r\n                dataSource={ Array.from(adminData)}\r\n                pagination={{\r\n                    total,\r\n                    defaultCurrent: presentPage,\r\n                    onChange: (page) => {\r\n                        handleAdminData({page: page, type: \"admin\"});\r\n                        setPresentPage(page);\r\n                    }\r\n                }}\r\n            />\r\n            {/* 添加管理员 */}\r\n            <Modal\r\n                afterClose={() => {\r\n                    userId.current && userName.current && phone.current &&  \r\n                    setTimeout(() => {\r\n                        userId.current.state.value = \"\";\r\n                        userName.current.state.value = \"\";\r\n                        phone.current.state.value = \"\";\r\n                    }, 2000)\r\n                }}\r\n                title={\"添加管理员\"}\r\n                visible={addFlag}\r\n                onCancel={\r\n                    () => {\r\n                        changeAddFlag(false);\r\n                    }\r\n                }\r\n                okText=\"添加\"\r\n                onOk={() => {\r\n                    handleAddAdmin({\r\n                        type: \"admin\",\r\n                        userId: userId.current.state.value,\r\n                        userName: userName.current.state.value,\r\n                        // phone: phone.current.state.value,\r\n                        sex,\r\n                        adminData\r\n                    });\r\n                }}\r\n            >\r\n                <div className=\"_wrap row row-start-center\">\r\n                    <label>管理员账号：</label>\r\n                    <Input ref={userId} />\r\n                </div>\r\n                <div className=\"_wrap row row-start-center\">\r\n                    <label>管理员姓名：</label>\r\n                    <Input ref={userName} />\r\n                </div>\r\n                {/* <div className=\"_wrap row row-start-center\">\r\n                    <label>教师电话：</label>\r\n                    <Input ref={phone} />\r\n                </div> */}\r\n                <div className=\"_wrap row row-start-center\">\r\n                    <label>选择性别：</label>\r\n                    <Dropdown overlay={menu}>\r\n                        <Button style={{ padding: \"0 20px\" }}>{sex}</Button>\r\n                    </Dropdown>\r\n                </div>\r\n            </Modal>\r\n            <style>\r\n                {\r\n                    `\r\n                    ._wrap {\r\n                        margin-bottom: 20px;\r\n                    }\r\n                    .ant-input {\r\n                        width: 80%;\r\n                    }\r\n                    input {\r\n                        margin: 20px;\r\n                    }\r\n                    `\r\n                }\r\n            </style>\r\n        </>\r\n    )\r\n};\r\n\r\nexport default connect(mapStateToState, mapDispatchToProps)(AdminMessage);\r\n"]},"metadata":{},"sourceType":"module"}
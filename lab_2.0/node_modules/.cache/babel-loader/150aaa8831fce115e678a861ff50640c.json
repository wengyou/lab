{"ast":null,"code":"import \"antd/es/table/style/css\";\nimport _Table from \"antd/es/table\";\nimport \"antd/es/upload/style/css\";\nimport _Upload from \"antd/es/upload\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nimport _slicedToArray from \"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport \"antd/es/select/style/css\";\nimport _Select from \"antd/es/select\";\nimport \"antd/es/input/style/css\";\nimport _Input from \"antd/es/input\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\projects\\\\lab\\\\lab_2.0\\\\src\\\\components\\\\Administrator\\\\StudySoftware.js\";\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as admin from \"../../redux/actionCreators/admin\";\nimport * as resource from \"../../redux/actionCreators/resource\";\nimport \"../../static/style/admin.scss\";\nvar Search = _Input.Search;\nvar InputGroup = _Input.Group;\nvar Option = _Select.Option;\n\nvar mapStateToState = function mapStateToState(state) {\n  return {\n    softwareData: state.getIn([\"admin\", \"resourceManage\", \"softwareData\"]),\n    total: state.getIn([\"admin\", \"resourceManage\", \"softwareTotal\"]),\n    userId: state.getIn([\"userMana\", \"common\", \"userId\"]),\n    page: state.getIn([\"admin\", \"resourceManage\", \"softwarePage\"]),\n    temp: state.getIn([\"admin\", \"resourceManage\", \"temp\"]),\n    searchFlag: state.getIn([\"admin\", \"resourceManage\", \"softwareSearchFlag\"]),\n    softwareDataTemp: state.getIn([\"resource\", \"resource\", \"softwareDataTemp\"])\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    handleAdminSoftwareData: function handleAdminSoftwareData(args) {\n      dispatch(admin.fetchAdminSoftwareData(args));\n    },\n    handleDeleteSoftwareData: function handleDeleteSoftwareData(args) {\n      dispatch(admin.deleteSoftwareData(args));\n    },\n    handleSearchSoftwareData: function handleSearchSoftwareData(args) {\n      dispatch(admin.searchSoftwareData(args));\n    },\n    handleImportSoftware: function handleImportSoftware(args) {\n      dispatch(admin.importSoftware(args));\n    },\n    handleDownloadSoftware: function handleDownloadSoftware(args) {\n      dispatch(resource.downloadSoftware(args));\n    }\n  };\n};\n\nvar StudySoftware = function StudySoftware(props) {\n  var temp = props.temp,\n      softwareDataTemp = props.softwareDataTemp,\n      total = props.total,\n      handleAdminSoftwareData = props.handleAdminSoftwareData,\n      handleDeleteSoftwareData = props.handleDeleteSoftwareData,\n      handleSearchSoftwareData = props.handleSearchSoftwareData,\n      handleImportSoftware = props.handleImportSoftware,\n      handleDownloadSoftware = props.handleDownloadSoftware,\n      softwareData = props.softwareData,\n      userId = props.userId,\n      page = props.page,\n      searchFlag = props.searchFlag;\n  var columns = [{\n    key: '1',\n    title: '软件名称',\n    dataIndex: 'title'\n  }, {\n    key: '2',\n    title: '大小',\n    dataIndex: 'size'\n  }, {\n    key: '3',\n    title: '上传人',\n    dataIndex: 'userName'\n  }, {\n    key: '4',\n    title: '上传时间',\n    dataIndex: 'addTime'\n  }, {\n    key: '5',\n    title: '下载次数',\n    dataIndex: 'downloadNum'\n  }, {\n    key: '6',\n    title: '软件下载',\n    dataIndex: \"url\",\n    render: function render(text, record) {\n      return /*#__PURE__*/React.createElement(\"a\", {\n        download: {\n          text: text\n        }.text,\n        href: {\n          text: text\n        }.text,\n        onClick: function onClick() {\n          handleDownloadSoftware({\n            id: record.id,\n            type: \"software\"\n          });\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 17\n        }\n      }, \"\\u4E0B\\u8F7D\");\n    }\n  }];\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      $selectedRowKeys = _useState2[0],\n      changeSelectedRowKeys = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      list = _useState4[0],\n      setList = _useState4[1];\n\n  var _useState5 = useState(1),\n      _useState6 = _slicedToArray(_useState5, 2),\n      current = _useState6[0],\n      setCurrent = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      selectedRowKeys = _useState8[0],\n      setSelectedRowKeys = _useState8[1];\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      file = _useState10[0],\n      setFile = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      value = _useState12[0],\n      setValue = _useState12[1];\n\n  var _useState13 = useState(1),\n      _useState14 = _slicedToArray(_useState13, 2),\n      presentPage = _useState14[0],\n      setPresentPage = _useState14[1];\n\n  var _useState15 = useState(true),\n      _useState16 = _slicedToArray(_useState15, 2),\n      deleteBtn = _useState16[0],\n      setDeleteBtn = _useState16[1];\n\n  var flag = \"softwareName\";\n\n  var clearCheck = function clearCheck() {\n    setSelectedRowKeys([]);\n  };\n\n  useEffect(function () {\n    handleAdminSoftwareData(presentPage === 1 ? {\n      page: 1,\n      type: \"software\"\n    } : Math.ceil(total / 10) > presentPage ? {\n      page: presentPage,\n      type: \"software\"\n    } : {\n      page: presentPage - 1,\n      type: \"software\"\n    });\n  }, [temp, softwareDataTemp]);\n  useEffect(function () {\n    setCurrent(page);\n  }, [page]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"adminTop\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(_Upload, {\n    style: {\n      marginLeft: \"0.5rem\"\n    },\n    beforeUpload: function beforeUpload(file, FileList) {\n      setFile(file);\n    },\n    customRequest: function customRequest() {\n      handleImportSoftware({\n        type: \"software\",\n        userId: userId,\n        file: file\n      });\n    },\n    showUploadList: false,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(_Button, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(_Icon, {\n    type: \"upload\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 25\n    }\n  }), \" \\u4E0A\\u4F20\\u8F6F\\u4EF6\")), /*#__PURE__*/React.createElement(_Button, {\n    disabled: deleteBtn,\n    style: {\n      marginLeft: \"0.5rem\"\n    },\n    icon: \"close\",\n    onClick: function onClick() {\n      handleDeleteSoftwareData({\n        list: list,\n        type: \"software\",\n        userId: userId\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  }, \"\\u5220\\u9664\\u8F6F\\u4EF6\"), /*#__PURE__*/React.createElement(InputGroup, {\n    compact: true,\n    style: {\n      display: \"flex\",\n      flexWrap: \"nowrap\",\n      width: \"20rem\",\n      marginLeft: \"0.5rem\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(_Select, {\n    defaultValue: \"softwareName\",\n    onChange: function onChange(value) {\n      return flag = value;\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Option, {\n    value: \"softwareName\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 25\n    }\n  }, \"\\u8F6F\\u4EF6\\u540D\"), /*#__PURE__*/React.createElement(Option, {\n    value: \"userName\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 25\n    }\n  }, \"\\u4E0A\\u4F20\\u4EBA\")), /*#__PURE__*/React.createElement(Search, {\n    placeholder: \"请输入搜索内容\",\n    onSearch: function onSearch(value) {\n      handleSearchSoftwareData({\n        page: 1,\n        value: value,\n        type: \"software\",\n        flag: flag\n      });\n      setValue(value);\n    },\n    enterButton: true,\n    style: {\n      width: \"16rem\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(_Table, {\n    tableLayout: \"fixed\",\n    rowKey: function rowKey(record) {\n      return record.id;\n    },\n    columns: columns,\n    rowSelection: {\n      selectedRowKeys: selectedRowKeys,\n      onChange: function onChange(selectedRowKeys, selectedRows) {\n        var resourceId = selectedRows.map(function (el) {\n          return el.id;\n        });\n        setList(resourceId);\n        changeSelectedRowKeys(resourceId);\n        setSelectedRowKeys(selectedRowKeys);\n        selectedRowKeys.length > 0 ? setDeleteBtn(false) : setDeleteBtn(true);\n      }\n    },\n    dataSource: Array.from(softwareData),\n    pagination: {\n      total: total,\n      current: current,\n      onChange: function onChange(page) {\n        !searchFlag ? handleAdminSoftwareData({\n          page: page,\n          type: \"software\"\n        }) : handleSearchSoftwareData({\n          page: page,\n          value: value,\n          type: \"software\",\n          flag: flag\n        });\n        clearCheck();\n        setPresentPage(page);\n      }\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 13\n    }\n  }));\n};\n\nexport default connect(mapStateToState, mapDispatchToProps)(StudySoftware);","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/components/Administrator/StudySoftware.js"],"names":["React","useEffect","useRef","useState","connect","admin","resource","Search","InputGroup","Group","Option","mapStateToState","state","softwareData","getIn","total","userId","page","temp","searchFlag","softwareDataTemp","mapDispatchToProps","dispatch","handleAdminSoftwareData","args","fetchAdminSoftwareData","handleDeleteSoftwareData","deleteSoftwareData","handleSearchSoftwareData","searchSoftwareData","handleImportSoftware","importSoftware","handleDownloadSoftware","downloadSoftware","StudySoftware","props","columns","key","title","dataIndex","render","text","record","id","type","$selectedRowKeys","changeSelectedRowKeys","list","setList","current","setCurrent","selectedRowKeys","setSelectedRowKeys","file","setFile","value","setValue","presentPage","setPresentPage","deleteBtn","setDeleteBtn","flag","clearCheck","Math","ceil","marginLeft","FileList","display","flexWrap","width","onChange","selectedRows","resourceId","map","el","length","Array","from"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {Button, Table, Input, Select,Upload, Icon} from 'antd';\r\nimport * as admin from \"../../redux/actionCreators/admin\";\r\nimport * as resource from \"../../redux/actionCreators/resource\";\r\nimport \"../../static/style/admin.scss\";\r\nconst { Search } = Input;\r\nconst InputGroup = Input.Group;\r\nconst { Option } = Select;\r\n\r\nconst mapStateToState = state => ({\r\n    softwareData: state.getIn([\"admin\", \"resourceManage\", \"softwareData\"]),\r\n    total: state.getIn([\"admin\", \"resourceManage\", \"softwareTotal\"]),\r\n    userId: state.getIn([\"userMana\", \"common\", \"userId\"]),\r\n    page: state.getIn([\"admin\", \"resourceManage\", \"softwarePage\"]),\r\n    temp: state.getIn([\"admin\", \"resourceManage\", \"temp\"]),\r\n    searchFlag: state.getIn([\"admin\", \"resourceManage\", \"softwareSearchFlag\"]),\r\n    softwareDataTemp: state.getIn([\"resource\", \"resource\", \"softwareDataTemp\"])\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    handleAdminSoftwareData(args) {\r\n        dispatch(admin.fetchAdminSoftwareData(args))\r\n    },\r\n    handleDeleteSoftwareData(args) {\r\n        dispatch(admin.deleteSoftwareData(args))\r\n    },\r\n    handleSearchSoftwareData(args) {\r\n        dispatch(admin.searchSoftwareData(args));\r\n    },\r\n    handleImportSoftware(args) {\r\n        dispatch(admin.importSoftware(args));\r\n    },\r\n    handleDownloadSoftware(args) {\r\n        dispatch(resource.downloadSoftware(args));\r\n    }\r\n});\r\n\r\nconst StudySoftware = props => {\r\n    const {\r\n        temp,\r\n        softwareDataTemp,\r\n        total,\r\n        handleAdminSoftwareData,\r\n        handleDeleteSoftwareData,\r\n        handleSearchSoftwareData,\r\n        handleImportSoftware,\r\n        handleDownloadSoftware,\r\n        softwareData,\r\n        userId,\r\n        page,\r\n        searchFlag,\r\n    } = props;\r\n    const columns = [\r\n        {\r\n            key: '1',\r\n            title: '软件名称',\r\n            dataIndex: 'title',\r\n        },\r\n        {\r\n            key: '2',\r\n            title: '大小',\r\n            dataIndex: 'size',\r\n        },\r\n        {\r\n            key: '3',\r\n            title: '上传人',\r\n            dataIndex: 'userName',\r\n        },\r\n        {\r\n            key: '4',\r\n            title: '上传时间',\r\n            dataIndex: 'addTime',\r\n        },\r\n        {\r\n            key: '5',\r\n            title: '下载次数',\r\n            dataIndex: 'downloadNum'\r\n        },\r\n        {\r\n            key: '6',\r\n            title: '软件下载',\r\n            dataIndex: \"url\",\r\n            render: (text, record) => (\r\n                <a\r\n                    download={{text}.text}\r\n                    href={{text}.text}\r\n                    onClick={\r\n                        () => {\r\n                            handleDownloadSoftware({\r\n                                id: record.id,\r\n                                type: \"software\"\r\n                            });\r\n                        }\r\n                    }\r\n                >\r\n                    下载\r\n                </a>\r\n            )\r\n        }\r\n    ];\r\n    const [$selectedRowKeys, changeSelectedRowKeys] = useState([]);\r\n    const [list, setList] = useState([]);\r\n    const [current, setCurrent ] = useState(1);\r\n    const [selectedRowKeys, setSelectedRowKeys] = useState([]);\r\n    const [file, setFile ] = useState();\r\n    const [value, setValue ] = useState(\"\");\r\n    const [presentPage, setPresentPage] = useState(1);\r\n    const [deleteBtn, setDeleteBtn ] = useState(true);\r\n    let flag = \"softwareName\";\r\n    const clearCheck = () => {\r\n        setSelectedRowKeys([])\r\n    };\r\n    useEffect(() => {\r\n        handleAdminSoftwareData(\r\n            presentPage === 1 ?\r\n                {page: 1, type: \"software\"} :\r\n                (Math.ceil(total / 10) > presentPage ?\r\n                        {page: presentPage, type: \"software\"} :\r\n                        {page: presentPage - 1, type: \"software\"}\r\n                ));\r\n    }, [temp, softwareDataTemp]);\r\n    useEffect(() => {\r\n        setCurrent(page)\r\n    },[page]);\r\n    return (\r\n        <>\r\n            <div className={\"adminTop\"}>\r\n                <Upload\r\n                    style={{marginLeft: \"0.5rem\"}}\r\n                    beforeUpload={\r\n                        (file, FileList) => {\r\n                            setFile(file);\r\n                        }\r\n                    }\r\n                    customRequest={\r\n                        () => {\r\n                            handleImportSoftware({\r\n                                type: \"software\",\r\n                                userId: userId,\r\n                                file: file\r\n                            })\r\n                        }\r\n                    }\r\n                    showUploadList={false}\r\n                >\r\n                    <Button>\r\n                        <Icon type=\"upload\" /> 上传软件\r\n                    </Button>\r\n                </Upload>\r\n                <Button\r\n                    disabled={deleteBtn}\r\n                    style={{marginLeft: \"0.5rem\"}}\r\n                    icon={\"close\"}\r\n                    onClick={\r\n                        () => {\r\n                            handleDeleteSoftwareData({\r\n                                list: list,\r\n                                type: \"software\",\r\n                                userId: userId\r\n                            })\r\n                        }\r\n                    }\r\n                >\r\n                    删除软件\r\n                </Button>\r\n                <InputGroup\r\n                    compact\r\n                    style={{display: \"flex\", flexWrap: \"nowrap\", width: \"20rem\", marginLeft: \"0.5rem\"}}\r\n                >\r\n                    <Select\r\n                        defaultValue=\"softwareName\"\r\n                        onChange={\r\n                            value => flag = value\r\n                        }\r\n                    >\r\n                        <Option value=\"softwareName\">软件名</Option>\r\n                        <Option value=\"userName\">上传人</Option>\r\n                    </Select>\r\n                    <Search\r\n                        placeholder={\"请输入搜索内容\"}\r\n                        onSearch={\r\n                            value => {\r\n                                handleSearchSoftwareData({\r\n                                    page: 1,\r\n                                    value,\r\n                                    type: \"software\",\r\n                                    flag: flag\r\n                                });\r\n                                setValue(value);\r\n                            }\r\n                        }\r\n                        enterButton\r\n                        style={{width: \"16rem\"}}\r\n                    />\r\n                </InputGroup>\r\n            </div>\r\n            <Table\r\n                tableLayout={\"fixed\"}\r\n                rowKey={record => record.id}\r\n                columns={ columns }\r\n                rowSelection={{\r\n                    selectedRowKeys,\r\n                    onChange: (selectedRowKeys, selectedRows) => {\r\n                        const resourceId = selectedRows.map(el => {\r\n                            return el.id;\r\n                        });\r\n                        setList(resourceId);\r\n                        changeSelectedRowKeys(resourceId);\r\n                        setSelectedRowKeys(selectedRowKeys);\r\n                        selectedRowKeys.length > 0 ? setDeleteBtn(false) : setDeleteBtn(true);\r\n                    },\r\n                }}\r\n                dataSource={ Array.from(softwareData)}\r\n                pagination={{\r\n                    total,\r\n                    current,\r\n                    onChange: (page) => {\r\n                        !searchFlag ?\r\n                        handleAdminSoftwareData({\r\n                            page: page,\r\n                            type: \"software\"\r\n                        }):\r\n                            handleSearchSoftwareData({\r\n                                page: page,\r\n                                value,\r\n                                type: \"software\",\r\n                                flag: flag\r\n                            });\r\n                        clearCheck();\r\n                        setPresentPage(page);\r\n                    }\r\n                }}\r\n            />\r\n        </>\r\n    )\r\n};\r\n\r\nexport default connect(mapStateToState, mapDispatchToProps)(StudySoftware);\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(handleKeepAlive),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(counter),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(handleParam),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(querySecret),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(rootUserSagas);import{takeEvery,call,put}from\"redux-saga/effects\";import Service from\"../../../lib/Service\";import{KEEP_ALIVE,LOGIN_SUCCESS,COUNTER,COUNTER_SUCCESS,FETCH_PARAM,FETCH_PARAM_SUCCESS,QUERY_SECRET,QUERY_SECRET_SUCCESS}from\"../../../constants/actionTypes\";import{openNotification}from\"../../../utils/commonFunction\";function handleKeepAlive(){var res,id;return _regeneratorRuntime.wrap(function handleKeepAlive$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(Service.get,'keep_alive');case 3:res=_context.sent;if(!(res.data.error_code===0)){_context.next=18;break;}id=\"游客\";_context.t0=res.data.data.type;_context.next=_context.t0===\"student\"?9:_context.t0===\"teacher\"?11:_context.t0===\"admin\"?13:15;break;case 9:id=\"学生\";return _context.abrupt(\"break\",16);case 11:id=\"教师\";return _context.abrupt(\"break\",16);case 13:id=\"超级管理员\";return _context.abrupt(\"break\",16);case 15:return _context.abrupt(\"return\",id);case 16:_context.next=18;return put({type:LOGIN_SUCCESS,payload:{id:id,name:res.data.data.userName,userId:res.data.data.userId,academy:res.data.data.academy,class:res.data.data.cls,discipline:res.data.data.discipline,grade:res.data.data.grade,sex:res.data.data.sex,type:res.data.data.type,phone:res.data.data.phone,password:res.data.data.password}});case 18:_context.next=23;break;case 20:_context.prev=20;_context.t1=_context[\"catch\"](0);console.log(_context.t1);case 23:case\"end\":return _context.stop();}}},_marked,null,[[0,20]]);}//访问量\nfunction counter(){var res;return _regeneratorRuntime.wrap(function counter$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return call(Service.get,\"counter\");case 2:res=_context2.sent;_context2.t0=res.data.error_code;_context2.next=_context2.t0===0?6:_context2.t0===-1?9:_context2.t0===2?11:13;break;case 6:_context2.next=8;return put({type:COUNTER_SUCCESS,payload:res.data.data});case 8:return _context2.abrupt(\"break\",14);case 9:openNotification(res.data.message);return _context2.abrupt(\"break\",14);case 11:openNotification(res.data.message);return _context2.abrupt(\"break\",14);case 13:return _context2.abrupt(\"return\",0);case 14:case\"end\":return _context2.stop();}}},_marked2);}//获取系统参数\nfunction handleParam(){var res;return _regeneratorRuntime.wrap(function handleParam$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return call(Service.get,\"system/queryParameters\");case 2:res=_context3.sent;_context3.t0=res.data.error_code;_context3.next=_context3.t0===0?6:_context3.t0===-1?9:_context3.t0===2?11:13;break;case 6:_context3.next=8;return put({type:FETCH_PARAM_SUCCESS,payload:res.data.data});case 8:return _context3.abrupt(\"break\",14);case 9:openNotification(res.data.message);return _context3.abrupt(\"break\",14);case 11:openNotification(res.data.message);return _context3.abrupt(\"break\",14);case 13:return _context3.abrupt(\"return\",0);case 14:case\"end\":return _context3.stop();}}},_marked3);}// 是否存在密保问题\nfunction querySecret(args){var res;return _regeneratorRuntime.wrap(function querySecret$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return call(Service.get,\"user/secretGuardExistence?userId=\".concat(args.userId));case 2:res=_context4.sent;console.log(res.data);_context4.t0=res.data.error_code;_context4.next=_context4.t0===0?7:_context4.t0===-1?10:_context4.t0===2?12:14;break;case 7:_context4.next=9;return put({type:QUERY_SECRET_SUCCESS,payload:res.data});case 9:return _context4.abrupt(\"break\",15);case 10:openNotification(res.data.message);return _context4.abrupt(\"break\",15);case 12:openNotification(res.data.message);return _context4.abrupt(\"break\",15);case 14:return _context4.abrupt(\"return\",0);case 15:case\"end\":return _context4.stop();}}},_marked4);}export default function rootUserSagas(){return _regeneratorRuntime.wrap(function rootUserSagas$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return takeEvery(KEEP_ALIVE,handleKeepAlive);case 2:_context5.next=4;return takeEvery(COUNTER,counter);case 4:_context5.next=6;return takeEvery(FETCH_PARAM,handleParam);case 6:_context5.next=8;return takeEvery(QUERY_SECRET,querySecret);case 8:case\"end\":return _context5.stop();}}},_marked5);}","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/redux/sagas/userSagas/user.js"],"names":["handleKeepAlive","counter","handleParam","querySecret","rootUserSagas","takeEvery","call","put","Service","KEEP_ALIVE","LOGIN_SUCCESS","COUNTER","COUNTER_SUCCESS","FETCH_PARAM","FETCH_PARAM_SUCCESS","QUERY_SECRET","QUERY_SECRET_SUCCESS","openNotification","get","res","data","error_code","id","type","payload","name","userName","userId","academy","class","cls","discipline","grade","sex","phone","password","console","log","message","args"],"mappings":"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","sourcesContent":["import { takeEvery, call, put } from \"redux-saga/effects\";\r\nimport Service from \"../../../lib/Service\";\r\nimport {\r\n    KEEP_ALIVE, \r\n    LOGIN_SUCCESS, \r\n    COUNTER, \r\n    COUNTER_SUCCESS,\r\n    FETCH_PARAM,\r\n    FETCH_PARAM_SUCCESS,\r\n    QUERY_SECRET,\r\n    QUERY_SECRET_SUCCESS\r\n} from \"../../../constants/actionTypes\";\r\nimport {openNotification} from \"../../../utils/commonFunction\";\r\n\r\nfunction *handleKeepAlive() {\r\n    try {\r\n        const res = yield call(Service.get, 'keep_alive');\r\n        if (res.data.error_code === 0) {\r\n            let id = \"游客\";\r\n            switch (res.data.data.type) {\r\n                case \"student\":\r\n                    id = \"学生\";\r\n                    break;\r\n                case \"teacher\":\r\n                    id = \"教师\";\r\n                    break;\r\n                case \"admin\":\r\n                    id = \"超级管理员\";\r\n                    break;\r\n                default:\r\n                    return id;\r\n            }\r\n            yield put({\r\n                type: LOGIN_SUCCESS,\r\n                payload: {\r\n                    id,\r\n                    name: res.data.data.userName,\r\n                    userId: res.data.data.userId,\r\n                    academy: res.data.data.academy,\r\n                    class: res.data.data.cls,\r\n                    discipline: res.data.data.discipline,\r\n                    grade: res.data.data.grade,\r\n                    sex: res.data.data.sex,\r\n                    type: res.data.data.type,\r\n                    phone: res.data.data.phone,\r\n                    password: res.data.data.password,\r\n                }\r\n            })\r\n        }\r\n    } catch (e) {\r\n        console.log(e);\r\n    }\r\n}\r\n\r\n//访问量\r\nfunction *counter() {\r\n    const res = yield call(Service.get, \"counter\");\r\n    switch (res.data.error_code) {\r\n        case 0:\r\n            yield put({\r\n                type: COUNTER_SUCCESS,\r\n                payload: res.data.data\r\n            });\r\n            break;\r\n        case -1:\r\n            openNotification(res.data.message);\r\n            break;\r\n        case 2:\r\n            openNotification(res.data.message);\r\n            break;\r\n        default:\r\n            return 0;\r\n    }\r\n}\r\n//获取系统参数\r\nfunction *handleParam() {\r\n    const res = yield call(Service.get, `system/queryParameters`);\r\n    // console.log(res.data.data)\r\n    switch (res.data.error_code) {\r\n        case 0:\r\n            yield put({\r\n                type: FETCH_PARAM_SUCCESS,\r\n                payload: res.data.data\r\n            });\r\n            break;\r\n        case -1:\r\n            openNotification(res.data.message);\r\n            break;\r\n        case 2:\r\n            openNotification(res.data.message);\r\n            break;\r\n        default:\r\n            return 0;\r\n    }\r\n}\r\n\r\n// 是否存在密保问题\r\nfunction *querySecret(args) {\r\n    const res = yield call(Service.get, `user/secretGuardExistence?userId=${args.userId}`);\r\n    console.log(res.data)\r\n    switch (res.data.error_code) {\r\n        case 0:\r\n            yield put({\r\n                type: QUERY_SECRET_SUCCESS,\r\n                payload: res.data\r\n            });\r\n            break;\r\n        case -1:\r\n            openNotification(res.data.message);\r\n            break;\r\n        case 2:\r\n            openNotification(res.data.message);\r\n            break;\r\n        default:\r\n            return 0;\r\n    }\r\n}\r\n\r\nexport default function *rootUserSagas() {\r\n    yield takeEvery(KEEP_ALIVE, handleKeepAlive);\r\n    yield takeEvery(COUNTER,counter);\r\n    yield takeEvery(FETCH_PARAM,handleParam);\r\n    yield takeEvery(QUERY_SECRET,querySecret);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}
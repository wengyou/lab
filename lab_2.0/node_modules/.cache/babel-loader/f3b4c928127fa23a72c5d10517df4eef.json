{"ast":null,"code":"import _slicedToArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import\"antd/es/table/style/css\";import _Table from\"antd/es/table\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import*as course from\"../redux/actionCreators/resource\";import SearchCourse from\"./SearchCourse\";//老师显示上机任务的第三个\nvar AllTasks=function AllTasks(props){var taskTotal=props.taskTotal,type=props.type,userIdentify=props.userIdentify,userId=props.userId,courseResource=props.courseResource,courseTask=props.courseTask,handleFetchTaskRes=props.handleFetchTaskRes,handleFetchCourseRes=props.handleFetchCourseRes,handleStudentAddCourse=props.handleStudentAddCourse,updateCourseFlag=props.updateCourseFlag,page=props.page;useEffect(function(){handleFetchCourseRes({page:1,userId:userId});},[updateCourseFlag]);//点击那个加号展开实验任务详情\nvar _expandedRowRender=function expandedRowRender(record){var columns=[{title:'实验任务',dataIndex:'taskName',key:'taskName'},{title:'任务附件',dataIndex:'taskFileName',key:'taskFileName'},{title:'发布时间',dataIndex:'addTime',key:'addTime'}];var el=/*#__PURE__*/React.createElement(_Table,{rowKey:function rowKey(record){return record.id;},size:'small',columns:columns,dataSource:courseTask[record.teacherCourseId],pagination:false});return el;};var _useState=useState(1),_useState2=_slicedToArray(_useState,2),current=_useState2[0],setCurrent=_useState2[1];useEffect(function(){setCurrent(page);},[page]);var columns=[{title:'实验课程',dataIndex:'courseName',key:'courseName'},{title:'教学班编号',dataIndex:'teacherCourseId',align:'center',key:'teacherCourseId'},{title:'教学班备注',dataIndex:'remark',align:'center',key:'remark'},{title:'课程编号',dataIndex:'courseNumber',align:'center',key:'courseNumber'},{title:'课程教师',dataIndex:'teacherName',align:'center',key:'teacherName'},{title:'发布时间',dataIndex:'addTime',align:'center',key:'addTime'},userIdentify===\"学生\"?{title:'实验处理',key:'handleTask',render:function render(e){return/*#__PURE__*/React.createElement(\"span\",{onClick:function onClick(){return handleStudentAddCourse({teacherCourseId:e.teacherCourseId,userId:userId,type:type});},style:{color:\"#189EFF\",cursor:\"pointer\"}},userIdentify===\"学生\"?e.added?\"已添加\":\"添加课程\":null);}}:{}];return/*#__PURE__*/React.createElement(\"div\",{id:\"taskWrap\"},/*#__PURE__*/React.createElement(SearchCourse,null),/*#__PURE__*/React.createElement(_Table,{rowKey:function rowKey(record){return record.teacherCourseId;},size:'small',columns:columns,expandedRowRender:function expandedRowRender(record){return _expandedRowRender(record);},onExpand:function onExpand(expanded,record){expanded&&handleFetchTaskRes({teacherCourseId:record.teacherCourseId,courseTask:courseTask});},dataSource:courseResource,pagination:{current:current,pageSize:10,total:taskTotal,onChange:function onChange(e){return handleFetchCourseRes({page:e,userId:userId});}}}));};export default connect(function(state){return{taskTotal:state.getIn([\"course\",\"taskTotal\"]),courseResource:state.getIn([\"course\",\"courseResource\"]),courseTask:state.getIn([\"course\",\"courseTask\"]),userIdentify:state.getIn([\"userMana\",\"common\",\"userIdentify\"]),userId:state.getIn([\"userMana\",\"common\",\"userId\"]),type:state.getIn([\"userMana\",\"common\",\"type\"]),addCourse_S:state.getIn([\"course\",\"addCourse_S\"]),page:state.getIn([\"course\",\"page\"]),updateCourseFlag:state.getIn([\"course\",\"updateCourseFlag\"])};},function(dispatch){return{handleFetchCourseRes:function handleFetchCourseRes(args){dispatch(course.fetchCourse(args));},handleFetchTaskRes:function handleFetchTaskRes(teacherCourseId,courseTask){dispatch(course.fetchCourseTask(teacherCourseId,courseTask));},handleStudentAddCourse:function handleStudentAddCourse(args){dispatch(course.studentAddCourse(args));}};})(AllTasks);","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/components/AllTasks.js"],"names":["React","useEffect","useState","connect","course","SearchCourse","AllTasks","props","taskTotal","type","userIdentify","userId","courseResource","courseTask","handleFetchTaskRes","handleFetchCourseRes","handleStudentAddCourse","updateCourseFlag","page","expandedRowRender","record","columns","title","dataIndex","key","el","id","teacherCourseId","current","setCurrent","align","render","e","color","cursor","added","expanded","pageSize","total","onChange","state","getIn","addCourse_S","dispatch","args","fetchCourse","fetchCourseTask","studentAddCourse"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Table } from \"antd\";\r\nimport * as course from \"../redux/actionCreators/resource\";\r\nimport SearchCourse from \"./SearchCourse\";\r\n//老师显示上机任务的第三个\r\nconst AllTasks = props => {\r\n    const {\r\n        taskTotal,\r\n        type,\r\n        userIdentify,\r\n        userId,\r\n        courseResource,\r\n        courseTask,\r\n        handleFetchTaskRes,\r\n        handleFetchCourseRes,\r\n        handleStudentAddCourse,\r\n        updateCourseFlag,\r\n        page,\r\n    } = props;\r\n    useEffect(()=>{\r\n        handleFetchCourseRes({page: 1, userId: userId});\r\n    },[updateCourseFlag]);\r\n//点击那个加号展开实验任务详情\r\n    const expandedRowRender = record => {\r\n        const columns = [\r\n            { title: '实验任务', dataIndex: 'taskName', key: 'taskName' },\r\n            { title: '任务附件', dataIndex: 'taskFileName', key: 'taskFileName' },\r\n            { title: '发布时间', dataIndex: 'addTime', key: 'addTime' }\r\n        ];\r\n        const el = (\r\n            <Table\r\n                rowKey={record => (record.id)}\r\n                size={'small'}\r\n                columns={columns}\r\n                dataSource={courseTask[record.teacherCourseId]}\r\n                pagination={false}\r\n            />\r\n        );\r\n        return el;\r\n    };\r\n    const [ current, setCurrent ] = useState(1);\r\n    useEffect(() => {\r\n        setCurrent(page);\r\n    },[page]);\r\n    const columns = [\r\n            { title: '实验课程', dataIndex: 'courseName', key: 'courseName' },\r\n            { title: '教学班编号', dataIndex: 'teacherCourseId', align: 'center', key: 'teacherCourseId' },\r\n            { title: '教学班备注', dataIndex: 'remark', align: 'center', key: 'remark' },\r\n            { title: '课程编号', dataIndex: 'courseNumber', align: 'center', key: 'courseNumber' },\r\n            { title: '课程教师', dataIndex: 'teacherName', align: 'center', key: 'teacherName' },\r\n            { title: '发布时间', dataIndex: 'addTime', align: 'center', key: 'addTime' },\r\n            userIdentify === \"学生\"\r\n                ?\r\n                {\r\n                    title: '实验处理',\r\n                    key: 'handleTask',\r\n                    render: (e) => (\r\n                        <span\r\n                            onClick={() =>(\r\n                                    handleStudentAddCourse({\r\n                                        teacherCourseId: e.teacherCourseId,\r\n                                        userId: userId,\r\n                                        type: type\r\n                                    })\r\n                            )}\r\n                            style={{color: \"#189EFF\", cursor: \"pointer\"}}\r\n                        >\r\n                        {\r\n                            userIdentify === \"学生\" ?\r\n                                e.added ? \"已添加\" : \"添加课程\"\r\n                                :\r\n                                null\r\n                        }\r\n                    </span>\r\n                    )\r\n                } : {}\r\n        ];\r\n\r\n    return (\r\n        <div id=\"taskWrap\">\r\n            <SearchCourse/>\r\n            <Table\r\n                rowKey={record => record.teacherCourseId}\r\n                size={'small'}\r\n                columns={columns}\r\n                expandedRowRender={(record)=>(expandedRowRender(record))}\r\n                onExpand = {\r\n                    (expanded,record)=>{\r\n                        expanded && handleFetchTaskRes({teacherCourseId: record.teacherCourseId, courseTask});\r\n                    }\r\n                }\r\n                dataSource={courseResource}\r\n                pagination={{\r\n                    current,\r\n                    pageSize: 10,\r\n                    total: taskTotal,\r\n                    onChange: e => handleFetchCourseRes({ page: e, userId: userId }),\r\n                }}\r\n            />\r\n        </div>\r\n    )\r\n};\r\nexport default connect(\r\n    state => ({\r\n        taskTotal: state.getIn([\"course\", \"taskTotal\"]),\r\n        courseResource: state.getIn([\"course\", \"courseResource\"]),\r\n        courseTask: state.getIn([\"course\", \"courseTask\"]),\r\n        userIdentify: state.getIn([\"userMana\", \"common\", \"userIdentify\"]),\r\n        userId: state.getIn([\"userMana\", \"common\", \"userId\"]),\r\n        type: state.getIn([\"userMana\", \"common\", \"type\"]),\r\n        addCourse_S : state.getIn(([\"course\", \"addCourse_S\"])),\r\n        page: state.getIn([\"course\", \"page\"]),\r\n        updateCourseFlag: state.getIn([\"course\", \"updateCourseFlag\"])\r\n    }),\r\n    dispatch => ({\r\n        handleFetchCourseRes(args){\r\n            dispatch(course.fetchCourse(args));\r\n        },\r\n        handleFetchTaskRes(teacherCourseId,courseTask){\r\n            dispatch(course.fetchCourseTask(teacherCourseId, courseTask));\r\n        },\r\n        handleStudentAddCourse(args){\r\n            dispatch(course.studentAddCourse(args));\r\n        },\r\n    })\r\n)(AllTasks);\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(fetchSoftwareRes),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(fetchTeacherSoftwareRes),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(deleteSoftware),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(downloadSoftware),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(rootResourceSagas);import{takeEvery,put,call}from'redux-saga/effects';import Service from\"../../../lib/Service\";import{FETCH_SOFTWARE_RES_SUCCESS,FETCH_SOFTWARE_RESOURCE,FETCH_TEACHER_SOFTWARE,FETCH_TEACHER_SOFTWARE_SUCCESS,DELETE_SOFTWARE,DELETE_SOFTWARE_SUCCESS,DOWNLOAD_SOFTWARE,DOWNLOAD_SOFTWARE_SUCCESS}from\"../../../constants/actionTypes\";import{openNotification}from\"../../../utils/commonFunction\";function fetchSoftwareRes(data){var storage,_data$args,page,type,resourceName,userName,url,res,resData;return _regeneratorRuntime.wrap(function fetchSoftwareRes$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;storage=window.localStorage;_data$args=data.args,page=_data$args.page,type=_data$args.type,resourceName=_data$args.resourceName,userName=_data$args.userName;if(data.args.resourceName!==null){url=\"resource/queryResource?page=\".concat(page,\"&type=\").concat(type,\"&resourceName=\").concat(resourceName);}else if(data.args.userName!==null){url=\"resource/queryResource?page=\".concat(page,\"&type=\").concat(type,\"&userName=\").concat(userName);}else{url=\"resource/queryResource?page=\".concat(page,\"&type=\").concat(type);}_context.next=6;return call(Service.get,url);case 6:res=_context.sent;storage.softwareResource=JSON.stringify(res.data.data.items);storage.total=JSON.stringify(res.data.data.total);resData=Object.assign(res.data.data,{type:type,resourceName:resourceName,userName:userName});_context.t0=res.data.error_code;_context.next=_context.t0===0?13:_context.t0===-1?16:_context.t0===1?18:_context.t0===2?20:22;break;case 13:_context.next=15;return put({type:FETCH_SOFTWARE_RES_SUCCESS,payload:resData,softwareResource:storage.softwareResource,softwareTotal:storage.total});case 15:return _context.abrupt(\"break\",23);case 16:openNotification(res.data.message);return _context.abrupt(\"break\",23);case 18:openNotification(res.data.message);return _context.abrupt(\"break\",23);case 20:openNotification(res.data.message);return _context.abrupt(\"break\",23);case 22:return _context.abrupt(\"return\",0);case 23:_context.next=27;break;case 25:_context.prev=25;_context.t1=_context[\"catch\"](0);case 27:case\"end\":return _context.stop();}}},_marked,null,[[0,25]]);}function fetchTeacherSoftwareRes(data){var _data$args2,page,type,userName,url,res;return _regeneratorRuntime.wrap(function fetchTeacherSoftwareRes$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_data$args2=data.args,page=_data$args2.page,type=_data$args2.type,userName=_data$args2.userName;url=\"resource/queryResource?page=\".concat(page,\"&type=\").concat(type,\"&userName=\").concat(userName);_context2.next=5;return call(Service.get,url);case 5:res=_context2.sent;_context2.t0=res.data.error_code;_context2.next=_context2.t0===0?9:_context2.t0===-1?12:_context2.t0===1?14:_context2.t0===2?16:18;break;case 9:_context2.next=11;return put({type:FETCH_TEACHER_SOFTWARE_SUCCESS,payload:res.data.data});case 11:return _context2.abrupt(\"break\",19);case 12:openNotification(res.data.message);return _context2.abrupt(\"break\",19);case 14:openNotification(res.data.message);return _context2.abrupt(\"break\",19);case 16:openNotification(res.data.message);return _context2.abrupt(\"break\",19);case 18:return _context2.abrupt(\"return\",0);case 19:_context2.next=24;break;case 21:_context2.prev=21;_context2.t1=_context2[\"catch\"](0);console.log(_context2.t1);case 24:case\"end\":return _context2.stop();}}},_marked2,null,[[0,21]]);}function deleteSoftware(args){var _args$args,resourceId,type,userId,formData,resourceIdList,data,res;return _regeneratorRuntime.wrap(function deleteSoftware$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_args$args=args.args,resourceId=_args$args.resourceId,type=_args$args.type,userId=_args$args.userId;formData=new FormData();formData.append('resourceIdList',resourceId);resourceIdList=formData.get('resourceIdList');data={resourceIdList:resourceIdList,type:type,userId:userId};_context3.next=8;return call(Service.post,\"resource/delete\",data);case 8:res=_context3.sent;_context3.t0=res.data.error_code;_context3.next=_context3.t0===0?12:_context3.t0===-1?16:_context3.t0===1?18:_context3.t0===2?20:22;break;case 12:_context3.next=14;return put({type:DELETE_SOFTWARE_SUCCESS});case 14:openNotification(res.data.message);return _context3.abrupt(\"break\",23);case 16:openNotification(res.data.message);return _context3.abrupt(\"break\",23);case 18:openNotification(res.data.message);return _context3.abrupt(\"break\",23);case 20:openNotification(res.data.message);return _context3.abrupt(\"break\",23);case 22:openNotification(\"删除失败\");case 23:_context3.next=28;break;case 25:_context3.prev=25;_context3.t1=_context3[\"catch\"](0);console.log(_context3.t1);case 28:case\"end\":return _context3.stop();}}},_marked3,null,[[0,25]]);}function downloadSoftware(args){var _args$args2,id,type,data,res;return _regeneratorRuntime.wrap(function downloadSoftware$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_args$args2=args.args,id=_args$args2.id,type=_args$args2.type;data={id:id,type:type};_context4.next=4;return call(Service.post,\"resource/download\",data);case 4:res=_context4.sent;_context4.t0=res.data.error_code;_context4.next=_context4.t0===0?8:_context4.t0===-1?11:_context4.t0===1?13:_context4.t0===2?15:17;break;case 8:_context4.next=10;return put({type:DOWNLOAD_SOFTWARE_SUCCESS});case 10:return _context4.abrupt(\"break\",18);case 11:openNotification(res.data.message);return _context4.abrupt(\"break\",18);case 13:openNotification(res.data.message);return _context4.abrupt(\"break\",18);case 15:openNotification(res.data.message);return _context4.abrupt(\"break\",18);case 17:return _context4.abrupt(\"return\",0);case 18:case\"end\":return _context4.stop();}}},_marked4);}export default function rootResourceSagas(){return _regeneratorRuntime.wrap(function rootResourceSagas$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return takeEvery(FETCH_SOFTWARE_RESOURCE,fetchSoftwareRes);case 2:_context5.next=4;return takeEvery(FETCH_TEACHER_SOFTWARE,fetchTeacherSoftwareRes);case 4:_context5.next=6;return takeEvery(DELETE_SOFTWARE,deleteSoftware);case 6:_context5.next=8;return takeEvery(DOWNLOAD_SOFTWARE,downloadSoftware);case 8:case\"end\":return _context5.stop();}}},_marked5);}","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/redux/sagas/resourceSagas/softwareResource.js"],"names":["fetchSoftwareRes","fetchTeacherSoftwareRes","deleteSoftware","downloadSoftware","rootResourceSagas","takeEvery","put","call","Service","FETCH_SOFTWARE_RES_SUCCESS","FETCH_SOFTWARE_RESOURCE","FETCH_TEACHER_SOFTWARE","FETCH_TEACHER_SOFTWARE_SUCCESS","DELETE_SOFTWARE","DELETE_SOFTWARE_SUCCESS","DOWNLOAD_SOFTWARE","DOWNLOAD_SOFTWARE_SUCCESS","openNotification","data","storage","window","localStorage","args","page","type","resourceName","userName","url","get","res","softwareResource","JSON","stringify","items","total","resData","Object","assign","error_code","payload","softwareTotal","message","console","log","resourceId","userId","formData","FormData","append","resourceIdList","post","id"],"mappings":"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","sourcesContent":["import {takeEvery, put, call} from 'redux-saga/effects';\r\nimport Service from \"../../../lib/Service\";\r\nimport {\r\n    FETCH_SOFTWARE_RES_SUCCESS,\r\n    FETCH_SOFTWARE_RESOURCE,\r\n    FETCH_TEACHER_SOFTWARE,\r\n    FETCH_TEACHER_SOFTWARE_SUCCESS,\r\n    DELETE_SOFTWARE,\r\n    DELETE_SOFTWARE_SUCCESS,\r\n    DOWNLOAD_SOFTWARE,\r\n    DOWNLOAD_SOFTWARE_SUCCESS\r\n} from \"../../../constants/actionTypes\";\r\nimport {openNotification} from \"../../../utils/commonFunction\";\r\n\r\nfunction* fetchSoftwareRes(data) {\r\n    try {\r\n        let storage = window.localStorage;\r\n        const {page, type, resourceName, userName} = data.args;\r\n        let url;\r\n        if (data.args.resourceName !== null) {\r\n            url = `resource/queryResource?page=${page}&type=${type}&resourceName=${resourceName}`;\r\n        } else if (data.args.userName !== null) {\r\n            url = `resource/queryResource?page=${page}&type=${type}&userName=${userName}`;\r\n        } else {\r\n            url = `resource/queryResource?page=${page}&type=${type}`;\r\n        }\r\n        const res = yield call(Service.get, url);\r\n        storage.softwareResource = JSON.stringify(res.data.data.items);\r\n        storage.total = JSON.stringify(res.data.data.total);\r\n        const resData = Object.assign(res.data.data, {type,resourceName,userName});\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: FETCH_SOFTWARE_RES_SUCCESS,\r\n                    payload: resData,\r\n                    softwareResource: storage.softwareResource,\r\n                    softwareTotal: storage.total,\r\n                });\r\n                break;\r\n            case -1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 2:\r\n                openNotification(res.data.message);\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    } catch(e) {\r\n\r\n    }\r\n}\r\n\r\nfunction *fetchTeacherSoftwareRes(data) {\r\n    try{\r\n        const {page, type, userName} = data.args;\r\n        let url = `resource/queryResource?page=${page}&type=${type}&userName=${userName}`;\r\n        const res = yield call(Service.get, url);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: FETCH_TEACHER_SOFTWARE_SUCCESS,\r\n                    payload: res.data.data\r\n                });\r\n                break;\r\n            case -1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 2:\r\n                openNotification(res.data.message);\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    } catch (e) {\r\n        console.log(e)\r\n    }\r\n\r\n}\r\n\r\nfunction *deleteSoftware(args) {\r\n    try{\r\n        const {resourceId, type, userId} = args.args;\r\n        let formData = new FormData();\r\n        formData.append('resourceIdList',resourceId);\r\n        const resourceIdList = formData.get('resourceIdList');\r\n        const data = {resourceIdList, type, userId};\r\n        const res = yield call(Service.post, \"resource/delete\", data );\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: DELETE_SOFTWARE_SUCCESS,\r\n                });\r\n                openNotification(res.data.message);\r\n                break;\r\n            case -1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 2:\r\n                openNotification(res.data.message);\r\n                break;\r\n            default:\r\n                openNotification(\"删除失败\");\r\n        }\r\n    }catch (e) {\r\n        console.log(e)\r\n    }\r\n}\r\n\r\nfunction *downloadSoftware(args) {\r\n    const {id, type } = args.args;\r\n    const data = {id, type };\r\n    const res = yield call(Service.post, \"resource/download\", data);\r\n    switch (res.data.error_code) {\r\n        case 0:\r\n            yield put({\r\n                type: DOWNLOAD_SOFTWARE_SUCCESS,\r\n            });\r\n            break;\r\n        case -1:\r\n            openNotification(res.data.message);\r\n            break;\r\n        case 1:\r\n            openNotification(res.data.message);\r\n            break;\r\n        case 2:\r\n            openNotification(res.data.message);\r\n            break;\r\n        default:\r\n            return 0;\r\n    }\r\n}\r\n\r\nexport default function *rootResourceSagas() {\r\n    yield takeEvery(FETCH_SOFTWARE_RESOURCE, fetchSoftwareRes);\r\n    yield takeEvery(FETCH_TEACHER_SOFTWARE, fetchTeacherSoftwareRes);\r\n    yield takeEvery(DELETE_SOFTWARE, deleteSoftware);\r\n    yield takeEvery(DOWNLOAD_SOFTWARE, downloadSoftware);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}
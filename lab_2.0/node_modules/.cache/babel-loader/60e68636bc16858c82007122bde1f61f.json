{"ast":null,"code":"import\"antd/es/upload/style/css\";import _Upload from\"antd/es/upload\";import\"antd/es/message/style/css\";import _message from\"antd/es/message\";import\"antd/es/table/style/css\";import _Table from\"antd/es/table\";import\"antd/es/button/style/css\";import _Button from\"antd/es/button\";import\"antd/es/icon/style/css\";import _Icon from\"antd/es/icon\";import _toConsumableArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import\"antd/es/input/style/css\";import _Input from\"antd/es/input\";import\"antd/es/select/style/css\";import _Select from\"antd/es/select\";import\"antd/es/modal/style/css\";import _Modal from\"antd/es/modal\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import*as admin from\"../../redux/actionCreators/admin\";var confirm=_Modal.confirm;var Option=_Select.Option;var Search=_Input.Search;var titReg=/\\{2,30}/;var Reg=/^[\\s\\S]*.*[^\\s][\\s\\S]*$/;var numberReg=/[a-zA-Z0-9]{6,8}/;var LabCourse=function LabCourse(props){var labCourses=props.labCourses,labCourseTotal=props.labCourseTotal,addCourseFlag=props.addCourseFlag,deleteCourseFlag=props.deleteCourseFlag,importCourseFlag=props.importCourseFlag,userId=props.userId,handleQueryLabCourse=props.handleQueryLabCourse,handleAddlabCourse=props.handleAddlabCourse,handleDeletelabCourse=props.handleDeletelabCourse,handleImportlabCourse=props.handleImportlabCourse;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showAdd=_useState2[0],setShowAdd=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showImport=_useState4[0],setShowImport=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),courseName=_useState6[0],setCourseName=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),courseNumber=_useState8[0],setCourseNumber=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),selected=_useState10[0],setSelected=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),deleteBtn=_useState12[0],setDeleteBtn=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),uploadBtn=_useState14[0],setUploadBtn=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),fileList=_useState16[0],setFileList=_useState16[1];var _useState17=useState(1),_useState18=_slicedToArray(_useState17,2),presentPage=_useState18[0],setPresentPage=_useState18[1];useEffect(function(){if(Math.ceil(labCourseTotal/10)>presentPage){handleQueryLabCourse({page:presentPage,userId:userId});}else if(presentPage>1){handleQueryLabCourse({page:presentPage-1,userId:userId});}},[deleteCourseFlag]);useEffect(function(){handleQueryLabCourse({page:1,userId:userId});setShowAdd(false);setPresentPage(1);},[addCourseFlag]);useEffect(function(){setShowImport(false);handleQueryLabCourse({page:1,userId:userId});},[importCourseFlag]);var columns=[{title:\"课程名\",dataIndex:\"courseName\",key:\"courseName\"},{title:\"课程编号\",dataIndex:\"courseNumber\",key:\"courseNumber\"},{title:\"发布人\",dataIndex:\"userId\",key:\"userId\"},{title:\"发布时间\",dataIndex:\"addTime\",key:\"addTime\"}];var dataSource=_toConsumableArray(labCourses);var uploadProps={beforeUpload:function beforeUpload(file){fileList.push(file);fileList.length===1?setUploadBtn(true):setUploadBtn(false);return false;},onRemove:function onRemove(file){var index=fileList.indexOf(file.originFileObj);fileList.splice(index,1);fileList.length===1?setUploadBtn(true):setUploadBtn(false);}};return/*#__PURE__*/React.createElement(\"div\",{style:{margin:\"0.625rem 0.625rem\"}},/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\"}},/*#__PURE__*/React.createElement(_Button,{style:{margin:\" 0 0.625rem\"},onClick:function onClick(){return setShowAdd(true);}},/*#__PURE__*/React.createElement(_Icon,{type:\"plus\"}),\"\\u6DFB\\u52A0\\u8BFE\\u7A0B\"),/*#__PURE__*/React.createElement(_Button,{style:{marginRight:\"0.625rem\"},disabled:deleteBtn,onClick:function onClick(){return confirm({title:'确认删除吗?',onOk:function onOk(){handleDeletelabCourse({courseIdList:selected});setSelected([]);setDeleteBtn(true);},onCancel:function onCancel(){}});}},/*#__PURE__*/React.createElement(_Icon,{type:\"delete\"}),\"\\u5220\\u9664\\u8BFE\\u7A0B\"),/*#__PURE__*/React.createElement(_Button,{style:{marginRight:\"0.625rem\"},onClick:function onClick(){setShowImport(true);setUploadBtn(false);}},/*#__PURE__*/React.createElement(_Icon,{type:\"plus-circle\"}),\"\\u6279\\u91CF\\u5BFC\\u5165\"),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",flexWrap:\"nowrap\",width:\"20rem\"}},/*#__PURE__*/React.createElement(_Select,{defaultValue:\"courseName\",style:{width:\"5.625rem\"}},/*#__PURE__*/React.createElement(Option,{value:\"courseName\"},\"\\u8BFE\\u7A0B\\u540D\")),/*#__PURE__*/React.createElement(Search,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u641C\\u7D22\\u5185\\u5BB9\",onSearch:function onSearch(e){Reg.test(e)?handleQueryLabCourse({page:1,userId:userId,courseName:e}):handleQueryLabCourse({page:1,userId:userId,courseName:\"\"});setPresentPage(1);},enterButton:true,style:{width:200}}))),/*#__PURE__*/React.createElement(_Table,{rowKey:function rowKey(e){return e.id;},columns:columns,dataSource:dataSource,pagination:{total:labCourseTotal,current:presentPage,onChange:function onChange(e){handleQueryLabCourse({page:e,userId:userId});setPresentPage(e);setSelected([]);}},rowSelection:{selectedRowKeys:selected,onChange:function onChange(selectedRowKeys,selectedRows){setSelected(selectedRowKeys);selectedRowKeys.length>0?setDeleteBtn(false):setDeleteBtn(true);}}}),/*#__PURE__*/React.createElement(_Modal,{title:\"\\u6DFB\\u52A0\\u8BFE\\u7A0B\",okText:\"\\u6DFB\\u52A0\",cancelText:\"\\u53D6\\u6D88\",destroyOnClose:true,visible:showAdd,onCancel:function onCancel(){return setShowAdd(false);},onOk:function onOk(){if(courseNumber){Reg.test(courseName)&&courseName.length>1&&numberReg.test(courseNumber)?handleAddlabCourse({courseName:courseName,courseNumber:courseNumber,userId:userId}):_message.error(\"非法输入！\");setCourseNumber(\"\");setCourseName(\"\");}}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",alignItems:\"center\"}},/*#__PURE__*/React.createElement(\"label\",null,\"\\u8BFE\\u7A0B\\u540D : \"),/*#__PURE__*/React.createElement(_Input,{placeholder:\"输入长度在2-30位\",style:{width:\"70%\",marginLeft:\"2.1875rem\"},value:courseName,onChange:function onChange(e){return setCourseName(e.target.value);}})),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",alignItems:\"center\"}},/*#__PURE__*/React.createElement(\"label\",null,\"\\u8BFE\\u7A0B\\u7F16\\u53F7 : \"),/*#__PURE__*/React.createElement(_Input,{style:{width:\"70%\",margin:\"1.25rem\"},placeholder:\"输入长度在6-8位\",value:courseNumber,onChange:function onChange(e){return setCourseNumber(e.target.value);}})))),/*#__PURE__*/React.createElement(_Modal,{destroyOnClose:true,title:\"批量导入课程\",visible:showImport,okText:\"\\u5BFC\\u5165\",cancelText:\"\\u53D6\\u6D88\",onCancel:function onCancel(){setShowImport(false);setFileList([]);},onOk:function onOk(){var name=fileList[0].name;if(fileList.length!==1){_message.error(\"请选择文件！\");}else if(name.substring(name.indexOf(\".\")+1)===\"xlsx\"||name.substring(name.indexOf(\".\")+1)===\"xls\"){_message.loading(\"导入中\");handleImportlabCourse({userId:userId,file:fileList});setFileList([]);}else{_message.error(\"文件格式错误！\");}}},/*#__PURE__*/React.createElement(_Upload,uploadProps,/*#__PURE__*/React.createElement(_Button,{disabled:uploadBtn},/*#__PURE__*/React.createElement(_Icon,{type:\"upload\"}),\"\\u9009\\u62E9\\u6587\\u4EF6\"))));};export default connect(function(state){return{userId:state.getIn([\"userMana\",\"common\",\"userId\"]),labCourses:state.getIn([\"admin\",\"labCourse\",\"labCourses\"]),labCourseTotal:state.getIn([\"admin\",\"labCourse\",\"labCourseTotal\"]),addCourseFlag:state.getIn([\"admin\",\"labCourse\",\"addCourseFlag\"]),deleteCourseFlag:state.getIn([\"admin\",\"labCourse\",\"deleteCourseFlag\"]),importCourseFlag:state.getIn([\"admin\",\"labCourse\",\"importCourseFlag\"])};},function(dispatch){return{handleQueryLabCourse:function handleQueryLabCourse(args){dispatch(admin.adminQueryLabCourse(args));},handleAddlabCourse:function handleAddlabCourse(args){dispatch(admin.addLabCourse(args));},handleDeletelabCourse:function handleDeletelabCourse(args){dispatch(admin.deleteLabCourse(args));},handleImportlabCourse:function handleImportlabCourse(args){dispatch(admin.importLabCourse(args));}};})(LabCourse);","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/components/Administrator/LabCourse.js"],"names":["React","useEffect","useState","connect","admin","confirm","Option","Search","titReg","Reg","numberReg","LabCourse","props","labCourses","labCourseTotal","addCourseFlag","deleteCourseFlag","importCourseFlag","userId","handleQueryLabCourse","handleAddlabCourse","handleDeletelabCourse","handleImportlabCourse","showAdd","setShowAdd","showImport","setShowImport","courseName","setCourseName","courseNumber","setCourseNumber","selected","setSelected","deleteBtn","setDeleteBtn","uploadBtn","setUploadBtn","fileList","setFileList","presentPage","setPresentPage","Math","ceil","page","columns","title","dataIndex","key","dataSource","uploadProps","beforeUpload","file","push","length","onRemove","index","indexOf","originFileObj","splice","margin","display","marginRight","onOk","courseIdList","onCancel","flexWrap","width","e","test","id","total","current","onChange","selectedRowKeys","selectedRows","error","alignItems","marginLeft","target","value","name","substring","loading","state","getIn","dispatch","args","adminQueryLabCourse","addLabCourse","deleteLabCourse","importLabCourse"],"mappings":"g1BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAAQC,OAAR,KAAsB,aAAtB,CAEA,MAAO,GAAKC,CAAAA,KAAZ,KAAuB,kCAAvB,C,GACQC,CAAAA,O,QAAAA,O,IACAC,CAAAA,M,SAAAA,M,IACAC,CAAAA,M,QAAAA,M,CACR,GAAMC,CAAAA,MAAM,CAAG,SAAf,CACA,GAAMC,CAAAA,GAAG,CAAG,yBAAZ,CACA,GAAMC,CAAAA,SAAS,CAAG,kBAAlB,CAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAAC,KAAK,CAAI,IAChBC,CAAAA,UADgB,CAC+JD,KAD/J,CAChBC,UADgB,CACJC,cADI,CAC+JF,KAD/J,CACJE,cADI,CACWC,aADX,CAC+JH,KAD/J,CACWG,aADX,CAC0BC,gBAD1B,CAC+JJ,KAD/J,CAC0BI,gBAD1B,CAC2CC,gBAD3C,CAC+JL,KAD/J,CAC2CK,gBAD3C,CAC6DC,MAD7D,CAC+JN,KAD/J,CAC6DM,MAD7D,CACqEC,oBADrE,CAC+JP,KAD/J,CACqEO,oBADrE,CAC2FC,kBAD3F,CAC+JR,KAD/J,CAC2FQ,kBAD3F,CAC+GC,qBAD/G,CAC+JT,KAD/J,CAC+GS,qBAD/G,CACsIC,qBADtI,CAC+JV,KAD/J,CACsIU,qBADtI,eAEOpB,QAAQ,CAAC,KAAD,CAFf,wCAEhBqB,OAFgB,eAEPC,UAFO,8BAGatB,QAAQ,CAAC,KAAD,CAHrB,yCAGhBuB,UAHgB,eAGJC,aAHI,8BAIaxB,QAAQ,EAJrB,yCAIhByB,UAJgB,eAIJC,aAJI,8BAKiB1B,QAAQ,EALzB,yCAKhB2B,YALgB,eAKFC,eALE,8BAMS5B,QAAQ,CAAC,EAAD,CANjB,0CAMhB6B,QANgB,gBAMNC,WANM,gCAOW9B,QAAQ,CAAC,IAAD,CAPnB,2CAOhB+B,SAPgB,gBAOLC,YAPK,gCAQWhC,QAAQ,CAAC,KAAD,CARnB,2CAQhBiC,SARgB,gBAQLC,YARK,gCASSlC,QAAQ,CAAC,EAAD,CATjB,2CAShBmC,QATgB,gBASNC,WATM,gCAUepC,QAAQ,CAAC,CAAD,CAVvB,2CAUhBqC,WAVgB,gBAUHC,cAVG,gBAWvBvC,SAAS,CAAC,UAAI,CACV,GAAGwC,IAAI,CAACC,IAAL,CAAU5B,cAAc,CAAG,EAA3B,EAAiCyB,WAApC,CAAgD,CAC5CpB,oBAAoB,CAAC,CAAEwB,IAAI,CAAEJ,WAAR,CAAqBrB,MAAM,CAAEA,MAA7B,CAAD,CAApB,CACH,CAFD,IAEO,IAAGqB,WAAW,CAAG,CAAjB,CAAoB,CACvBpB,oBAAoB,CAAC,CAAEwB,IAAI,CAAEJ,WAAW,CAAC,CAApB,CAAuBrB,MAAM,CAAEA,MAA/B,CAAD,CAApB,CACH,CACJ,CANQ,CAMP,CAACF,gBAAD,CANO,CAAT,CAOAf,SAAS,CAAC,UAAI,CACVkB,oBAAoB,CAAC,CAAEwB,IAAI,CAAE,CAAR,CAAWzB,MAAM,CAAEA,MAAnB,CAAD,CAApB,CACAM,UAAU,CAAC,KAAD,CAAV,CACAgB,cAAc,CAAC,CAAD,CAAd,CACH,CAJQ,CAIP,CAACzB,aAAD,CAJO,CAAT,CAKAd,SAAS,CAAC,UAAI,CACVyB,aAAa,CAAC,KAAD,CAAb,CACAP,oBAAoB,CAAC,CAACwB,IAAI,CAAE,CAAP,CAAUzB,MAAM,CAAEA,MAAlB,CAAD,CAApB,CACH,CAHQ,CAGN,CAACD,gBAAD,CAHM,CAAT,CAKA,GAAM2B,CAAAA,OAAO,CAAG,CACZ,CAAEC,KAAK,CAAE,KAAT,CAAgBC,SAAS,CAAE,YAA3B,CAAyCC,GAAG,CAAE,YAA9C,CADY,CAEZ,CAAEF,KAAK,CAAE,MAAT,CAAiBC,SAAS,CAAE,cAA5B,CAA4CC,GAAG,CAAE,cAAjD,CAFY,CAGZ,CAAEF,KAAK,CAAE,KAAT,CAAgBC,SAAS,CAAE,QAA3B,CAAqCC,GAAG,CAAE,QAA1C,CAHY,CAIZ,CAAEF,KAAK,CAAE,MAAT,CAAiBC,SAAS,CAAE,SAA5B,CAAuCC,GAAG,CAAE,SAA5C,CAJY,CAAhB,CAMA,GAAMC,CAAAA,UAAU,oBAAOnC,UAAP,CAAhB,CACA,GAAMoC,CAAAA,WAAW,CAAG,CAChBC,YAAY,CACR,sBAAAC,IAAI,CAAI,CACJd,QAAQ,CAACe,IAAT,CAAcD,IAAd,EACAd,QAAQ,CAACgB,MAAT,GAAoB,CAApB,CAAwBjB,YAAY,CAAC,IAAD,CAApC,CAA6CA,YAAY,CAAC,KAAD,CAAzD,CACA,MAAO,MAAP,CACH,CANW,CAOhBkB,QAAQ,CACJ,kBAAAH,IAAI,CAAE,CACF,GAAMI,CAAAA,KAAK,CAAGlB,QAAQ,CAACmB,OAAT,CAAiBL,IAAI,CAACM,aAAtB,CAAd,CACApB,QAAQ,CAACqB,MAAT,CAAgBH,KAAhB,CAAuB,CAAvB,EACAlB,QAAQ,CAACgB,MAAT,GAAoB,CAApB,CAAwBjB,YAAY,CAAC,IAAD,CAApC,CAA6CA,YAAY,CAAC,KAAD,CAAzD,CACH,CAZW,CAApB,CAcA,mBACI,2BACI,KAAK,CAAE,CAAEuB,MAAM,CAAE,mBAAV,CADX,eAGI,2BACI,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAX,CADX,eAGI,6BACI,KAAK,CAAE,CAACD,MAAM,CAAE,aAAT,CADX,CAEI,OAAO,CAAI,yBAAKnC,CAAAA,UAAU,CAAC,IAAD,CAAf,EAFf,eAII,2BAAM,IAAI,CAAE,MAAZ,EAJJ,4BAHJ,cAUI,6BACI,KAAK,CAAE,CAACqC,WAAW,CAAE,UAAd,CADX,CAEI,QAAQ,CAAE5B,SAFd,CAGI,OAAO,CAAE,yBACL5B,CAAAA,OAAO,CAAC,CACJwC,KAAK,CAAE,QADH,CAEJiB,IAFI,gBAEG,CACHzC,qBAAqB,CAAC,CAClB0C,YAAY,CAAEhC,QADI,CAAD,CAArB,CAGAC,WAAW,CAAC,EAAD,CAAX,CACAE,YAAY,CAAC,IAAD,CAAZ,CACH,CARG,CASJ8B,QATI,oBASO,CACV,CAVG,CAAD,CADF,EAHb,eAkBI,2BAAM,IAAI,CAAE,QAAZ,EAlBJ,4BAVJ,cA+BI,6BACI,KAAK,CAAE,CAACH,WAAW,CAAE,UAAd,CADX,CAEI,OAAO,CAAE,kBAAI,CACTnC,aAAa,CAAC,IAAD,CAAb,CACAU,YAAY,CAAC,KAAD,CAAZ,CACH,CALL,eAOI,2BAAM,IAAI,CAAE,aAAZ,EAPJ,4BA/BJ,cAyCI,2BAAM,KAAK,CAAE,CAACwB,OAAO,CAAE,MAAV,CAAkBK,QAAQ,CAAE,QAA5B,CAAsCC,KAAK,CAAE,OAA7C,CAAb,eACI,6BAAQ,YAAY,CAAE,YAAtB,CAAoC,KAAK,CAAE,CAAEA,KAAK,CAAE,UAAT,CAA3C,eACI,oBAAC,MAAD,EAAQ,KAAK,CAAE,YAAf,uBADJ,CADJ,cAII,oBAAC,MAAD,EACI,WAAW,CAAC,4CADhB,CAEI,QAAQ,CAAE,kBAACC,CAAD,CAAM,CACZ1D,GAAG,CAAC2D,IAAJ,CAASD,CAAT,EAAchD,oBAAoB,CAAC,CAC/BwB,IAAI,CAAE,CADyB,CAE/BzB,MAAM,CAAEA,MAFuB,CAG/BS,UAAU,CAAEwC,CAHmB,CAAD,CAAlC,CAIKhD,oBAAoB,CAAC,CACtBwB,IAAI,CAAE,CADgB,CAEtBzB,MAAM,CAAEA,MAFc,CAGtBS,UAAU,CAAE,EAHU,CAAD,CAJzB,CASAa,cAAc,CAAC,CAAD,CAAd,CACH,CAbL,CAcI,WAAW,KAdf,CAeI,KAAK,CAAE,CAAE0B,KAAK,CAAE,GAAT,CAfX,EAJJ,CAzCJ,CAHJ,cAmEI,4BACI,MAAM,CAAE,gBAAAC,CAAC,QAAEA,CAAAA,CAAC,CAACE,EAAJ,EADb,CAEI,OAAO,CAAEzB,OAFb,CAGI,UAAU,CAAEI,UAHhB,CAII,UAAU,CAAE,CACRsB,KAAK,CAAExD,cADC,CAERyD,OAAO,CAAEhC,WAFD,CAGRiC,QAAQ,CAAE,kBAACL,CAAD,CAAO,CACbhD,oBAAoB,CAAC,CAAEwB,IAAI,CAAEwB,CAAR,CAAWjD,MAAM,CAAEA,MAAnB,CAAD,CAApB,CACAsB,cAAc,CAAC2B,CAAD,CAAd,CACAnC,WAAW,CAAC,EAAD,CAAX,CACH,CAPO,CAJhB,CAaI,YAAY,CAAG,CACXyC,eAAe,CAAE1C,QADN,CAEXyC,QAAQ,CAAE,kBAACC,eAAD,CAAkBC,YAAlB,CAAmC,CACzC1C,WAAW,CAACyC,eAAD,CAAX,CACAA,eAAe,CAACpB,MAAhB,CAAyB,CAAzB,CAA6BnB,YAAY,CAAC,KAAD,CAAzC,CAAmDA,YAAY,CAAC,IAAD,CAA/D,CACH,CALU,CAbnB,EAnEJ,cAwFI,4BACI,KAAK,CAAG,0BADZ,CAEI,MAAM,CAAG,cAFb,CAGI,UAAU,CAAG,cAHjB,CAII,cAAc,CAAE,IAJpB,CAKI,OAAO,CAAEX,OALb,CAMI,QAAQ,CAAE,0BAAKC,CAAAA,UAAU,CAAC,KAAD,CAAf,EANd,CAOI,IAAI,CAAE,eAAM,CACR,GAAIK,YAAJ,CAAkB,CACZpB,GAAG,CAAC2D,IAAJ,CAASzC,UAAT,GAAwBA,UAAU,CAAC0B,MAAX,CAAoB,CAA7C,EAAmD3C,SAAS,CAAC0D,IAAV,CAAevC,YAAf,CAApD,CACIT,kBAAkB,CAAC,CACfO,UAAU,CAAVA,UADe,CAEfE,YAAY,CAAZA,YAFe,CAGfX,MAAM,CAANA,MAHe,CAAD,CADtB,CAMI,SAAQyD,KAAR,CAAc,OAAd,CANJ,CAOA7C,eAAe,CAAC,EAAD,CAAf,CACAF,aAAa,CAAC,EAAD,CAAb,CACH,CACJ,CAnBL,eAsBI,4CACI,2BACI,KAAK,CAAE,CAACgC,OAAO,CAAE,MAAV,CAAkBgB,UAAU,CAAE,QAA9B,CADX,eAGI,yDAHJ,cAII,4BACI,WAAW,CAAE,YADjB,CAEI,KAAK,CAAE,CAACV,KAAK,CAAE,KAAR,CAAeW,UAAU,CAAE,WAA3B,CAFX,CAGI,KAAK,CAAElD,UAHX,CAII,QAAQ,CAAE,kBAACwC,CAAD,QAAMvC,CAAAA,aAAa,CAACuC,CAAC,CAACW,MAAF,CAASC,KAAV,CAAnB,EAJd,EAJJ,CADJ,cAYI,2BACI,KAAK,CAAE,CAACnB,OAAO,CAAE,MAAV,CAAkBgB,UAAU,CAAE,QAA9B,CADX,eAGI,+DAHJ,cAII,4BACI,KAAK,CAAE,CAACV,KAAK,CAAE,KAAR,CAAeP,MAAM,CAAE,SAAvB,CADX,CAEI,WAAW,CAAE,WAFjB,CAGI,KAAK,CAAE9B,YAHX,CAII,QAAQ,CAAE,kBAACsC,CAAD,QAAMrC,CAAAA,eAAe,CAACqC,CAAC,CAACW,MAAF,CAASC,KAAV,CAArB,EAJd,EAJJ,CAZJ,CAtBJ,CAxFJ,cAuII,4BACI,cAAc,CAAE,IADpB,CAEI,KAAK,CAAE,QAFX,CAGI,OAAO,CAAEtD,UAHb,CAII,MAAM,CAAG,cAJb,CAKI,UAAU,CAAG,cALjB,CAMI,QAAQ,CAAE,mBAAI,CACVC,aAAa,CAAC,KAAD,CAAb,CACAY,WAAW,CAAC,EAAD,CAAX,CACH,CATL,CAUI,IAAI,CAAE,eAAI,CACN,GAAM0C,CAAAA,IAAI,CAAG3C,QAAQ,CAAC,CAAD,CAAR,CAAY2C,IAAzB,CACA,GAAI3C,QAAQ,CAACgB,MAAT,GAAoB,CAAxB,CAA2B,CACvB,SAAQsB,KAAR,CAAc,QAAd,EACH,CAFD,IAEO,IAAIK,IAAI,CAACC,SAAL,CAAeD,IAAI,CAACxB,OAAL,CAAa,GAAb,EAAkB,CAAjC,IAAwC,MAAxC,EACPwB,IAAI,CAACC,SAAL,CAAeD,IAAI,CAACxB,OAAL,CAAa,GAAb,EAAkB,CAAjC,IAAwC,KADrC,CAEF,CACD,SAAQ0B,OAAR,CAAgB,KAAhB,EACA5D,qBAAqB,CAAC,CAClBJ,MAAM,CAANA,MADkB,CAElBiC,IAAI,CAAEd,QAFY,CAAD,CAArB,CAIAC,WAAW,CAAC,EAAD,CAAX,CACH,CATM,IASA,CACH,SAAQqC,KAAR,CAAc,SAAd,EACH,CACJ,CA1BL,eA4BI,4BAAY1B,WAAZ,cACI,6BACI,QAAQ,CAAEd,SADd,eAGI,2BAAM,IAAI,CAAE,QAAZ,EAHJ,4BADJ,CA5BJ,CAvIJ,CADJ,CAgLH,CAjOD,CAkOA,cAAehC,CAAAA,OAAO,CAClB,SAAAgF,KAAK,QAAK,CACNjE,MAAM,CAAEiE,KAAK,CAACC,KAAN,CAAY,CAAC,UAAD,CAAa,QAAb,CAAuB,QAAvB,CAAZ,CADF,CAENvE,UAAU,CAAEsE,KAAK,CAACC,KAAN,CAAY,CAAC,OAAD,CAAU,WAAV,CAAuB,YAAvB,CAAZ,CAFN,CAGNtE,cAAc,CAAEqE,KAAK,CAACC,KAAN,CAAY,CAAC,OAAD,CAAU,WAAV,CAAuB,gBAAvB,CAAZ,CAHV,CAINrE,aAAa,CAAEoE,KAAK,CAACC,KAAN,CAAY,CAAC,OAAD,CAAU,WAAV,CAAuB,eAAvB,CAAZ,CAJT,CAKNpE,gBAAgB,CAAEmE,KAAK,CAACC,KAAN,CAAY,CAAC,OAAD,CAAU,WAAV,CAAuB,kBAAvB,CAAZ,CALZ,CAMNnE,gBAAgB,CAAEkE,KAAK,CAACC,KAAN,CAAY,CAAC,OAAD,CAAU,WAAV,CAAuB,kBAAvB,CAAZ,CANZ,CAAL,EADa,CASlB,SAAAC,QAAQ,QAAK,CACTlE,oBADS,+BACYmE,IADZ,CACiB,CACtBD,QAAQ,CAACjF,KAAK,CAACmF,mBAAN,CAA0BD,IAA1B,CAAD,CAAR,CACH,CAHQ,CAITlE,kBAJS,6BAIUkE,IAJV,CAIe,CACpBD,QAAQ,CAACjF,KAAK,CAACoF,YAAN,CAAmBF,IAAnB,CAAD,CAAR,CACH,CANQ,CAOTjE,qBAPS,gCAOaiE,IAPb,CAOmB,CACxBD,QAAQ,CAACjF,KAAK,CAACqF,eAAN,CAAsBH,IAAtB,CAAD,CAAR,CACH,CATQ,CAUThE,qBAVS,gCAUagE,IAVb,CAUmB,CACxBD,QAAQ,CAACjF,KAAK,CAACsF,eAAN,CAAsBJ,IAAtB,CAAD,CAAR,CACH,CAZQ,CAAL,EATU,CAAP,CAuBb3E,SAvBa,CAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {Input, Table, Button, Icon, Modal, message, Upload, Select} from \"antd\";\r\nimport * as admin from \"../../redux/actionCreators/admin\";\r\nconst { confirm } = Modal;\r\nconst { Option } = Select;\r\nconst { Search } = Input;\r\nconst titReg = /\\{2,30}/;\r\nconst Reg = /^[\\s\\S]*.*[^\\s][\\s\\S]*$/;\r\nconst numberReg = /[a-zA-Z0-9]{6,8}/;\r\n\r\nconst LabCourse = props => {\r\n    const {labCourses, labCourseTotal,addCourseFlag, deleteCourseFlag,importCourseFlag, userId, handleQueryLabCourse, handleAddlabCourse, handleDeletelabCourse, handleImportlabCourse} = props;\r\n    const [showAdd, setShowAdd] = useState(false);\r\n    const [showImport, setShowImport] = useState(false);\r\n    const [courseName, setCourseName] = useState();\r\n    const [courseNumber, setCourseNumber] = useState();\r\n    const [selected, setSelected] = useState([]);\r\n    const [deleteBtn, setDeleteBtn] = useState(true);\r\n    const [uploadBtn, setUploadBtn] = useState(false);\r\n    const [fileList, setFileList] = useState([]);\r\n    const [presentPage, setPresentPage] = useState(1);\r\n    useEffect(()=>{\r\n        if(Math.ceil(labCourseTotal / 10) > presentPage){\r\n            handleQueryLabCourse({ page: presentPage, userId: userId,  })\r\n        } else if(presentPage > 1) {\r\n            handleQueryLabCourse({ page: presentPage-1, userId: userId,  });\r\n        }\r\n    },[deleteCourseFlag]);\r\n    useEffect(()=>{\r\n        handleQueryLabCourse({ page: 1, userId: userId,  });\r\n        setShowAdd(false);\r\n        setPresentPage(1);\r\n    },[addCourseFlag]);\r\n    useEffect(()=>{\r\n        setShowImport(false);\r\n        handleQueryLabCourse({page: 1, userId: userId})\r\n    }, [importCourseFlag]);\r\n\r\n    const columns = [\r\n        { title: \"课程名\", dataIndex: \"courseName\", key: \"courseName\"},\r\n        { title: \"课程编号\", dataIndex: \"courseNumber\", key: \"courseNumber\"},\r\n        { title: \"发布人\", dataIndex: \"userId\", key: \"userId\"},\r\n        { title: \"发布时间\", dataIndex: \"addTime\", key: \"addTime\"},\r\n    ];\r\n    const dataSource = [...labCourses];\r\n    const uploadProps = {\r\n        beforeUpload:\r\n            file => {\r\n                fileList.push(file);\r\n                fileList.length === 1 ? setUploadBtn(true) : setUploadBtn(false);\r\n                return false\r\n            },\r\n        onRemove:\r\n            file=>{\r\n                const index = fileList.indexOf(file.originFileObj);\r\n                fileList.splice(index, 1);\r\n                fileList.length === 1 ? setUploadBtn(true) : setUploadBtn(false);\r\n            }\r\n    };\r\n    return (\r\n        <div\r\n            style={{ margin: \"0.625rem 0.625rem\" }}\r\n        >\r\n            <div\r\n                style={{ display: \"flex\", }}\r\n            >\r\n                <Button\r\n                    style={{margin: \" 0 0.625rem\"}}\r\n                    onClick = {()=>(setShowAdd(true))}\r\n                >\r\n                    <Icon type={\"plus\"} />\r\n                    添加课程\r\n                </Button>\r\n                <Button\r\n                    style={{marginRight: \"0.625rem\"}}\r\n                    disabled={deleteBtn}\r\n                    onClick={()=>\r\n                        confirm({\r\n                            title: '确认删除吗?',\r\n                            onOk() {\r\n                                handleDeletelabCourse({\r\n                                    courseIdList: selected,\r\n                                });\r\n                                setSelected([]);\r\n                                setDeleteBtn(true);\r\n                            },\r\n                            onCancel() {\r\n                            },\r\n                        })\r\n                    }\r\n                >\r\n                    <Icon type={\"delete\"} />\r\n                    删除课程\r\n                </Button>\r\n                <Button\r\n                    style={{marginRight: \"0.625rem\"}}\r\n                    onClick={()=>{\r\n                        setShowImport(true);\r\n                        setUploadBtn(false);\r\n                    }}\r\n                >\r\n                    <Icon type={\"plus-circle\"} />\r\n                    批量导入\r\n                </Button>\r\n                <div  style={{display: \"flex\", flexWrap: \"nowrap\", width: \"20rem\"}}>\r\n                    <Select defaultValue={\"courseName\"} style={{ width: \"5.625rem\" }}>\r\n                        <Option value={\"courseName\"}>课程名</Option>\r\n                    </Select>\r\n                    <Search\r\n                        placeholder=\"请输入搜索内容\"\r\n                        onSearch={(e) =>{\r\n                            Reg.test(e) ? handleQueryLabCourse({\r\n                                page: 1,\r\n                                userId: userId,\r\n                                courseName: e,\r\n                            }) : handleQueryLabCourse({\r\n                                page: 1,\r\n                                userId: userId,\r\n                                courseName: \"\",\r\n                            });\r\n                            setPresentPage(1);\r\n                        }}\r\n                        enterButton\r\n                        style={{ width: 200 }}\r\n                    />\r\n                </div>\r\n            </div>\r\n            <Table\r\n                rowKey={e=>e.id}\r\n                columns={columns}\r\n                dataSource={dataSource}\r\n                pagination={{\r\n                    total: labCourseTotal,\r\n                    current: presentPage,\r\n                    onChange: (e) => {\r\n                        handleQueryLabCourse({ page: e, userId: userId });\r\n                        setPresentPage(e);\r\n                        setSelected([]);\r\n                    }\r\n                }}\r\n                rowSelection ={{\r\n                    selectedRowKeys: selected,\r\n                    onChange: (selectedRowKeys, selectedRows) => {\r\n                        setSelected(selectedRowKeys);\r\n                        selectedRowKeys.length > 0 ? setDeleteBtn(false) : setDeleteBtn(true);\r\n                    }\r\n                }}\r\n            />\r\n            <Modal\r\n                title = \"添加课程\"\r\n                okText = \"添加\"\r\n                cancelText = \"取消\"\r\n                destroyOnClose={true}\r\n                visible={showAdd}\r\n                onCancel={()=>(setShowAdd(false))}\r\n                onOk={() => {\r\n                    if (courseNumber) {\r\n                        ((Reg.test(courseName) && courseName.length > 1) && numberReg.test(courseNumber)) ?\r\n                            handleAddlabCourse({\r\n                                courseName,\r\n                                courseNumber,\r\n                                userId\r\n                            }) :\r\n                            message.error(\"非法输入！\");\r\n                        setCourseNumber(\"\");\r\n                        setCourseName(\"\");\r\n                    }\r\n                }\r\n                }\r\n            >\r\n                <div>\r\n                    <div\r\n                        style={{display: \"flex\", alignItems: \"center\"}}\r\n                    >\r\n                        <label>课程名 : </label>\r\n                        <Input\r\n                            placeholder={\"输入长度在2-30位\"}\r\n                            style={{width: \"70%\", marginLeft: \"2.1875rem\"}}\r\n                            value={courseName}\r\n                            onChange={(e)=>(setCourseName(e.target.value))}\r\n                        />\r\n                    </div>\r\n                    <div\r\n                        style={{display: \"flex\", alignItems: \"center\"}}\r\n                    >\r\n                        <label>课程编号 : </label>\r\n                        <Input\r\n                            style={{width: \"70%\", margin: \"1.25rem\"}}\r\n                            placeholder={\"输入长度在6-8位\"}\r\n                            value={courseNumber}\r\n                            onChange={(e)=>(setCourseNumber(e.target.value))}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n            <Modal\r\n                destroyOnClose={true}\r\n                title={\"批量导入课程\"}\r\n                visible={showImport}\r\n                okText = \"导入\"\r\n                cancelText = \"取消\"\r\n                onCancel={()=>{\r\n                    setShowImport(false);\r\n                    setFileList([]);\r\n                }}\r\n                onOk={()=>{\r\n                    const name = fileList[0].name;\r\n                    if (fileList.length !== 1) {\r\n                        message.error(\"请选择文件！\")\r\n                    } else if (name.substring(name.indexOf(\".\")+1) === \"xlsx\" ||\r\n                        name.substring(name.indexOf(\".\")+1) === \"xls\"\r\n                        ){\r\n                        message.loading(\"导入中\");\r\n                        handleImportlabCourse({\r\n                            userId,\r\n                            file: fileList\r\n                        });\r\n                        setFileList([]);\r\n                    } else {\r\n                        message.error(\"文件格式错误！\");\r\n                    }\r\n                }}\r\n            >\r\n                <Upload {...uploadProps}>\r\n                    <Button\r\n                        disabled={uploadBtn}\r\n                    >\r\n                        <Icon type={\"upload\"} />\r\n                        选择文件\r\n                    </Button>\r\n                </Upload>\r\n            </Modal>\r\n        </div>\r\n    )\r\n\r\n};\r\nexport default connect(\r\n    state => ({\r\n        userId: state.getIn([\"userMana\", \"common\", \"userId\"]),\r\n        labCourses: state.getIn([\"admin\", \"labCourse\", \"labCourses\"]),\r\n        labCourseTotal: state.getIn([\"admin\", \"labCourse\", \"labCourseTotal\"]),\r\n        addCourseFlag: state.getIn([\"admin\", \"labCourse\", \"addCourseFlag\"]),\r\n        deleteCourseFlag: state.getIn([\"admin\", \"labCourse\", \"deleteCourseFlag\"]),\r\n        importCourseFlag: state.getIn([\"admin\", \"labCourse\", \"importCourseFlag\"]),\r\n    }),\r\n    dispatch => ({\r\n        handleQueryLabCourse(args){\r\n            dispatch(admin.adminQueryLabCourse(args));\r\n        },\r\n        handleAddlabCourse(args){\r\n            dispatch(admin.addLabCourse(args))\r\n        },\r\n        handleDeletelabCourse(args) {\r\n            dispatch(admin.deleteLabCourse(args))\r\n        },\r\n        handleImportlabCourse(args) {\r\n            dispatch(admin.importLabCourse(args))\r\n        }\r\n    }),\r\n)(LabCourse);\r\n"]},"metadata":{},"sourceType":"module"}
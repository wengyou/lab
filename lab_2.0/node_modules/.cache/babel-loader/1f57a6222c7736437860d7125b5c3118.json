{"ast":null,"code":"import axios from \"axios\";\nimport qs from \"qs\";\n\nvar showStatus = function showStatus(status) {\n  var msg = {\n    400: '请求错误(400)',\n    401: '未授权,请重新登录(401)',\n    403: '拒绝访问(403)',\n    404: '请求出错(404)',\n    408: '请求超时(408)',\n    500: '服务器错误(500)',\n    501: '服务未实现(501)',\n    502: '网络错误(502)',\n    503: '服务不可用(503)',\n    504: '网络超时(504)',\n    505: 'HTTP版本不受支持(505)'\n  };\n\n  if (status in msg) {\n    return \"\".concat(msg[status], \",\\u8BF7\\u68C0\\u67E5\\u7F51\\u7EDC\\u6216\\u8054\\u7CFB\\u7BA1\\u7406\\u5458\");\n  } else {\n    return \"\\u8FDE\\u63A5\\u51FA\\u9519(\".concat(status, \"),\\u8BF7\\u68C0\\u67E5\\u7F51\\u7EDC\\u6216\\u8054\\u7CFB\\u7BA1\\u7406\\u5458\");\n  }\n};\n\nvar Service = axios.create({\n  //基本域名 生产环境 ？ “线上服务器域名” ： “本地开发测试域名”\n  baseURL: process.env.NODE_ENV === 'production' ? 'http://172.22.4.2:8080/' : 'http://172.22.4.2:8080/',\n  // baseURL: process.env.NODE_ENV === 'production' ? 'http://49.235.20.228:8080/':'http://49.235.20.228:8080/',\n  //baseURL: 'http://localhost:8080/',\n  headers: {\n    get: {\n      'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'\n    },\n    post: {\n      'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8' // 'Content-Type': 'application/json'\n\n    }\n  },\n  timeout: 30000,\n  transformRequest: [function (data) {\n    // data = JSON.stringify(data);\n    if (Object.prototype.toString.call(data) !== '[object FormData]') data = qs.stringify(data); // data = JSON.stringify(data)\n    // console.log(data.prototype);\n\n    return data;\n  }],\n  validateStatus: function validateStatus() {\n    // 使用async-await，处理reject情况较为繁琐，所以全部返回resolve，在业务代码中处理异常\n    return true;\n  },\n  transformResponse: [function (data) {\n    if (typeof data === 'string' && data.startsWith('{')) {\n      data = JSON.parse(data);\n    }\n\n    return data;\n  }]\n}); //请求拦截器\n\nService.interceptors.request.use(function (config) {\n  var isServer = typeof window === 'undefined';\n\n  if (!isServer) {\n    var token = window.localStorage.getItem('access');\n\n    if (token) {\n      config.headers.common['token'] = token;\n    }\n  }\n\n  return config;\n}, function (error) {\n  error.data = {};\n  error.data.msg = '服务器异常请联系管理员!';\n  return Promise.resolve(error);\n}); //响应拦截器\n\nService.interceptors.response.use(function (response) {\n  var status = response.status;\n  var message = '';\n\n  if (status < 200 || status >= 300) {\n    message = showStatus(status);\n\n    if (typeof response.data === 'string') {\n      response.data = {\n        message: message\n      };\n    } else {\n      response.data.message = message;\n    }\n  }\n\n  return response;\n}, function (error) {\n  error.data = {};\n  error.data.msg = '请求超时或服务器异常,请检查网络或联系管理员!';\n  return Promise.resolve(error);\n});\nexport default Service;","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/lib/Service.js"],"names":["axios","qs","showStatus","status","msg","Service","create","baseURL","process","env","NODE_ENV","headers","get","post","timeout","transformRequest","data","Object","prototype","toString","call","stringify","validateStatus","transformResponse","startsWith","JSON","parse","interceptors","request","use","config","isServer","window","token","localStorage","getItem","common","error","Promise","resolve","response","message"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport qs from \"qs\";\r\n\r\nconst showStatus = (status) => {\r\n    const msg = {\r\n        400: '请求错误(400)',\r\n        401: '未授权,请重新登录(401)',\r\n        403: '拒绝访问(403)',\r\n        404: '请求出错(404)',\r\n        408: '请求超时(408)',\r\n        500: '服务器错误(500)',\r\n        501: '服务未实现(501)',\r\n        502: '网络错误(502)',\r\n        503: '服务不可用(503)',\r\n        504: '网络超时(504)',\r\n        505: 'HTTP版本不受支持(505)'\r\n    };\r\n    if (status in msg) {\r\n        return `${msg[status]},请检查网络或联系管理员`\r\n    } else {\r\n        return `连接出错(${status}),请检查网络或联系管理员`\r\n    }\r\n};\r\n\r\nconst Service = axios.create({\r\n    //基本域名 生产环境 ？ “线上服务器域名” ： “本地开发测试域名”\r\n    baseURL: process.env.NODE_ENV === 'production' ? 'http://172.22.4.2:8080/':'http://172.22.4.2:8080/',\r\n    // baseURL: process.env.NODE_ENV === 'production' ? 'http://49.235.20.228:8080/':'http://49.235.20.228:8080/',\r\n    //baseURL: 'http://localhost:8080/',\r\n        headers: {\r\n            get: {\r\n                'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'\r\n            },\r\n            post: {\r\n                'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'\r\n                // 'Content-Type': 'application/json'\r\n            }\r\n        },\r\n    timeout: 30000,\r\n    transformRequest: [ data => {\r\n        // data = JSON.stringify(data);\r\n        if(Object.prototype.toString.call(data) !== '[object FormData]') data = qs.stringify(data);\r\n        // data = JSON.stringify(data)\r\n        // console.log(data.prototype);\r\n        return data\r\n    }],\r\n    validateStatus () {\r\n        // 使用async-await，处理reject情况较为繁琐，所以全部返回resolve，在业务代码中处理异常\r\n        return true\r\n    },\r\n    transformResponse: [(data) => {\r\n        if (typeof data === 'string' && data.startsWith('{')) {\r\n            data = JSON.parse(data)\r\n        }\r\n        return data\r\n    }]\r\n});\r\n//请求拦截器\r\nService.interceptors.request.use(config => {\r\n    const isServer = typeof window === 'undefined';\r\n    if (!isServer) {\r\n        const token = window.localStorage.getItem('access');\r\n        if (token) {\r\n            config.headers.common['token'] = token;\r\n        }\r\n    }\r\n    return config\r\n},error => {\r\n    error.data = {};\r\n    error.data.msg = '服务器异常请联系管理员!';\r\n    return Promise.resolve(error);\r\n});\r\n//响应拦截器\r\nService.interceptors.response.use(response => {\r\n    const status = response.status;\r\n    let message = '';\r\n    if (status < 200 || status >= 300) {\r\n        message = showStatus(status);\r\n        if (typeof response.data === 'string') {\r\n            response.data = { message };\r\n        } else {\r\n            response.data.message = message;\r\n        }\r\n    }\r\n    return response;\r\n},error => {\r\n    error.data = {};\r\n    error.data.msg = '请求超时或服务器异常,请检查网络或联系管理员!';\r\n    return Promise.resolve(error)\r\n});\r\n\r\nexport default Service;\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _toConsumableArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(handleQueryHomework),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(handleLogin),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(handleRegister),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(handleTeacher),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(handlePreserve),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(handleQueryRegister),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(handleRegistered),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(secretGuardExistence),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(checkQuestion),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(addQuestion),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(watchStudentSagas);import{takeEvery,call,put}from\"redux-saga/effects\";import{LOGIN,QUERY_HOMEWORK,QUERY_HOMEWORK_OK,REGISTER,REGISTER_SUCCESS,TEACHERRES,HANDLE_TEACHERRES_SUCCESS,LOGIN_SUCCESS,PRESERVE,PRESERVE_SUCCESS,FETCH_QUERY_REGISTER,FETCH_QUERY_REGISTER_SUCCESS,REGISTERED,REGISTERED_SUCCESS,SECRET_GUARD_EXISTENCE,SECRET_GUARD_EXISTENCE_SUCCESS,RESET_PASSWARD,CHECK_QUESTION,CHECK_QUESTION_SUCCESS,ADD_QUESTION,ADD_QUESTION_SUCCESS}from\"../../../constants/actionTypes\";import Service from\"../../../lib/Service\";import{openNotification}from\"../../../utils/commonFunction\";function handleQueryHomework(args){var userId,taskId,data,res;return _regeneratorRuntime.wrap(function handleQueryHomework$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;userId=args.userId,taskId=args.taskId;data={userId:userId,taskId:taskId};_context.next=5;return call(Service.post,\"student/queryWork\",data);case 5:res=_context.sent;if(!(res.data.error_code===0)){_context.next=11;break;}_context.next=9;return put({type:QUERY_HOMEWORK_OK,payload:res.data.data});case 9:_context.next=11;break;case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);case 15:case\"end\":return _context.stop();}}},_marked,null,[[0,13]]);}//登录请求\nfunction handleLogin(args){var _args$args,userId,password,data,res,name,id;return _regeneratorRuntime.wrap(function handleLogin$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_args$args=args.args,userId=_args$args.userId,password=_args$args.password;data={userId:userId,password:password};_context2.next=5;return call(Service.post,\"login\",data);case 5:res=_context2.sent;_context2.t0=res.data.error_code;_context2.next=_context2.t0===-1?9:_context2.t0===0?11:_context2.t0===2?28:_context2.t0===1?30:_context2.t0===300?32:37;break;case 9:openNotification(res.data.message);return _context2.abrupt(\"break\",38);case 11:name=res.data.data.userName;id=\"游客\";_context2.t1=res.data.data.type;_context2.next=_context2.t1===\"student\"?16:_context2.t1===\"teacher\"?18:_context2.t1===\"admin\"?20:22;break;case 16:id=\"学生\";return _context2.abrupt(\"break\",23);case 18:id=\"教师\";return _context2.abrupt(\"break\",23);case 20:id=\"超级管理员\";return _context2.abrupt(\"break\",23);case 22:return _context2.abrupt(\"return\",id);case 23:localStorage.setItem(\"access\",res.data.data.token);_context2.next=26;return put({type:LOGIN_SUCCESS,payload:{id:id,name:name,userId:res.data.data.userId,academy:res.data.data.academy,class:res.data.data.cls,discipline:res.data.data.discipline,grade:res.data.data.grade,sex:res.data.data.sex,type:res.data.data.type,phone:res.data.data.phone,password:res.data.data.password}});case 26:openNotification(res.data.message,\"已登陆\");return _context2.abrupt(\"break\",38);case 28:openNotification(res.data.message,\"登录失败\");return _context2.abrupt(\"break\",38);case 30:openNotification(res.data.message);return _context2.abrupt(\"break\",38);case 32:localStorage.setItem(\"access\",res.data.data.token);_context2.next=35;return put({type:RESET_PASSWARD,payload:res.data.data});case 35:openNotification('您是新用户，请添加密保问题');return _context2.abrupt(\"break\",38);case 37:return _context2.abrupt(\"return\",0);case 38:_context2.next=43;break;case 40:_context2.prev=40;_context2.t2=_context2[\"catch\"](0);console.log(_context2.t2);case 43:case\"end\":return _context2.stop();}}},_marked2,null,[[0,40]]);}//注册请求\nfunction handleRegister(args){var _args$args2,academy,cls,discipline,grade,password,phone,sex,teacherId,userId,userName,data,res;return _regeneratorRuntime.wrap(function handleRegister$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_args$args2=args.args,academy=_args$args2.academy,cls=_args$args2.cls,discipline=_args$args2.discipline,grade=_args$args2.grade,password=_args$args2.password,phone=_args$args2.phone,sex=_args$args2.sex,teacherId=_args$args2.teacherId,userId=_args$args2.userId,userName=_args$args2.userName;data={academy:academy,cls:cls,discipline:discipline,grade:grade,password:password,phone:phone,sex:sex,teacherId:teacherId,userId:userId,userName:userName};_context3.next=5;return call(Service.post,\"register\",data);case 5:res=_context3.sent;_context3.t0=res.data.error_code;_context3.next=_context3.t0===0?9:_context3.t0===-1?13:_context3.t0===1?15:_context3.t0===2?17:19;break;case 9:_context3.next=11;return put({type:REGISTER_SUCCESS});case 11:openNotification(res.data.message);return _context3.abrupt(\"break\",20);case 13:openNotification(res.data.message);return _context3.abrupt(\"break\",20);case 15:openNotification(res.data.message);return _context3.abrupt(\"break\",20);case 17:openNotification(res.data.message);return _context3.abrupt(\"break\",20);case 19:return _context3.abrupt(\"return\",0);case 20:_context3.next=25;break;case 22:_context3.prev=22;_context3.t1=_context3[\"catch\"](0);console.log(_context3.t1);case 25:case\"end\":return _context3.stop();}}},_marked3,null,[[0,22]]);}//请求所有老师姓名\nfunction handleTeacher(){var teacherRes,itemsArr,teacherName;return _regeneratorRuntime.wrap(function handleTeacher$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return call(Service.get,\"queryAllTeacher\");case 3:teacherRes=_context4.sent;itemsArr=teacherRes.data.data.items;teacherName=itemsArr.map(function(item,index){return[item.userName,item.userId];});_context4.t0=teacherRes.data.error_code;_context4.next=_context4.t0===0?9:_context4.t0===-1?12:_context4.t0===1?14:_context4.t0===2?16:18;break;case 9:_context4.next=11;return put({type:HANDLE_TEACHERRES_SUCCESS,payload:_toConsumableArray(teacherName)});case 11:return _context4.abrupt(\"break\",19);case 12:openNotification(teacherRes.data.message);return _context4.abrupt(\"break\",19);case 14:openNotification(teacherRes.data.message);return _context4.abrupt(\"break\",19);case 16:openNotification(teacherRes.data.message);return _context4.abrupt(\"break\",19);case 18:return _context4.abrupt(\"return\",0);case 19:_context4.next=24;break;case 21:_context4.prev=21;_context4.t1=_context4[\"catch\"](0);console.log(_context4.t1);case 24:case\"end\":return _context4.stop();}}},_marked4,null,[[0,21]]);}//修改自己信息\nfunction handlePreserve(args){var _args$args3,userId,userName,grade,academy,discipline,cls,phone,sex,password,data,res;return _regeneratorRuntime.wrap(function handlePreserve$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_args$args3=args.args,userId=_args$args3.userId,userName=_args$args3.userName,grade=_args$args3.grade,academy=_args$args3.academy,discipline=_args$args3.discipline,cls=_args$args3.cls,phone=_args$args3.phone,sex=_args$args3.sex,password=_args$args3.password;data={userId:userId,userName:userName,grade:grade,academy:academy,discipline:discipline,cls:cls,phone:phone,sex:sex,password:password};_context5.next=5;return call(Service.post,\"user/updateMySelfInfo\",data);case 5:res=_context5.sent;_context5.t0=res.data.error_code;_context5.next=_context5.t0===0?9:_context5.t0===-1?13:_context5.t0===1?15:_context5.t0===2?17:19;break;case 9:_context5.next=11;return put({type:PRESERVE_SUCCESS,payload:res.data.data});case 11:openNotification(res.data.message);return _context5.abrupt(\"break\",20);case 13:openNotification(res.data.message);return _context5.abrupt(\"break\",20);case 15:openNotification(res.data.message);return _context5.abrupt(\"break\",20);case 17:openNotification(res.data.message);return _context5.abrupt(\"break\",20);case 19:openNotification(\"修改密码失败\");case 20:_context5.next=24;break;case 22:_context5.prev=22;_context5.t1=_context5[\"catch\"](0);case 24:case\"end\":return _context5.stop();}}},_marked5,null,[[0,22]]);}//老师查询待批准的学生\nfunction handleQueryRegister(data){var _data$args,userId,type,page,url,res;return _regeneratorRuntime.wrap(function handleQueryRegister$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_data$args=data.args,userId=_data$args.userId,type=_data$args.type,page=_data$args.page;url=\"register/queryRegister?userId=\".concat(userId,\"&type=\").concat(type,\"&page=\").concat(page);_context6.next=4;return call(Service.get,url);case 4:res=_context6.sent;_context6.t0=res.data.error_code;_context6.next=_context6.t0===0?8:_context6.t0===-1?11:_context6.t0===1?13:_context6.t0===2?15:17;break;case 8:_context6.next=10;return put({type:FETCH_QUERY_REGISTER_SUCCESS,payload:res.data.data});case 10:return _context6.abrupt(\"break\",18);case 11:openNotification(res.data.message);return _context6.abrupt(\"break\",18);case 13:openNotification(res.data.message);return _context6.abrupt(\"break\",18);case 15:openNotification(res.data.message);return _context6.abrupt(\"break\",18);case 17:return _context6.abrupt(\"return\",0);case 18:case\"end\":return _context6.stop();}}},_marked6);}//老师批准注册用户\nfunction handleRegistered(args){var userId,formData,list,data,res;return _regeneratorRuntime.wrap(function handleRegistered$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:userId=args.args.userId;formData=new FormData();formData.append(\"list\",userId);list=formData.get(\"list\");data={list:list};_context7.next=7;return call(Service.post,\"register/registered\",data);case 7:res=_context7.sent;_context7.t0=res.data.error_code;_context7.next=_context7.t0===0?11:_context7.t0===-1?15:_context7.t0===2?17:19;break;case 11:_context7.next=13;return put({type:REGISTERED_SUCCESS});case 13:openNotification(res.data.message);return _context7.abrupt(\"break\",20);case 15:openNotification(res.data.message);return _context7.abrupt(\"break\",20);case 17:openNotification(res.data.message);return _context7.abrupt(\"break\",20);case 19:return _context7.abrupt(\"return\",0);case 20:case\"end\":return _context7.stop();}}},_marked7);}//查询是否有密保问题\nfunction secretGuardExistence(args){var res;return _regeneratorRuntime.wrap(function secretGuardExistence$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return call(Service.get,\"user/secretGuardExistence?userId=\".concat(args.args));case 2:res=_context8.sent;if(!(res.data.error_code===0)){_context8.next=8;break;}_context8.next=6;return put({type:SECRET_GUARD_EXISTENCE_SUCCESS,payload:res.data.data});case 6:_context8.next=9;break;case 8:openNotification(res.data.message);case 9:case\"end\":return _context8.stop();}}},_marked8);}//验证密保\nfunction checkQuestion(args){var res;return _regeneratorRuntime.wrap(function checkQuestion$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return call(Service.get,\"user/checkSecretGuard?userId=\".concat(args.args.userId,\"&question=\").concat(args.args.question,\"&answer=\").concat(args.args.answer));case 2:res=_context9.sent;if(!(res.data.error_code===0)){_context9.next=9;break;}openNotification('验证密保问题成功');_context9.next=7;return put({type:CHECK_QUESTION_SUCCESS});case 7:_context9.next=10;break;case 9:openNotification(res.data.message);case 10:case\"end\":return _context9.stop();}}},_marked9);}//添加密保\nfunction addQuestion(args){var res;return _regeneratorRuntime.wrap(function addQuestion$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return call(Service.post,'user/addSecretGuard',args.args);case 2:res=_context10.sent;if(!(res.data.error_code===0)){_context10.next=9;break;}openNotification('添加密保问题成功');_context10.next=7;return put({type:ADD_QUESTION_SUCCESS});case 7:_context10.next=10;break;case 9:openNotification(res.data.message);case 10:case\"end\":return _context10.stop();}}},_marked10);}export default function watchStudentSagas(){return _regeneratorRuntime.wrap(function watchStudentSagas$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeEvery(QUERY_HOMEWORK,handleQueryHomework);case 2:_context11.next=4;return takeEvery(LOGIN,handleLogin);case 4:_context11.next=6;return takeEvery(REGISTER,handleRegister);case 6:_context11.next=8;return takeEvery(TEACHERRES,handleTeacher);case 8:_context11.next=10;return takeEvery(PRESERVE,handlePreserve);case 10:_context11.next=12;return takeEvery(FETCH_QUERY_REGISTER,handleQueryRegister);case 12:_context11.next=14;return takeEvery(REGISTERED,handleRegistered);case 14:_context11.next=16;return takeEvery(SECRET_GUARD_EXISTENCE,secretGuardExistence);case 16:_context11.next=18;return takeEvery(CHECK_QUESTION,checkQuestion);case 18:_context11.next=20;return takeEvery(ADD_QUESTION,addQuestion);case 20:case\"end\":return _context11.stop();}}},_marked11);}","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/redux/sagas/userSagas/allUser.js"],"names":["handleQueryHomework","handleLogin","handleRegister","handleTeacher","handlePreserve","handleQueryRegister","handleRegistered","secretGuardExistence","checkQuestion","addQuestion","watchStudentSagas","takeEvery","call","put","LOGIN","QUERY_HOMEWORK","QUERY_HOMEWORK_OK","REGISTER","REGISTER_SUCCESS","TEACHERRES","HANDLE_TEACHERRES_SUCCESS","LOGIN_SUCCESS","PRESERVE","PRESERVE_SUCCESS","FETCH_QUERY_REGISTER","FETCH_QUERY_REGISTER_SUCCESS","REGISTERED","REGISTERED_SUCCESS","SECRET_GUARD_EXISTENCE","SECRET_GUARD_EXISTENCE_SUCCESS","RESET_PASSWARD","CHECK_QUESTION","CHECK_QUESTION_SUCCESS","ADD_QUESTION","ADD_QUESTION_SUCCESS","Service","openNotification","args","userId","taskId","data","post","res","error_code","type","payload","password","message","name","userName","id","localStorage","setItem","token","academy","class","cls","discipline","grade","sex","phone","console","log","teacherId","get","teacherRes","itemsArr","items","teacherName","map","item","index","page","url","formData","FormData","append","list","question","answer"],"mappings":"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","sourcesContent":["import { takeEvery, call, put } from \"redux-saga/effects\";\r\nimport {\r\n    LOGIN,\r\n    QUERY_HOMEWORK,\r\n    QUERY_HOMEWORK_OK,\r\n    REGISTER,\r\n    REGISTER_SUCCESS,\r\n    TEACHERRES,\r\n    HANDLE_TEACHERRES_SUCCESS,\r\n    LOGIN_SUCCESS,\r\n    PRESERVE,\r\n    PRESERVE_SUCCESS,\r\n    FETCH_QUERY_REGISTER,\r\n    FETCH_QUERY_REGISTER_SUCCESS,\r\n    REGISTERED,\r\n    REGISTERED_SUCCESS,\r\n    SECRET_GUARD_EXISTENCE,\r\n    SECRET_GUARD_EXISTENCE_SUCCESS,\r\n    RESET_PASSWARD,\r\n    CHECK_QUESTION,\r\n    CHECK_QUESTION_SUCCESS,\r\n    ADD_QUESTION,\r\n    ADD_QUESTION_SUCCESS\r\n} from \"../../../constants/actionTypes\";\r\nimport Service from \"../../../lib/Service\";\r\nimport { openNotification } from \"../../../utils/commonFunction\";\r\n\r\nfunction *handleQueryHomework(args) {\r\n    try {\r\n        const { userId, taskId } = args;\r\n        const data = { userId, taskId };\r\n        const res = yield call(Service.post, \"student/queryWork\", data);\r\n        if (res.data.error_code === 0) {\r\n            yield put({type: QUERY_HOMEWORK_OK, payload: res.data.data})\r\n        } else {\r\n\r\n        }\r\n    } catch (e) {\r\n\r\n    }\r\n}\r\n\r\n//登录请求\r\nfunction *handleLogin(args) {\r\n    try {\r\n        const { userId, password} = args.args;\r\n        const data = { userId, password };\r\n        const res = yield call(Service.post, \"login\", data);\r\n        switch (res.data.error_code) {\r\n            case -1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 0:\r\n                let name = res.data.data.userName;\r\n                let id = \"游客\";\r\n                switch (res.data.data.type) {\r\n                    case \"student\":\r\n                        id = \"学生\";\r\n                        break;\r\n                    case \"teacher\":\r\n                        id = \"教师\";\r\n                        break;\r\n                    case \"admin\":\r\n                        id = \"超级管理员\";\r\n                        break;\r\n                    default:\r\n                        return id;\r\n                }\r\n                localStorage.setItem(\"access\", res.data.data.token);\r\n                yield put({\r\n                    type: LOGIN_SUCCESS,\r\n                    payload: {\r\n                        id,\r\n                        name,\r\n                        userId: res.data.data.userId,\r\n                        academy: res.data.data.academy,\r\n                        class: res.data.data.cls,\r\n                        discipline: res.data.data.discipline,\r\n                        grade: res.data.data.grade,\r\n                        sex: res.data.data.sex,\r\n                        type: res.data.data.type,\r\n                        phone: res.data.data.phone,\r\n                        password: res.data.data.password,\r\n                    }\r\n                });\r\n                openNotification(res.data.message, \"已登陆\");\r\n                break;\r\n            case 2:\r\n                openNotification(res.data.message, \"登录失败\");\r\n                break;\r\n            case 1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 300:\r\n                localStorage.setItem(\"access\", res.data.data.token);\r\n                yield put({\r\n                    type: RESET_PASSWARD,\r\n                    payload: res.data.data\r\n                });\r\n                openNotification('您是新用户，请添加密保问题');\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    } catch (e) {\r\n        console.log(e)\r\n    }\r\n}\r\n\r\n//注册请求\r\nfunction *handleRegister(args) {\r\n    try {\r\n        const { academy, cls, discipline, grade, password, phone, sex, teacherId, userId, userName } = args.args;\r\n        const data = {academy, cls, discipline, grade, password, phone, sex, teacherId, userId, userName};\r\n        const res = yield call(Service.post, \"register\", data);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: REGISTER_SUCCESS,\r\n                });\r\n                openNotification(res.data.message);\r\n                break;\r\n            case -1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 2:\r\n                openNotification(res.data.message);\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    } catch (e) {\r\n        console.log(e)\r\n    }\r\n}\r\n\r\n//请求所有老师姓名\r\nfunction *handleTeacher() {\r\n    try {\r\n        const teacherRes = yield call(Service.get, \"queryAllTeacher\");\r\n        let itemsArr = teacherRes.data.data.items;\r\n        let teacherName = itemsArr.map((item,index) => {\r\n            return  [item.userName, item.userId];\r\n        });\r\n        switch (teacherRes.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: HANDLE_TEACHERRES_SUCCESS,\r\n                    payload: [...teacherName]\r\n                });\r\n                break;\r\n            case -1:\r\n                openNotification(teacherRes.data.message);\r\n                break;\r\n            case 1:\r\n                openNotification(teacherRes.data.message);\r\n                break;\r\n            case 2:\r\n                openNotification(teacherRes.data.message);\r\n                break;\r\n            default:\r\n                return 0\r\n        }\r\n    } catch (e) {\r\n        console.log(e)\r\n    }\r\n}\r\n\r\n//修改自己信息\r\nfunction *handlePreserve(args) {\r\n    try {\r\n        const {userId, userName, grade, academy, discipline, cls, phone, sex, password} = args.args;\r\n        const data = {userId, userName, grade, academy, discipline, cls, phone, sex, password};\r\n        const res = yield call(Service.post, \"user/updateMySelfInfo\", data);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: PRESERVE_SUCCESS,\r\n                    payload: res.data.data\r\n                });\r\n                openNotification(res.data.message);\r\n                break;\r\n            case -1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 1:\r\n                openNotification(res.data.message);\r\n                break;\r\n            case 2:\r\n                openNotification(res.data.message);\r\n                break;\r\n            default:\r\n                openNotification(\"修改密码失败\");\r\n        }\r\n    } catch(e) {\r\n\r\n    }\r\n}\r\n\r\n//老师查询待批准的学生\r\nfunction *handleQueryRegister(data) {\r\n    const { userId, type, page } = data.args;\r\n    const url = `register/queryRegister?userId=${userId}&type=${type}&page=${page}`;\r\n    const res = yield call(Service.get, url);\r\n    switch (res.data.error_code) {\r\n        case 0:\r\n            yield put({\r\n                type: FETCH_QUERY_REGISTER_SUCCESS,\r\n                payload: res.data.data\r\n            });\r\n            break;\r\n        case -1:\r\n            openNotification(res.data.message);\r\n            break;\r\n        case 1:\r\n            openNotification(res.data.message);\r\n            break;\r\n        case 2:\r\n            openNotification(res.data.message);\r\n            break;\r\n        default:\r\n            return 0\r\n    }\r\n}\r\n\r\n//老师批准注册用户\r\nfunction *handleRegistered(args) {\r\n    const {userId} = args.args;\r\n    let formData = new FormData();\r\n    formData.append(\"list\", userId);\r\n    const list = formData.get(\"list\");\r\n    const data = {list};\r\n    const res = yield call(Service.post, \"register/registered\" ,data);\r\n    switch (res.data.error_code) {\r\n        case 0:\r\n            yield put({\r\n                type: REGISTERED_SUCCESS,\r\n            });\r\n            openNotification(res.data.message);\r\n            break;\r\n        case -1:\r\n            openNotification(res.data.message);\r\n            break;\r\n        case 2:\r\n            openNotification(res.data.message);\r\n            break;\r\n        default:\r\n            return 0;\r\n    }\r\n}\r\n\r\n//查询是否有密保问题\r\nfunction *secretGuardExistence(args) {\r\n    const res = yield call(Service.get, `user/secretGuardExistence?userId=${args.args}`);\r\n    if(res.data.error_code === 0) {\r\n        yield put({\r\n            type: SECRET_GUARD_EXISTENCE_SUCCESS,\r\n            payload: res.data.data\r\n        })\r\n    } else {\r\n        openNotification(res.data.message)\r\n    }\r\n}\r\n//验证密保\r\nfunction *checkQuestion(args) {\r\n    const res = yield call(Service.get, `user/checkSecretGuard?userId=${args.args.userId}&question=${args.args.question}&answer=${args.args.answer}`,);\r\n    if(res.data.error_code === 0) {\r\n        openNotification('验证密保问题成功')\r\n        yield put({\r\n            type: CHECK_QUESTION_SUCCESS,\r\n        })\r\n    } else {\r\n        openNotification(res.data.message)\r\n    }\r\n}\r\n\r\n//添加密保\r\nfunction *addQuestion(args) {\r\n    const res = yield call(Service.post, 'user/addSecretGuard', args.args);\r\n    if(res.data.error_code === 0) {\r\n        openNotification('添加密保问题成功')\r\n        yield put({\r\n            type: ADD_QUESTION_SUCCESS,\r\n        })\r\n    } else {\r\n        openNotification(res.data.message)\r\n    }\r\n}\r\n\r\nexport default function *watchStudentSagas() {\r\n    yield takeEvery(QUERY_HOMEWORK, handleQueryHomework);\r\n    yield takeEvery(LOGIN, handleLogin);\r\n    yield takeEvery(REGISTER, handleRegister);\r\n    yield takeEvery(TEACHERRES,handleTeacher);\r\n    yield takeEvery(PRESERVE, handlePreserve);\r\n    yield takeEvery(FETCH_QUERY_REGISTER, handleQueryRegister);\r\n    yield takeEvery(REGISTERED, handleRegistered);\r\n    yield takeEvery(SECRET_GUARD_EXISTENCE, secretGuardExistence);\r\n    yield takeEvery(CHECK_QUESTION, checkQuestion);\r\n    yield takeEvery(ADD_QUESTION, addQuestion);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}
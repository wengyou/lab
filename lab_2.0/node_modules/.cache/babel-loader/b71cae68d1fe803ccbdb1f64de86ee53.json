{"ast":null,"code":"import\"antd/es/upload/style/css\";import _Upload from\"antd/es/upload\";import\"antd/es/button/style/css\";import _Button from\"antd/es/button\";import\"antd/es/icon/style/css\";import _Icon from\"antd/es/icon\";import _toConsumableArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{connect}from\"react-redux\";import{withRouter}from'react-router-dom';import\"../static/style/learningDatas.scss\";import*as resource from\"../redux/actionCreators/resource\";var UpLoad=function UpLoad(props){var handleUpload=props.handleUpload,userId=props.userId,userName=props.userName,time=props.time,uploadFlag=props.uploadFlag,history=props.history;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),fileList=_useState2[0],setFileList=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),uploading=_useState4[0],setUploading=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),type=_useState6[0],setType=_useState6[1];useEffect(function(){setUploading(false);},[uploadFlag]);useEffect(function(){history.location.pathname===\"/user/resource/myresource\"&&setType('material');history.location.pathname===\"/user/download/mysoftware\"&&setType('software');},[history.location.pathname]);return/*#__PURE__*/React.createElement(\"div\",{key:time},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex'},className:\"uploadWrap\"},/*#__PURE__*/React.createElement(_Upload,{beforeUpload:function beforeUpload(file){fileList.push(file);setFileList(_toConsumableArray(fileList));return false;},onRemove:function onRemove(file){var index=fileList.indexOf(file);var newFileList=fileList.slice();fileList.splice(index,1);}},/*#__PURE__*/React.createElement(_Button,null,/*#__PURE__*/React.createElement(_Icon,{type:\"upload\"}),type===\"material\"?\"选择资料\":\"选择软件\")),/*#__PURE__*/React.createElement(_Button,{key:time,type:\"primary\",loading:uploading,style:{margin:16},onClick:function onClick(){fileList.forEach(function(file){handleUpload({type:type,userId:userId,file:file,userName:userName,page:1});});setFileList([]);setUploading(true);},disabled:fileList.length===0},/*#__PURE__*/React.createElement(_Icon,{type:\"upload\"}),uploading?'资料上传':'开始上传')),/*#__PURE__*/React.createElement(\"style\",null,\"\\n                        .uploadWrap > span {\\n                            display: flex;\\n                            align-items: center;\\n                        }\\n                    \"));};export default withRouter(connect(function(state){return{type:state.getIn([\"resource\",\"resource\",\"type\"]),userId:state.getIn([\"userMana\",\"common\",\"userId\"]),userName:state.getIn([\"userMana\",\"common\",\"name\"]),time:state.getIn([\"resource\",\"resource\",\"time\"]),uploadFlag:state.getIn([\"resource\",\"resource\",\"uploadFlag\"])};},function(dispatch){return{handleUpload:function handleUpload(args){dispatch(resource.fetchUploadStudyRes(args));}};})(UpLoad));","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/components/UpLoad.js"],"names":["React","useState","useEffect","connect","withRouter","resource","UpLoad","props","handleUpload","userId","userName","time","uploadFlag","history","fileList","setFileList","uploading","setUploading","type","setType","location","pathname","display","file","push","index","indexOf","newFileList","slice","splice","margin","forEach","page","length","state","getIn","dispatch","args","fetchUploadStudyRes"],"mappings":"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","sourcesContent":["import React,{ useState, useEffect} from \"react\";\r\nimport { Upload,Button, Icon } from 'antd';\r\nimport { connect } from \"react-redux\";\r\nimport { withRouter } from 'react-router-dom';\r\nimport \"../static/style/learningDatas.scss\";\r\nimport * as resource from \"../redux/actionCreators/resource\";\r\n\r\nconst UpLoad = props => {\r\n    const {handleUpload, userId, userName, time, uploadFlag, history } = props;\r\n    const [ fileList, setFileList,] = useState([]);\r\n    const [ uploading, setUploading ] = useState(false);\r\n    const [type, setType] = useState('')\r\n    useEffect(() => {\r\n        setUploading(false);\r\n    }, [uploadFlag]);\r\n    useEffect(() => {\r\n        history.location.pathname === \"/user/resource/myresource\" && setType('material')\r\n        history.location.pathname === \"/user/download/mysoftware\" && setType('software')\r\n    }, [history.location.pathname])\r\n    return(\r\n        <div key={ time }>\r\n            <div style={{display: 'flex'}} className='uploadWrap'>\r\n                <Upload\r\n                    beforeUpload={\r\n                        file => {\r\n                            fileList.push(file);\r\n                            setFileList([...fileList]);\r\n                            return false\r\n                        }\r\n                    }\r\n                    onRemove={\r\n                        file => {\r\n                            const index = fileList.indexOf(file);\r\n                            const newFileList = fileList.slice();\r\n                            fileList.splice(index, 1);\r\n                        }\r\n                    }\r\n                >\r\n                    <Button >\r\n                        <Icon type=\"upload\" />\r\n                        {type === \"material\" ? \"选择资料\": \"选择软件\"}\r\n                    </Button>\r\n                </Upload>\r\n                <Button\r\n                    key={time}\r\n                    type=\"primary\"\r\n                    loading={uploading}\r\n                    style={{ margin: 16 }}\r\n                    onClick={\r\n                        () => {\r\n                            fileList.forEach((file) => {\r\n                                handleUpload({\r\n                                    type: type,\r\n                                    userId: userId,\r\n                                    file: file,\r\n                                    userName: userName,\r\n                                    page: 1\r\n                                });\r\n                            });\r\n                            setFileList([]);\r\n                            setUploading(true);\r\n                        }\r\n                    }\r\n                    disabled={fileList.length === 0}\r\n                >\r\n                    <Icon type=\"upload\" />\r\n                    {uploading ? '资料上传' : '开始上传'}\r\n                </Button>\r\n            </div>\r\n\r\n            {/* <Button\r\n                key={time}\r\n                type=\"primary\"\r\n                loading={uploading}\r\n                style={{ marginTop: 16 }}\r\n                onClick={\r\n                    () => {\r\n                        fileList.forEach((file) => {\r\n                            handleUpload({\r\n                                type: type,\r\n                                userId: userId,\r\n                                file: file,\r\n                                userName: userName,\r\n                                page: 1\r\n                            });\r\n                        });\r\n                        setFileList([]);\r\n                        setUploading(true);\r\n                    }\r\n                }\r\n                disabled={fileList.length === 0}\r\n            >\r\n                <Icon type=\"upload\" />\r\n                {uploading ? '资料上传' : '开始上传'}\r\n            </Button> */}\r\n            <style>\r\n                {\r\n                    `\r\n                        .uploadWrap > span {\r\n                            display: flex;\r\n                            align-items: center;\r\n                        }\r\n                    `\r\n                }\r\n            </style>\r\n        </div>\r\n    )\r\n};\r\n\r\nexport default withRouter(connect(\r\n    state => ({\r\n        type: state.getIn([\"resource\", \"resource\", \"type\"]),\r\n        userId: state.getIn([\"userMana\", \"common\", \"userId\"]),\r\n        userName: state.getIn([\"userMana\", \"common\", \"name\"]),\r\n        time: state.getIn([\"resource\", \"resource\", \"time\"]),\r\n        uploadFlag: state.getIn([\"resource\", \"resource\", \"uploadFlag\"])\r\n    }),\r\n    dispatch => ({\r\n        handleUpload(args) {\r\n            dispatch(resource.fetchUploadStudyRes(args))\r\n        }\r\n    })\r\n)(UpLoad));\r\n"]},"metadata":{},"sourceType":"module"}
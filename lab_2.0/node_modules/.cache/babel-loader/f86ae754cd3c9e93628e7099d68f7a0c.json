{"ast":null,"code":"import\"antd/es/table/style/css\";import _Table from\"antd/es/table\";import\"antd/es/upload/style/css\";import _Upload from\"antd/es/upload\";import\"antd/es/button/style/css\";import _Button from\"antd/es/button\";import\"antd/es/icon/style/css\";import _Icon from\"antd/es/icon\";import _slicedToArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import\"antd/es/select/style/css\";import _Select from\"antd/es/select\";import\"antd/es/input/style/css\";import _Input from\"antd/es/input\";import React,{useEffect,useRef,useState}from\"react\";import{connect}from\"react-redux\";import*as admin from\"../../redux/actionCreators/admin\";import*as resource from\"../../redux/actionCreators/resource\";import\"../../static/style/admin.scss\";var Search=_Input.Search;var InputGroup=_Input.Group;var Option=_Select.Option;var mapStateToState=function mapStateToState(state){return{softwareData:state.getIn([\"admin\",\"resourceManage\",\"softwareData\"]),total:state.getIn([\"admin\",\"resourceManage\",\"softwareTotal\"]),userId:state.getIn([\"userMana\",\"common\",\"userId\"]),page:state.getIn([\"admin\",\"resourceManage\",\"softwarePage\"]),temp:state.getIn([\"admin\",\"resourceManage\",\"temp\"]),searchFlag:state.getIn([\"admin\",\"resourceManage\",\"softwareSearchFlag\"]),softwareDataTemp:state.getIn([\"resource\",\"resource\",\"softwareDataTemp\"])};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{handleAdminSoftwareData:function handleAdminSoftwareData(args){dispatch(admin.fetchAdminSoftwareData(args));},handleDeleteSoftwareData:function handleDeleteSoftwareData(args){dispatch(admin.deleteSoftwareData(args));},handleSearchSoftwareData:function handleSearchSoftwareData(args){dispatch(admin.searchSoftwareData(args));},handleImportSoftware:function handleImportSoftware(args){dispatch(admin.importSoftware(args));},handleDownloadSoftware:function handleDownloadSoftware(args){dispatch(resource.downloadSoftware(args));}};};var StudySoftware=function StudySoftware(props){var temp=props.temp,softwareDataTemp=props.softwareDataTemp,total=props.total,handleAdminSoftwareData=props.handleAdminSoftwareData,handleDeleteSoftwareData=props.handleDeleteSoftwareData,handleSearchSoftwareData=props.handleSearchSoftwareData,handleImportSoftware=props.handleImportSoftware,handleDownloadSoftware=props.handleDownloadSoftware,softwareData=props.softwareData,userId=props.userId,page=props.page,searchFlag=props.searchFlag;var columns=[{key:'1',title:'软件名称',dataIndex:'title'},{key:'2',title:'大小',dataIndex:'size'},{key:'3',title:'上传人',dataIndex:'userName'},{key:'4',title:'上传时间',dataIndex:'addTime'},{key:'5',title:'下载次数',dataIndex:'downloadNum'},{key:'6',title:'软件下载',dataIndex:\"url\",render:function render(text,record){return/*#__PURE__*/React.createElement(\"a\",{download:{text:text}.text,href:{text:text}.text,onClick:function onClick(){handleDownloadSoftware({id:record.id,type:\"software\"});}},\"\\u4E0B\\u8F7D\");}}];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),$selectedRowKeys=_useState2[0],changeSelectedRowKeys=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),list=_useState4[0],setList=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),current=_useState6[0],setCurrent=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),selectedRowKeys=_useState8[0],setSelectedRowKeys=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),file=_useState10[0],setFile=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),value=_useState12[0],setValue=_useState12[1];var _useState13=useState(1),_useState14=_slicedToArray(_useState13,2),presentPage=_useState14[0],setPresentPage=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),deleteBtn=_useState16[0],setDeleteBtn=_useState16[1];var flag=\"softwareName\";var clearCheck=function clearCheck(){setSelectedRowKeys([]);};useEffect(function(){handleAdminSoftwareData(presentPage===1?{page:1,type:\"software\"}:Math.ceil(total/10)>presentPage?{page:presentPage,type:\"software\"}:{page:presentPage-1,type:\"software\"});},[temp,softwareDataTemp]);useEffect(function(){setCurrent(page);},[page]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"adminTop\"},/*#__PURE__*/React.createElement(_Upload,{style:{marginLeft:\"0.5rem\"},beforeUpload:function beforeUpload(file,FileList){setFile(file);},customRequest:function customRequest(){handleImportSoftware({type:\"software\",userId:userId,file:file});},showUploadList:false},/*#__PURE__*/React.createElement(_Button,null,/*#__PURE__*/React.createElement(_Icon,{type:\"upload\"}),\" \\u4E0A\\u4F20\\u8F6F\\u4EF6\")),/*#__PURE__*/React.createElement(_Button,{disabled:deleteBtn,style:{marginLeft:\"0.5rem\"},icon:\"close\",onClick:function onClick(){handleDeleteSoftwareData({list:list,type:\"software\",userId:userId});}},\"\\u5220\\u9664\\u8F6F\\u4EF6\"),/*#__PURE__*/React.createElement(InputGroup,{compact:true,style:{display:\"flex\",flexWrap:\"nowrap\",width:\"20rem\",marginLeft:\"0.5rem\"}},/*#__PURE__*/React.createElement(_Select,{defaultValue:\"softwareName\",onChange:function onChange(value){return flag=value;}},/*#__PURE__*/React.createElement(Option,{value:\"softwareName\"},\"\\u8F6F\\u4EF6\\u540D\"),/*#__PURE__*/React.createElement(Option,{value:\"userName\"},\"\\u4E0A\\u4F20\\u4EBA\")),/*#__PURE__*/React.createElement(Search,{placeholder:\"请输入搜索内容\",onSearch:function onSearch(value){handleSearchSoftwareData({page:1,value:value,type:\"software\",flag:flag});setValue(value);},enterButton:true,style:{width:\"16rem\"}}))),/*#__PURE__*/React.createElement(_Table,{tableLayout:\"fixed\",rowKey:function rowKey(record){return record.id;},columns:columns,rowSelection:{selectedRowKeys:selectedRowKeys,onChange:function onChange(selectedRowKeys,selectedRows){var resourceId=selectedRows.map(function(el){return el.id;});setList(resourceId);changeSelectedRowKeys(resourceId);setSelectedRowKeys(selectedRowKeys);selectedRowKeys.length>0?setDeleteBtn(false):setDeleteBtn(true);}},dataSource:Array.from(softwareData),pagination:{total:total,current:current,onChange:function onChange(page){!searchFlag?handleAdminSoftwareData({page:page,type:\"software\"}):handleSearchSoftwareData({page:page,value:value,type:\"software\",flag:flag});clearCheck();setPresentPage(page);}}}));};export default connect(mapStateToState,mapDispatchToProps)(StudySoftware);","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/components/Administrator/StudySoftware.js"],"names":["React","useEffect","useRef","useState","connect","admin","resource","Search","InputGroup","Group","Option","mapStateToState","state","softwareData","getIn","total","userId","page","temp","searchFlag","softwareDataTemp","mapDispatchToProps","dispatch","handleAdminSoftwareData","args","fetchAdminSoftwareData","handleDeleteSoftwareData","deleteSoftwareData","handleSearchSoftwareData","searchSoftwareData","handleImportSoftware","importSoftware","handleDownloadSoftware","downloadSoftware","StudySoftware","props","columns","key","title","dataIndex","render","text","record","id","type","$selectedRowKeys","changeSelectedRowKeys","list","setList","current","setCurrent","selectedRowKeys","setSelectedRowKeys","file","setFile","value","setValue","presentPage","setPresentPage","deleteBtn","setDeleteBtn","flag","clearCheck","Math","ceil","marginLeft","FileList","display","flexWrap","width","onChange","selectedRows","resourceId","map","el","length","Array","from"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {Button, Table, Input, Select,Upload, Icon} from 'antd';\r\nimport * as admin from \"../../redux/actionCreators/admin\";\r\nimport * as resource from \"../../redux/actionCreators/resource\";\r\nimport \"../../static/style/admin.scss\";\r\nconst { Search } = Input;\r\nconst InputGroup = Input.Group;\r\nconst { Option } = Select;\r\n\r\nconst mapStateToState = state => ({\r\n    softwareData: state.getIn([\"admin\", \"resourceManage\", \"softwareData\"]),\r\n    total: state.getIn([\"admin\", \"resourceManage\", \"softwareTotal\"]),\r\n    userId: state.getIn([\"userMana\", \"common\", \"userId\"]),\r\n    page: state.getIn([\"admin\", \"resourceManage\", \"softwarePage\"]),\r\n    temp: state.getIn([\"admin\", \"resourceManage\", \"temp\"]),\r\n    searchFlag: state.getIn([\"admin\", \"resourceManage\", \"softwareSearchFlag\"]),\r\n    softwareDataTemp: state.getIn([\"resource\", \"resource\", \"softwareDataTemp\"])\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    handleAdminSoftwareData(args) {\r\n        dispatch(admin.fetchAdminSoftwareData(args))\r\n    },\r\n    handleDeleteSoftwareData(args) {\r\n        dispatch(admin.deleteSoftwareData(args))\r\n    },\r\n    handleSearchSoftwareData(args) {\r\n        dispatch(admin.searchSoftwareData(args));\r\n    },\r\n    handleImportSoftware(args) {\r\n        dispatch(admin.importSoftware(args));\r\n    },\r\n    handleDownloadSoftware(args) {\r\n        dispatch(resource.downloadSoftware(args));\r\n    }\r\n});\r\n\r\nconst StudySoftware = props => {\r\n    const {\r\n        temp,\r\n        softwareDataTemp,\r\n        total,\r\n        handleAdminSoftwareData,\r\n        handleDeleteSoftwareData,\r\n        handleSearchSoftwareData,\r\n        handleImportSoftware,\r\n        handleDownloadSoftware,\r\n        softwareData,\r\n        userId,\r\n        page,\r\n        searchFlag,\r\n    } = props;\r\n    const columns = [\r\n        {\r\n            key: '1',\r\n            title: '软件名称',\r\n            dataIndex: 'title',\r\n        },\r\n        {\r\n            key: '2',\r\n            title: '大小',\r\n            dataIndex: 'size',\r\n        },\r\n        {\r\n            key: '3',\r\n            title: '上传人',\r\n            dataIndex: 'userName',\r\n        },\r\n        {\r\n            key: '4',\r\n            title: '上传时间',\r\n            dataIndex: 'addTime',\r\n        },\r\n        {\r\n            key: '5',\r\n            title: '下载次数',\r\n            dataIndex: 'downloadNum'\r\n        },\r\n        {\r\n            key: '6',\r\n            title: '软件下载',\r\n            dataIndex: \"url\",\r\n            render: (text, record) => (\r\n                <a\r\n                    download={{text}.text}\r\n                    href={{text}.text}\r\n                    onClick={\r\n                        () => {\r\n                            handleDownloadSoftware({\r\n                                id: record.id,\r\n                                type: \"software\"\r\n                            });\r\n                        }\r\n                    }\r\n                >\r\n                    下载\r\n                </a>\r\n            )\r\n        }\r\n    ];\r\n    const [$selectedRowKeys, changeSelectedRowKeys] = useState([]);\r\n    const [list, setList] = useState([]);\r\n    const [current, setCurrent ] = useState(1);\r\n    const [selectedRowKeys, setSelectedRowKeys] = useState([]);\r\n    const [file, setFile ] = useState();\r\n    const [value, setValue ] = useState(\"\");\r\n    const [presentPage, setPresentPage] = useState(1);\r\n    const [deleteBtn, setDeleteBtn ] = useState(true);\r\n    let flag = \"softwareName\";\r\n    const clearCheck = () => {\r\n        setSelectedRowKeys([])\r\n    };\r\n    useEffect(() => {\r\n        handleAdminSoftwareData(\r\n            presentPage === 1 ?\r\n                {page: 1, type: \"software\"} :\r\n                (Math.ceil(total / 10) > presentPage ?\r\n                        {page: presentPage, type: \"software\"} :\r\n                        {page: presentPage - 1, type: \"software\"}\r\n                ));\r\n    }, [temp, softwareDataTemp]);\r\n    useEffect(() => {\r\n        setCurrent(page)\r\n    },[page]);\r\n    return (\r\n        <>\r\n            <div className={\"adminTop\"}>\r\n                <Upload\r\n                    style={{marginLeft: \"0.5rem\"}}\r\n                    beforeUpload={\r\n                        (file, FileList) => {\r\n                            setFile(file);\r\n                        }\r\n                    }\r\n                    customRequest={\r\n                        () => {\r\n                            handleImportSoftware({\r\n                                type: \"software\",\r\n                                userId: userId,\r\n                                file: file\r\n                            })\r\n                        }\r\n                    }\r\n                    showUploadList={false}\r\n                >\r\n                    <Button>\r\n                        <Icon type=\"upload\" /> 上传软件\r\n                    </Button>\r\n                </Upload>\r\n                <Button\r\n                    disabled={deleteBtn}\r\n                    style={{marginLeft: \"0.5rem\"}}\r\n                    icon={\"close\"}\r\n                    onClick={\r\n                        () => {\r\n                            handleDeleteSoftwareData({\r\n                                list: list,\r\n                                type: \"software\",\r\n                                userId: userId\r\n                            })\r\n                        }\r\n                    }\r\n                >\r\n                    删除软件\r\n                </Button>\r\n                <InputGroup\r\n                    compact\r\n                    style={{display: \"flex\", flexWrap: \"nowrap\", width: \"20rem\", marginLeft: \"0.5rem\"}}\r\n                >\r\n                    <Select\r\n                        defaultValue=\"softwareName\"\r\n                        onChange={\r\n                            value => flag = value\r\n                        }\r\n                    >\r\n                        <Option value=\"softwareName\">软件名</Option>\r\n                        <Option value=\"userName\">上传人</Option>\r\n                    </Select>\r\n                    <Search\r\n                        placeholder={\"请输入搜索内容\"}\r\n                        onSearch={\r\n                            value => {\r\n                                handleSearchSoftwareData({\r\n                                    page: 1,\r\n                                    value,\r\n                                    type: \"software\",\r\n                                    flag: flag\r\n                                });\r\n                                setValue(value);\r\n                            }\r\n                        }\r\n                        enterButton\r\n                        style={{width: \"16rem\"}}\r\n                    />\r\n                </InputGroup>\r\n            </div>\r\n            <Table\r\n                tableLayout={\"fixed\"}\r\n                rowKey={record => record.id}\r\n                columns={ columns }\r\n                rowSelection={{\r\n                    selectedRowKeys,\r\n                    onChange: (selectedRowKeys, selectedRows) => {\r\n                        const resourceId = selectedRows.map(el => {\r\n                            return el.id;\r\n                        });\r\n                        setList(resourceId);\r\n                        changeSelectedRowKeys(resourceId);\r\n                        setSelectedRowKeys(selectedRowKeys);\r\n                        selectedRowKeys.length > 0 ? setDeleteBtn(false) : setDeleteBtn(true);\r\n                    },\r\n                }}\r\n                dataSource={ Array.from(softwareData)}\r\n                pagination={{\r\n                    total,\r\n                    current,\r\n                    onChange: (page) => {\r\n                        !searchFlag ?\r\n                        handleAdminSoftwareData({\r\n                            page: page,\r\n                            type: \"software\"\r\n                        }):\r\n                            handleSearchSoftwareData({\r\n                                page: page,\r\n                                value,\r\n                                type: \"software\",\r\n                                flag: flag\r\n                            });\r\n                        clearCheck();\r\n                        setPresentPage(page);\r\n                    }\r\n                }}\r\n            />\r\n        </>\r\n    )\r\n};\r\n\r\nexport default connect(mapStateToState, mapDispatchToProps)(StudySoftware);\r\n"]},"metadata":{},"sourceType":"module"}
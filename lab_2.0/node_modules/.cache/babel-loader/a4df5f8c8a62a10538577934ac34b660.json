{"ast":null,"code":"import\"antd/es/upload/style/css\";import _Upload from\"antd/es/upload\";import\"antd/es/alert/style/css\";import _Alert from\"antd/es/alert\";import\"antd/es/button/style/css\";import _Button from\"antd/es/button\";import _toConsumableArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import\"antd/es/table/style/css\";import _Table from\"antd/es/table\";import\"antd/es/message/style/css\";import _message from\"antd/es/message\";import _slicedToArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import\"antd/es/modal/style/css\";import _Modal from\"antd/es/modal\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import*as course from\"../redux/actionCreators/resource\";var confirm=_Modal.confirm;//学生的\"我的任务\"\nvar StudentTasks=function StudentTasks(props){var type=props.type,userId=props.userId,courseTask=props.courseTask,myCourse=props.myCourse,checkList=props.checkList,studentUploadFlag=props.studentUploadFlag,param=props.param,handleMyCourseRes=props.handleMyCourseRes,handleFetchTaskRes=props.handleFetchTaskRes,handleStudentDeleteCourse=props.handleStudentDeleteCourse,handleStudentUploadWork=props.handleStudentUploadWork,handleStudentQuerySubmit=props.handleStudentQuerySubmit,handleStudentDeleteHomework=props.handleStudentDeleteHomework;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),uploadVisible=_useState2[0],setUploadVisible=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),checkWorkVisible=_useState4[0],setCheckWorkVisible=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),studentCourseId=_useState6[0],setStudentCourseId=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),taskId=_useState8[0],setTaskId=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),fileList=_useState10[0],setFileList=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),uploadLoading=_useState12[0],setUploadLoading=_useState12[1];useEffect(function(){handleMyCourseRes({userId:userId,type:type});},[]);useEffect(function(){setUploadVisible(false);setUploadLoading(false);},[studentUploadFlag]);//学生删除课程/任务提示框\nvar deleteConfirm=function deleteConfirm(e,action){confirm({title:\"请确认~\",content:\"删除后不可恢复，确认删除吗？\",onOk:function onOk(){action===\"deleteCourse\"?handleStudentDeleteCourse({studentCourseId:e.studentCourseId,userId:userId,teacherCourseId:e.teacherCourseId}):handleStudentDeleteHomework({userId:userId,workId:e.id});},onCancel:function onCancel(){}});};//学生上传作业\nvar studentUploadWork=function studentUploadWork(){if(fileList.length===0){_message.error(\"请选择文件！\");setUploadLoading(false);}else{handleStudentUploadWork({studentCourseId:studentCourseId,taskId:taskId,userId:userId,file:fileList});setFileList([]);}};//点击那个加号展开实验任务详情\nvar _expandedRowRender=function expandedRowRender(record){var columns=[{title:'实验任务',dataIndex:'taskName',key:'taskName'},{title:'任务附件',key:'taskFileName',render:function render(e){return/*#__PURE__*/React.createElement(\"a\",{download:\"\",href:e.url},e.taskFileName);}},{title:'发布时间',dataIndex:'addTime',key:'addTime'},{title:'作业处理',key:\"handleHomework\",align:\"center\",render:function render(e){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{color:\"#189EFF\",cursor:\"pointer\",padding:\"0 0.375rem\"},onClick:function onClick(){e.closed?_Modal.error({title:'Attention!',content:'老师已关闭该任务作业的上传'}):setUploadVisible(!uploadVisible);setStudentCourseId(record.studentCourseId);setTaskId(e.id);}},\"\\u4E0A\\u4F20\\u4F5C\\u4E1A\"),/*#__PURE__*/React.createElement(\"span\",{style:{color:\"#189EFF\",cursor:\"pointer\",padding:\"0 0.375rem\"},onClick:function onClick(){setCheckWorkVisible(!checkWorkVisible);handleStudentQuerySubmit({taskId:e.id,userId:userId});}},\"\\u67E5\\u770B\\u4F5C\\u4E1A\"));}}];var el=/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(_Table,{rowKey:function rowKey(record){return record.id;},columns:columns,dataSource:courseTask[record.teacherCourseId],pagination:false}));return el;};//主列表\nvar columns=[{title:'实验课程',dataIndex:'courseName',key:'courseName'},{title:'教学班备注',dataIndex:'remark',key:'remark'},{title:'课程编号',dataIndex:'teacherCourseId',key:'teacherCourseId'},{title:'实验教师',dataIndex:'teacherName',key:'teacherName'},{title:'选课时间',dataIndex:'addTime',key:'addTime'},{title:'课程处理',render:function render(e){return/*#__PURE__*/React.createElement(\"span\",{onClick:function onClick(){return deleteConfirm(e,\"deleteCourse\");},style:{color:\"#B30000\",cursor:\"pointer\"}},\"\\u5220\\u9664\\u4EFB\\u52A1\");}}];var uploadProps={beforeUpload:function beforeUpload(file){fileList.push(file);return false;},onRemove:function onRemove(file){var index=fileList.indexOf(file.originFileObj);fileList.splice(index,1);}};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(_Table,{rowKey:function rowKey(record){return record.teacherCourseId;},columns:columns,expandedRowRender:function expandedRowRender(record){return _expandedRowRender(record);},onExpand:function onExpand(expanded,record){expanded&&handleFetchTaskRes({teacherCourseId:record.teacherCourseId,courseTask:courseTask});},dataSource:_toConsumableArray(myCourse),pagination:false}),/*#__PURE__*/React.createElement(_Modal,{title:\"上传作业\",visible:uploadVisible,footer:/*#__PURE__*/React.createElement(_Button,{loading:uploadLoading,type:\"primary\",onClick:function onClick(){studentUploadWork();setUploadLoading(!uploadLoading);}},\"\\u4E0A\\u4F20\\u6587\\u4EF6\"),destroyOnClose:true,onCancel:function onCancel(){setUploadVisible(!uploadVisible);setUploadLoading(false);}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(_Alert,{type:\"info\",showIcon:true,message:/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",null,\"\\u53EA\\u80FD\\u4E0A\\u4F20\\u5927\\u5C0F\\u4E0D\\u8D85\\u8FC7\",/*#__PURE__*/React.createElement(\"span\",{className:\"fontC_red\"},Array.isArray(param)&&param[4].keyValue+'M'),\"\\u7684\\u6587\\u4EF6\\uFF0C\\u4E14\\u540C\\u540D\\u6587\\u4EF6\\u5C06\\u4F1A\\u8986\\u76D6\"),/*#__PURE__*/React.createElement(\"div\",null,\"\\u53EF\\u4EE5\\u62D6\\u52A8\\u9F20\\u6807\\u6216\\u8005\\u6309\\u4F4Fctrl\\u952E\\u9009\\u62E9\\u591A\\u4E2A\\u6587\\u4EF6\\u4E0A\\u4F20\"))}),/*#__PURE__*/React.createElement(\"div\",{className:\"padding_column_xs\"},/*#__PURE__*/React.createElement(_Upload,Object.assign({},uploadProps,{multiple:true}),/*#__PURE__*/React.createElement(_Button,null,\"\\u9009\\u62E9\\u6587\\u4EF6\"))))),/*#__PURE__*/React.createElement(_Modal,{title:\"查看作业\",visible:checkWorkVisible,footer:null,onCancel:function onCancel(){setCheckWorkVisible(!checkWorkVisible);}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(_Table,{rowKey:function rowKey(e){return e.id;},pagination:false,scroll:{y:\"17.5rem\"},size:\"small\",dataSource:checkList,columns:[{title:\"作业名称\",dataIndex:\"workName\",key:\"workName\",width:\"55%\"},{title:\"上传时间\",dataIndex:\"addTime\",key:\"addTime\"},{title:\"作业操作\",key:\"handleWork\",render:function render(e){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"a\",{download:\"\",href:e.url,style:{color:\"#189EFF\",cursor:\"pointer\"}},\"\\u4E0B\\u8F7D\"),/*#__PURE__*/React.createElement(\"span\",{onClick:function onClick(){return deleteConfirm(e,\"deleteHomework\");},style:{color:\"#B30000\",cursor:\"pointer\",padding:\"0 0.375rem\"}},\"\\u5220\\u9664\"));}}]}),/*#__PURE__*/React.createElement(\"div\",{className:\"fontS_12 padding_column_xxs fontC_red\"},\"\\u8BF7\\u6CE8\\u610F\\uFF01\\u4E0A\\u4F20\\u7684\\u4F5C\\u4E1A\\u5C06\\u4E8E\\u6BCF\\u5E748\\u67081\\u65E5\\u6E05\\u7A7A\\uFF0C\\u8BF7\\u53CA\\u65F6\\u5907\\u4EFD\"))));};export default connect(function(state){return{userId:state.getIn([\"userMana\",\"common\",\"userId\"]),type:state.getIn([\"userMana\",\"common\",\"type\"]),myCourse:state.getIn([\"course\",\"myCourse\"]),courseTask:state.getIn([\"course\",\"courseTask\"]),checkList:state.getIn([\"course\",\"checkList\"]),studentUploadFlag:state.getIn([\"course\",\"studentUploadFlag\"]),param:state.getIn([\"userMana\",\"common\",\"param\"])};},function(dispatch){return{handleMyCourseRes:function handleMyCourseRes(args){dispatch(course.queryMyCourse(args));},handleFetchTaskRes:function handleFetchTaskRes(teacherCourseId,courseTask){dispatch(course.fetchCourseTask(teacherCourseId,courseTask));},handleStudentDeleteCourse:function handleStudentDeleteCourse(args){dispatch(course.studentDeleteCourse(args));},handleStudentQuerySubmit:function handleStudentQuerySubmit(args){dispatch(course.studentQuerySubmit(args));},handleStudentUploadWork:function handleStudentUploadWork(args){dispatch(course.studentUploadHomework(args));},handleStudentDeleteHomework:function handleStudentDeleteHomework(args){dispatch(course.studentDeleteHomework(args));}};})(StudentTasks);","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/components/StudentTasks.js"],"names":["React","useEffect","useState","connect","course","confirm","StudentTasks","props","type","userId","courseTask","myCourse","checkList","studentUploadFlag","param","handleMyCourseRes","handleFetchTaskRes","handleStudentDeleteCourse","handleStudentUploadWork","handleStudentQuerySubmit","handleStudentDeleteHomework","uploadVisible","setUploadVisible","checkWorkVisible","setCheckWorkVisible","studentCourseId","setStudentCourseId","taskId","setTaskId","fileList","setFileList","uploadLoading","setUploadLoading","deleteConfirm","e","action","title","content","onOk","teacherCourseId","workId","id","onCancel","studentUploadWork","length","error","file","expandedRowRender","record","columns","dataIndex","key","render","url","taskFileName","align","color","cursor","padding","closed","el","uploadProps","beforeUpload","push","onRemove","index","indexOf","originFileObj","splice","expanded","Array","isArray","keyValue","y","width","state","getIn","dispatch","args","queryMyCourse","fetchCourseTask","studentDeleteCourse","studentQuerySubmit","studentUploadHomework","studentDeleteHomework"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Table, Modal, Button, Upload, message, Alert } from \"antd\";\r\nimport * as course from \"../redux/actionCreators/resource\";\r\nconst { confirm } = Modal;\r\n\r\n//学生的\"我的任务\"\r\nconst StudentTasks = props => {\r\n    const {\r\n        type, userId, courseTask, myCourse,checkList, studentUploadFlag,param,\r\n        handleMyCourseRes, handleFetchTaskRes, handleStudentDeleteCourse,\r\n        handleStudentUploadWork, handleStudentQuerySubmit, handleStudentDeleteHomework\r\n    } = props;\r\n    const [uploadVisible, setUploadVisible] = useState(false);\r\n    const [checkWorkVisible, setCheckWorkVisible] = useState(false);\r\n    const [studentCourseId, setStudentCourseId] = useState(\"\");\r\n    const [taskId, setTaskId] = useState(\"\");\r\n    const [fileList, setFileList] = useState([]);\r\n    const [uploadLoading, setUploadLoading] = useState(false);\r\n\r\n    useEffect(()=>{\r\n        handleMyCourseRes({ userId: userId, type:type })\r\n    },[]);\r\n    useEffect(()=>{\r\n        setUploadVisible(false);\r\n        setUploadLoading(false)\r\n    },[studentUploadFlag]);\r\n    //学生删除课程/任务提示框\r\n    const deleteConfirm = (e, action) => {\r\n        confirm({\r\n            title: \"请确认~\",\r\n            content: \"删除后不可恢复，确认删除吗？\",\r\n            onOk() {\r\n                action === \"deleteCourse\" ?\r\n                    handleStudentDeleteCourse({\r\n                        studentCourseId: e.studentCourseId,\r\n                        userId: userId,\r\n                        teacherCourseId: e.teacherCourseId\r\n                    })\r\n                    :\r\n                    handleStudentDeleteHomework({\r\n                        userId: userId,\r\n                        workId: e.id,\r\n                    });\r\n                },\r\n            onCancel() {}\r\n        })\r\n    };\r\n    //学生上传作业\r\n    const studentUploadWork = () => {\r\n            if (fileList.length === 0) {\r\n                message.error(\"请选择文件！\");\r\n                setUploadLoading(false)\r\n            } else {\r\n                handleStudentUploadWork({\r\n                    studentCourseId: studentCourseId,\r\n                    taskId: taskId,\r\n                    userId: userId,\r\n                    file: fileList,\r\n                });\r\n                setFileList([])\r\n            }\r\n        }\r\n    //点击那个加号展开实验任务详情\r\n    const expandedRowRender = record => {\r\n        const columns = [\r\n            { title: '实验任务', dataIndex: 'taskName', key: 'taskName' },\r\n            {\r\n                title: '任务附件',\r\n                key: 'taskFileName',\r\n                render: e => (\r\n                    <a download={\"\"} href = {e.url}>{e.taskFileName}</a>\r\n                )\r\n            },\r\n            { title: '发布时间', dataIndex: 'addTime', key: 'addTime' },\r\n            {\r\n                title: '作业处理',\r\n                key: \"handleHomework\",\r\n                align: \"center\",\r\n                render: e => (\r\n                    <div>\r\n                        <span\r\n                            style={{color: \"#189EFF\", cursor: \"pointer\", padding: \"0 0.375rem\"}}\r\n                            onClick={\r\n                                    () => {\r\n                                        e.closed ?\r\n                                            Modal.error({\r\n                                                title: 'Attention!',\r\n                                                content: '老师已关闭该任务作业的上传',\r\n                                            }):\r\n                                    setUploadVisible(!uploadVisible);\r\n                                    setStudentCourseId(record.studentCourseId);\r\n                                    setTaskId(e.id);\r\n                                }\r\n                            }\r\n\r\n                        >\r\n                            上传作业\r\n                        </span>\r\n                        <span\r\n                            style={{color: \"#189EFF\", cursor: \"pointer\", padding: \"0 0.375rem\"}}\r\n                            onClick={() => {\r\n                                setCheckWorkVisible(!checkWorkVisible);\r\n                                handleStudentQuerySubmit({\r\n                                    taskId: e.id,\r\n                                    userId: userId,\r\n                                })\r\n                            }}\r\n                        >\r\n                            查看作业\r\n                        </span>\r\n                    </div>\r\n                )\r\n            }\r\n        ];\r\n        const el = (\r\n            <>\r\n                <Table\r\n                    rowKey={(record)=>(record.id)}\r\n                    columns={columns}\r\n                    dataSource={courseTask[record.teacherCourseId]}\r\n                    pagination={false}\r\n                />\r\n            </>\r\n        );\r\n        return el;\r\n    };\r\n    //主列表\r\n    const columns = [\r\n        { title: '实验课程', dataIndex: 'courseName', key: 'courseName' },\r\n        { title: '教学班备注', dataIndex: 'remark', key: 'remark' },\r\n        { title: '课程编号', dataIndex: 'teacherCourseId', key: 'teacherCourseId' },\r\n        { title: '实验教师', dataIndex: 'teacherName', key: 'teacherName' },\r\n        { title: '选课时间', dataIndex: 'addTime', key: 'addTime' },\r\n        {\r\n            title: '课程处理',\r\n            render: (e)=>(\r\n                <span\r\n                    onClick={()=>deleteConfirm(e, \"deleteCourse\")}\r\n                    style={{color: \"#B30000\", cursor: \"pointer\"}}\r\n                >\r\n                    删除任务\r\n                </span>\r\n            )\r\n        }\r\n    ];\r\n\r\n    const uploadProps = {\r\n                beforeUpload:\r\n                    file => {\r\n                        fileList.push(file);\r\n                        return false\r\n                    },\r\n                onRemove:\r\n                    file=>{\r\n                        const index = fileList.indexOf(file.originFileObj);\r\n                        fileList.splice(index, 1);\r\n                    }\r\n            };\r\n\r\n    return (\r\n            <div>\r\n                <Table\r\n                    rowKey={record => record.teacherCourseId}\r\n                    columns={columns}\r\n                    expandedRowRender={(record)=>expandedRowRender(record)}\r\n                    onExpand = {\r\n                        (expanded,record)=>{\r\n                            expanded && handleFetchTaskRes({teacherCourseId: record.teacherCourseId, courseTask});\r\n                        }\r\n                    }\r\n                    dataSource={[...myCourse]}\r\n                    pagination={false}\r\n                />\r\n                <Modal\r\n                    title = {\"上传作业\"}\r\n                    visible = {uploadVisible}\r\n                    footer={\r\n                        <Button\r\n                            loading={uploadLoading}\r\n                            type = \"primary\"\r\n                            onClick={()=>{\r\n                                studentUploadWork();\r\n                                setUploadLoading(!uploadLoading)\r\n                            }}\r\n                        >\r\n                            上传文件\r\n                        </Button>\r\n                    }\r\n                    destroyOnClose = {true}\r\n                    onCancel={() => {\r\n                        setUploadVisible(!uploadVisible);\r\n                        setUploadLoading(false);\r\n\r\n                    }}\r\n                >\r\n                    <div>\r\n                        <Alert type='info' showIcon message={\r\n                            <div>\r\n                                <div>只能上传大小不超过<span className=\"fontC_red\">{Array.isArray(param) && param[4].keyValue + 'M'}</span>的文件，且同名文件将会覆盖</div>\r\n                                <div>可以拖动鼠标或者按住ctrl键选择多个文件上传</div>\r\n                            </div>\r\n                        } />\r\n                        <div className='padding_column_xs'>\r\n                            <Upload\r\n                            {...uploadProps}\r\n                            multiple = {true}\r\n                        >\r\n                            <Button>选择文件</Button>\r\n                        </Upload>\r\n                        </div>\r\n\r\n                    </div>\r\n                </Modal>\r\n                <Modal\r\n                    title = {\"查看作业\"}\r\n                    visible = {checkWorkVisible}\r\n                    footer={null}\r\n                    onCancel={() => {\r\n                        setCheckWorkVisible(!checkWorkVisible)\r\n                    }}\r\n                >\r\n                    <div>\r\n                        <Table\r\n                        rowKey={e=> (e.id)}\r\n                        pagination={false}\r\n                        scroll={{y: \"17.5rem\"}}\r\n                        size = \"small\"\r\n                        dataSource={checkList}\r\n                        columns={[\r\n                            {title: \"作业名称\", dataIndex: \"workName\", key: \"workName\", width: \"55%\"},\r\n                            {title: \"上传时间\", dataIndex: \"addTime\", key: \"addTime\",},\r\n                            {\r\n                                title: \"作业操作\",\r\n                                key: \"handleWork\",\r\n                                render: (e) => (\r\n                                    <>\r\n                                        <a\r\n                                            download={\"\"}\r\n                                            href={e.url}\r\n                                            style={{color: \"#189EFF\", cursor: \"pointer\"}}\r\n                                        >\r\n                                            下载\r\n                                        </a>\r\n                                        <span\r\n                                            onClick={() => deleteConfirm(e, \"deleteHomework\")}\r\n                                            style={{color: \"#B30000\", cursor: \"pointer\", padding: \"0 0.375rem\"}}\r\n                                        >\r\n                                            删除\r\n                                        </span>\r\n                                    </>\r\n                                )\r\n                            },\r\n                        ]}\r\n                    />\r\n                        <div className=\"fontS_12 padding_column_xxs fontC_red\" >请注意！上传的作业将于每年8月1日清空，请及时备份</div>\r\n                    </div>\r\n\r\n                </Modal>\r\n            </div>\r\n    )\r\n};\r\nexport default connect(\r\n    state => ({\r\n        userId: state.getIn([\"userMana\", \"common\", \"userId\"]),\r\n        type: state.getIn([\"userMana\", \"common\", \"type\"]),\r\n        myCourse: state.getIn([\"course\", \"myCourse\"]),\r\n        courseTask: state.getIn([\"course\", \"courseTask\"]),\r\n        checkList: state.getIn([\"course\", \"checkList\"]),\r\n        studentUploadFlag: state.getIn([\"course\", \"studentUploadFlag\"]),\r\n        param: state.getIn([\"userMana\", \"common\", \"param\"])\r\n    }),\r\n    dispatch => ({\r\n        handleMyCourseRes(args){\r\n            dispatch(course.queryMyCourse(args));\r\n        },\r\n        handleFetchTaskRes(teacherCourseId,courseTask){\r\n            dispatch(course.fetchCourseTask(teacherCourseId, courseTask));\r\n        },\r\n        handleStudentDeleteCourse(args){\r\n            dispatch(course.studentDeleteCourse(args))\r\n        },\r\n        handleStudentQuerySubmit(args){\r\n            dispatch(course.studentQuerySubmit(args))\r\n        },\r\n        handleStudentUploadWork(args){\r\n            dispatch(course.studentUploadHomework(args))\r\n        },\r\n        handleStudentDeleteHomework(args){\r\n            dispatch(course.studentDeleteHomework(args))\r\n        }\r\n\r\n    })\r\n)(StudentTasks);\r\n"]},"metadata":{},"sourceType":"module"}
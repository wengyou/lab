{"ast":null,"code":"import _toConsumableArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";/* eslint-disable */import{saveAs}from'file-saver';import XLSX from'xlsx';function generateArray(table){var out=[];var rows=table.querySelectorAll('tr');var ranges=[];for(var R=0;R<rows.length;++R){var outRow=[];var row=rows[R];var columns=row.querySelectorAll('td');for(var C=0;C<columns.length;++C){var cell=columns[C];var colspan=cell.getAttribute('colspan');var rowspan=cell.getAttribute('rowspan');var cellValue=cell.innerText;if(cellValue!==\"\"&&cellValue==+cellValue)cellValue=+cellValue;//Skip ranges\nranges.forEach(function(range){if(R>=range.s.r&&R<=range.e.r&&outRow.length>=range.s.c&&outRow.length<=range.e.c){for(var i=0;i<=range.e.c-range.s.c;++i){outRow.push(null);}}});//Handle Row Span\nif(rowspan||colspan){rowspan=rowspan||1;colspan=colspan||1;ranges.push({s:{r:R,c:outRow.length},e:{r:R+rowspan-1,c:outRow.length+colspan-1}});};//Handle Value\noutRow.push(cellValue!==\"\"?cellValue:null);//Handle Colspan\nif(colspan)for(var k=0;k<colspan-1;++k){outRow.push(null);}}out.push(outRow);}return[out,ranges];};function datenum(v,date1904){if(date1904)v+=1462;var epoch=Date.parse(v);return(epoch-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000);}function sheet_from_array_of_arrays(data,opts){var ws={};var range={s:{c:10000000,r:10000000},e:{c:0,r:0}};for(var R=0;R!=data.length;++R){for(var C=0;C!=data[R].length;++C){if(range.s.r>R)range.s.r=R;if(range.s.c>C)range.s.c=C;if(range.e.r<R)range.e.r=R;if(range.e.c<C)range.e.c=C;var cell={v:data[R][C]};if(cell.v==null)continue;var cell_ref=XLSX.utils.encode_cell({c:C,r:R});if(typeof cell.v==='number')cell.t='n';else if(typeof cell.v==='boolean')cell.t='b';else if(cell.v instanceof Date){cell.t='n';cell.z=XLSX.SSF._table[14];cell.v=datenum(cell.v);}else cell.t='s';ws[cell_ref]=cell;}}if(range.s.c<10000000)ws['!ref']=XLSX.utils.encode_range(range);return ws;}function Workbook(){if(!(this instanceof Workbook))return new Workbook();this.SheetNames=[];this.Sheets={};}function s2ab(s){var buf=new ArrayBuffer(s.length);var view=new Uint8Array(buf);for(var i=0;i!=s.length;++i){view[i]=s.charCodeAt(i)&0xFF;}return buf;}export function export_table_to_excel(id){var theTable=document.getElementById(id);var oo=generateArray(theTable);var ranges=oo[1];/* original data */var data=oo[0];var ws_name=\"SheetJS\";var wb=new Workbook(),ws=sheet_from_array_of_arrays(data);/* add ranges to worksheet */ // ws['!cols'] = ['apple', 'banan'];\nws['!merges']=ranges;/* add worksheet to workbook */wb.SheetNames.push(ws_name);wb.Sheets[ws_name]=ws;var wbout=XLSX.write(wb,{bookType:'xlsx',bookSST:false,type:'binary'});saveAs(new Blob([s2ab(wbout)],{type:\"application/octet-stream\"}),\"test.xlsx\");}export function export_json_to_excel(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$multiHeader=_ref.multiHeader,multiHeader=_ref$multiHeader===void 0?[]:_ref$multiHeader,header=_ref.header,data=_ref.data,filename=_ref.filename,_ref$merges=_ref.merges,merges=_ref$merges===void 0?[]:_ref$merges,_ref$autoWidth=_ref.autoWidth,autoWidth=_ref$autoWidth===void 0?true:_ref$autoWidth,_ref$bookType=_ref.bookType,bookType=_ref$bookType===void 0?'xlsx':_ref$bookType;/* original data */filename=filename||'excel-list';data=_toConsumableArray(data);data.unshift(header);for(var i=multiHeader.length-1;i>-1;i--){data.unshift(multiHeader[i]);}var ws_name=\"SheetJS\";var wb=new Workbook(),ws=sheet_from_array_of_arrays(data);if(merges.length>0){if(!ws['!merges'])ws['!merges']=[];merges.forEach(function(item){ws['!merges'].push(XLSX.utils.decode_range(item));});}if(autoWidth){/*设置worksheet每列的最大宽度*/var colWidth=data.map(function(row){return row.map(function(val){/*先判断是否为null/undefined*/if(val==null){return{'wch':10};}/*再判断是否为中文*/else if(val.toString().charCodeAt(0)>255){return{'wch':val.toString().length*2};}else{return{'wch':val.toString().length};}});});/*以第一行为初始值*/var result=colWidth[0];for(var _i=1;_i<colWidth.length;_i++){for(var j=0;j<colWidth[_i].length;j++){if(result[j]['wch']<colWidth[_i][j]['wch']){result[j]['wch']=colWidth[_i][j]['wch'];}}}ws['!cols']=result;}/* add worksheet to workbook */wb.SheetNames.push(ws_name);wb.Sheets[ws_name]=ws;var wbout=XLSX.write(wb,{bookType:bookType,bookSST:false,type:'binary'});saveAs(new Blob([s2ab(wbout)],{type:\"application/octet-stream\"}),\"\".concat(filename,\".\").concat(bookType));}function formatJson(jsonSource,jsonFillter){return jsonSource.map(function(v){return jsonFillter.map(function(j){return v[j];});});}export function export_json_to_excel2(th,jsonSource,jsonFillter,name){var data=formatJson(jsonSource,jsonFillter);export_json_to_excel({header:th,data:data,filename:name});}","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/lib/Export2Excel.js"],"names":["saveAs","XLSX","generateArray","table","out","rows","querySelectorAll","ranges","R","length","outRow","row","columns","C","cell","colspan","getAttribute","rowspan","cellValue","innerText","forEach","range","s","r","e","c","i","push","k","datenum","v","date1904","epoch","Date","parse","UTC","sheet_from_array_of_arrays","data","opts","ws","cell_ref","utils","encode_cell","t","z","SSF","_table","encode_range","Workbook","SheetNames","Sheets","s2ab","buf","ArrayBuffer","view","Uint8Array","charCodeAt","export_table_to_excel","id","theTable","document","getElementById","oo","ws_name","wb","wbout","write","bookType","bookSST","type","Blob","export_json_to_excel","multiHeader","header","filename","merges","autoWidth","unshift","item","decode_range","colWidth","map","val","toString","result","j","formatJson","jsonSource","jsonFillter","export_json_to_excel2","th","name"],"mappings":"8JAAA,oBACA,OAASA,MAAT,KAAuB,YAAvB,CACA,MAAOC,CAAAA,IAAP,KAAiB,MAAjB,CAEA,QAASC,CAAAA,aAAT,CAAuBC,KAAvB,CAA8B,CAC5B,GAAIC,CAAAA,GAAG,CAAG,EAAV,CACA,GAAIC,CAAAA,IAAI,CAAGF,KAAK,CAACG,gBAAN,CAAuB,IAAvB,CAAX,CACA,GAAIC,CAAAA,MAAM,CAAG,EAAb,CACA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGH,IAAI,CAACI,MAAzB,CAAiC,EAAED,CAAnC,CAAsC,CACpC,GAAIE,CAAAA,MAAM,CAAG,EAAb,CACA,GAAIC,CAAAA,GAAG,CAAGN,IAAI,CAACG,CAAD,CAAd,CACA,GAAII,CAAAA,OAAO,CAAGD,GAAG,CAACL,gBAAJ,CAAqB,IAArB,CAAd,CACA,IAAK,GAAIO,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGD,OAAO,CAACH,MAA5B,CAAoC,EAAEI,CAAtC,CAAyC,CACvC,GAAIC,CAAAA,IAAI,CAAGF,OAAO,CAACC,CAAD,CAAlB,CACA,GAAIE,CAAAA,OAAO,CAAGD,IAAI,CAACE,YAAL,CAAkB,SAAlB,CAAd,CACA,GAAIC,CAAAA,OAAO,CAAGH,IAAI,CAACE,YAAL,CAAkB,SAAlB,CAAd,CACA,GAAIE,CAAAA,SAAS,CAAGJ,IAAI,CAACK,SAArB,CACA,GAAID,SAAS,GAAK,EAAd,EAAoBA,SAAS,EAAI,CAACA,SAAtC,CAAiDA,SAAS,CAAG,CAACA,SAAb,CAEjD;AACAX,MAAM,CAACa,OAAP,CAAe,SAAUC,KAAV,CAAiB,CAC9B,GAAIb,CAAC,EAAIa,KAAK,CAACC,CAAN,CAAQC,CAAb,EAAkBf,CAAC,EAAIa,KAAK,CAACG,CAAN,CAAQD,CAA/B,EAAoCb,MAAM,CAACD,MAAP,EAAiBY,KAAK,CAACC,CAAN,CAAQG,CAA7D,EAAkEf,MAAM,CAACD,MAAP,EAAiBY,KAAK,CAACG,CAAN,CAAQC,CAA/F,CAAkG,CAChG,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,EAAIL,KAAK,CAACG,CAAN,CAAQC,CAAR,CAAYJ,KAAK,CAACC,CAAN,CAAQG,CAAzC,CAA4C,EAAEC,CAA9C,EAAiDhB,MAAM,CAACiB,IAAP,CAAY,IAAZ,EAAjD,CACD,CACF,CAJD,EAMA;AACA,GAAIV,OAAO,EAAIF,OAAf,CAAwB,CACtBE,OAAO,CAAGA,OAAO,EAAI,CAArB,CACAF,OAAO,CAAGA,OAAO,EAAI,CAArB,CACAR,MAAM,CAACoB,IAAP,CAAY,CACVL,CAAC,CAAE,CACDC,CAAC,CAAEf,CADF,CAEDiB,CAAC,CAAEf,MAAM,CAACD,MAFT,CADO,CAKVe,CAAC,CAAE,CACDD,CAAC,CAAEf,CAAC,CAAGS,OAAJ,CAAc,CADhB,CAEDQ,CAAC,CAAEf,MAAM,CAACD,MAAP,CAAgBM,OAAhB,CAA0B,CAF5B,CALO,CAAZ,EAUD,EAED;AACAL,MAAM,CAACiB,IAAP,CAAYT,SAAS,GAAK,EAAd,CAAmBA,SAAnB,CAA+B,IAA3C,EAEA;AACA,GAAIH,OAAJ,CACE,IAAK,GAAIa,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGb,OAAO,CAAG,CAA9B,CAAiC,EAAEa,CAAnC,EAAsClB,MAAM,CAACiB,IAAP,CAAY,IAAZ,EAAtC,CACH,CACDvB,GAAG,CAACuB,IAAJ,CAASjB,MAAT,EACD,CACD,MAAO,CAACN,GAAD,CAAMG,MAAN,CAAP,CACD,EAED,QAASsB,CAAAA,OAAT,CAAiBC,CAAjB,CAAoBC,QAApB,CAA8B,CAC5B,GAAIA,QAAJ,CAAcD,CAAC,EAAI,IAAL,CACd,GAAIE,CAAAA,KAAK,CAAGC,IAAI,CAACC,KAAL,CAAWJ,CAAX,CAAZ,CACA,MAAO,CAACE,KAAK,CAAG,GAAIC,CAAAA,IAAJ,CAASA,IAAI,CAACE,GAAL,CAAS,IAAT,CAAe,EAAf,CAAmB,EAAnB,CAAT,CAAT,GAA8C,GAAK,EAAL,CAAU,EAAV,CAAe,IAA7D,CAAP,CACD,CAED,QAASC,CAAAA,0BAAT,CAAoCC,IAApC,CAA0CC,IAA1C,CAAgD,CAC9C,GAAIC,CAAAA,EAAE,CAAG,EAAT,CACA,GAAIlB,CAAAA,KAAK,CAAG,CACVC,CAAC,CAAE,CACDG,CAAC,CAAE,QADF,CAEDF,CAAC,CAAE,QAFF,CADO,CAKVC,CAAC,CAAE,CACDC,CAAC,CAAE,CADF,CAEDF,CAAC,CAAE,CAFF,CALO,CAAZ,CAUA,IAAK,GAAIf,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,EAAI6B,IAAI,CAAC5B,MAA1B,CAAkC,EAAED,CAApC,CAAuC,CACrC,IAAK,GAAIK,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,EAAIwB,IAAI,CAAC7B,CAAD,CAAJ,CAAQC,MAA7B,CAAqC,EAAEI,CAAvC,CAA0C,CACxC,GAAIQ,KAAK,CAACC,CAAN,CAAQC,CAAR,CAAYf,CAAhB,CAAmBa,KAAK,CAACC,CAAN,CAAQC,CAAR,CAAYf,CAAZ,CACnB,GAAIa,KAAK,CAACC,CAAN,CAAQG,CAAR,CAAYZ,CAAhB,CAAmBQ,KAAK,CAACC,CAAN,CAAQG,CAAR,CAAYZ,CAAZ,CACnB,GAAIQ,KAAK,CAACG,CAAN,CAAQD,CAAR,CAAYf,CAAhB,CAAmBa,KAAK,CAACG,CAAN,CAAQD,CAAR,CAAYf,CAAZ,CACnB,GAAIa,KAAK,CAACG,CAAN,CAAQC,CAAR,CAAYZ,CAAhB,CAAmBQ,KAAK,CAACG,CAAN,CAAQC,CAAR,CAAYZ,CAAZ,CACnB,GAAIC,CAAAA,IAAI,CAAG,CACTgB,CAAC,CAAEO,IAAI,CAAC7B,CAAD,CAAJ,CAAQK,CAAR,CADM,CAAX,CAGA,GAAIC,IAAI,CAACgB,CAAL,EAAU,IAAd,CAAoB,SACpB,GAAIU,CAAAA,QAAQ,CAAGvC,IAAI,CAACwC,KAAL,CAAWC,WAAX,CAAuB,CACpCjB,CAAC,CAAEZ,CADiC,CAEpCU,CAAC,CAAEf,CAFiC,CAAvB,CAAf,CAKA,GAAI,MAAOM,CAAAA,IAAI,CAACgB,CAAZ,GAAkB,QAAtB,CAAgChB,IAAI,CAAC6B,CAAL,CAAS,GAAT,CAAhC,IACK,IAAI,MAAO7B,CAAAA,IAAI,CAACgB,CAAZ,GAAkB,SAAtB,CAAiChB,IAAI,CAAC6B,CAAL,CAAS,GAAT,CAAjC,IACA,IAAI7B,IAAI,CAACgB,CAAL,WAAkBG,CAAAA,IAAtB,CAA4B,CAC/BnB,IAAI,CAAC6B,CAAL,CAAS,GAAT,CACA7B,IAAI,CAAC8B,CAAL,CAAS3C,IAAI,CAAC4C,GAAL,CAASC,MAAT,CAAgB,EAAhB,CAAT,CACAhC,IAAI,CAACgB,CAAL,CAASD,OAAO,CAACf,IAAI,CAACgB,CAAN,CAAhB,CACD,CAJI,IAIEhB,CAAAA,IAAI,CAAC6B,CAAL,CAAS,GAAT,CAEPJ,EAAE,CAACC,QAAD,CAAF,CAAe1B,IAAf,CACD,CACF,CACD,GAAIO,KAAK,CAACC,CAAN,CAAQG,CAAR,CAAY,QAAhB,CAA0Bc,EAAE,CAAC,MAAD,CAAF,CAAatC,IAAI,CAACwC,KAAL,CAAWM,YAAX,CAAwB1B,KAAxB,CAAb,CAC1B,MAAOkB,CAAAA,EAAP,CACD,CAED,QAASS,CAAAA,QAAT,EAAoB,CAClB,GAAI,EAAE,eAAgBA,CAAAA,QAAlB,CAAJ,CAAiC,MAAO,IAAIA,CAAAA,QAAJ,EAAP,CACjC,KAAKC,UAAL,CAAkB,EAAlB,CACA,KAAKC,MAAL,CAAc,EAAd,CACD,CAED,QAASC,CAAAA,IAAT,CAAc7B,CAAd,CAAiB,CACf,GAAI8B,CAAAA,GAAG,CAAG,GAAIC,CAAAA,WAAJ,CAAgB/B,CAAC,CAACb,MAAlB,CAAV,CACA,GAAI6C,CAAAA,IAAI,CAAG,GAAIC,CAAAA,UAAJ,CAAeH,GAAf,CAAX,CACA,IAAK,GAAI1B,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,EAAIJ,CAAC,CAACb,MAAvB,CAA+B,EAAEiB,CAAjC,EAAoC4B,IAAI,CAAC5B,CAAD,CAAJ,CAAUJ,CAAC,CAACkC,UAAF,CAAa9B,CAAb,EAAkB,IAA5B,CAApC,CACA,MAAO0B,CAAAA,GAAP,CACD,CAED,MAAO,SAASK,CAAAA,qBAAT,CAA+BC,EAA/B,CAAmC,CACxC,GAAIC,CAAAA,QAAQ,CAAGC,QAAQ,CAACC,cAAT,CAAwBH,EAAxB,CAAf,CACA,GAAII,CAAAA,EAAE,CAAG5D,aAAa,CAACyD,QAAD,CAAtB,CACA,GAAIpD,CAAAA,MAAM,CAAGuD,EAAE,CAAC,CAAD,CAAf,CAEA,mBACA,GAAIzB,CAAAA,IAAI,CAAGyB,EAAE,CAAC,CAAD,CAAb,CACA,GAAIC,CAAAA,OAAO,CAAG,SAAd,CAEA,GAAIC,CAAAA,EAAE,CAAG,GAAIhB,CAAAA,QAAJ,EAAT,CACET,EAAE,CAAGH,0BAA0B,CAACC,IAAD,CADjC,CAGA,6BAZwC,CAaxC;AACAE,EAAE,CAAC,SAAD,CAAF,CAAgBhC,MAAhB,CAEA,+BACAyD,EAAE,CAACf,UAAH,CAActB,IAAd,CAAmBoC,OAAnB,EACAC,EAAE,CAACd,MAAH,CAAUa,OAAV,EAAqBxB,EAArB,CAEA,GAAI0B,CAAAA,KAAK,CAAGhE,IAAI,CAACiE,KAAL,CAAWF,EAAX,CAAe,CACzBG,QAAQ,CAAE,MADe,CAEzBC,OAAO,CAAE,KAFgB,CAGzBC,IAAI,CAAE,QAHmB,CAAf,CAAZ,CAMArE,MAAM,CAAC,GAAIsE,CAAAA,IAAJ,CAAS,CAACnB,IAAI,CAACc,KAAD,CAAL,CAAT,CAAwB,CAC7BI,IAAI,CAAE,0BADuB,CAAxB,CAAD,CAEF,WAFE,CAAN,CAGD,CAED,MAAO,SAASE,CAAAA,oBAAT,EAQC,oEAAJ,EAAI,uBAPNC,WAOM,CAPNA,WAOM,2BAPQ,EAOR,kBANNC,MAMM,MANNA,MAMM,CALNpC,IAKM,MALNA,IAKM,CAJNqC,QAIM,MAJNA,QAIM,kBAHNC,MAGM,CAHNA,MAGM,sBAHG,EAGH,iCAFNC,SAEM,CAFNA,SAEM,yBAFM,IAEN,mCADNT,QACM,CADNA,QACM,wBADK,MACL,eACN,mBACAO,QAAQ,CAAGA,QAAQ,EAAI,YAAvB,CACArC,IAAI,oBAAOA,IAAP,CAAJ,CACAA,IAAI,CAACwC,OAAL,CAAaJ,MAAb,EAEA,IAAK,GAAI/C,CAAAA,CAAC,CAAG8C,WAAW,CAAC/D,MAAZ,CAAqB,CAAlC,CAAqCiB,CAAC,CAAG,CAAC,CAA1C,CAA6CA,CAAC,EAA9C,CAAkD,CAChDW,IAAI,CAACwC,OAAL,CAAaL,WAAW,CAAC9C,CAAD,CAAxB,EACD,CAED,GAAIqC,CAAAA,OAAO,CAAG,SAAd,CACA,GAAIC,CAAAA,EAAE,CAAG,GAAIhB,CAAAA,QAAJ,EAAT,CACET,EAAE,CAAGH,0BAA0B,CAACC,IAAD,CADjC,CAGA,GAAIsC,MAAM,CAAClE,MAAP,CAAgB,CAApB,CAAuB,CACrB,GAAI,CAAC8B,EAAE,CAAC,SAAD,CAAP,CAAoBA,EAAE,CAAC,SAAD,CAAF,CAAgB,EAAhB,CACpBoC,MAAM,CAACvD,OAAP,CAAe,SAAA0D,IAAI,CAAI,CACrBvC,EAAE,CAAC,SAAD,CAAF,CAAcZ,IAAd,CAAmB1B,IAAI,CAACwC,KAAL,CAAWsC,YAAX,CAAwBD,IAAxB,CAAnB,EACD,CAFD,EAGD,CAED,GAAIF,SAAJ,CAAe,CACb,sBACA,GAAMI,CAAAA,QAAQ,CAAG3C,IAAI,CAAC4C,GAAL,CAAS,SAAAtE,GAAG,QAAIA,CAAAA,GAAG,CAACsE,GAAJ,CAAQ,SAAAC,GAAG,CAAI,CAC9C,wBACA,GAAIA,GAAG,EAAI,IAAX,CAAiB,CACf,MAAO,CACL,MAAO,EADF,CAAP,CAGD,CACD,YALA,IAMK,IAAIA,GAAG,CAACC,QAAJ,GAAe3B,UAAf,CAA0B,CAA1B,EAA+B,GAAnC,CAAwC,CAC3C,MAAO,CACL,MAAO0B,GAAG,CAACC,QAAJ,GAAe1E,MAAf,CAAwB,CAD1B,CAAP,CAGD,CAJI,IAIE,CACL,MAAO,CACL,MAAOyE,GAAG,CAACC,QAAJ,GAAe1E,MADjB,CAAP,CAGD,CACF,CAjBgC,CAAJ,EAAZ,CAAjB,CAkBA,YACA,GAAI2E,CAAAA,MAAM,CAAGJ,QAAQ,CAAC,CAAD,CAArB,CACA,IAAK,GAAItD,CAAAA,EAAC,CAAG,CAAb,CAAgBA,EAAC,CAAGsD,QAAQ,CAACvE,MAA7B,CAAqCiB,EAAC,EAAtC,CAA0C,CACxC,IAAK,GAAI2D,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGL,QAAQ,CAACtD,EAAD,CAAR,CAAYjB,MAAhC,CAAwC4E,CAAC,EAAzC,CAA6C,CAC3C,GAAID,MAAM,CAACC,CAAD,CAAN,CAAU,KAAV,EAAmBL,QAAQ,CAACtD,EAAD,CAAR,CAAY2D,CAAZ,EAAe,KAAf,CAAvB,CAA8C,CAC5CD,MAAM,CAACC,CAAD,CAAN,CAAU,KAAV,EAAmBL,QAAQ,CAACtD,EAAD,CAAR,CAAY2D,CAAZ,EAAe,KAAf,CAAnB,CACD,CACF,CACF,CACD9C,EAAE,CAAC,OAAD,CAAF,CAAc6C,MAAd,CACD,CAED,+BACApB,EAAE,CAACf,UAAH,CAActB,IAAd,CAAmBoC,OAAnB,EACAC,EAAE,CAACd,MAAH,CAAUa,OAAV,EAAqBxB,EAArB,CAEA,GAAI0B,CAAAA,KAAK,CAAGhE,IAAI,CAACiE,KAAL,CAAWF,EAAX,CAAe,CACzBG,QAAQ,CAAEA,QADe,CAEzBC,OAAO,CAAE,KAFgB,CAGzBC,IAAI,CAAE,QAHmB,CAAf,CAAZ,CAKArE,MAAM,CAAC,GAAIsE,CAAAA,IAAJ,CAAS,CAACnB,IAAI,CAACc,KAAD,CAAL,CAAT,CAAwB,CAC7BI,IAAI,CAAE,0BADuB,CAAxB,CAAD,WAECK,QAFD,aAEaP,QAFb,EAAN,CAGD,CAED,QAASmB,CAAAA,UAAT,CAAoBC,UAApB,CAAgCC,WAAhC,CAA6C,CAC3C,MAAOD,CAAAA,UAAU,CAACN,GAAX,CAAe,SAAAnD,CAAC,QAAI0D,CAAAA,WAAW,CAACP,GAAZ,CAAgB,SAAAI,CAAC,CAAI,CAC5C,MAAOvD,CAAAA,CAAC,CAACuD,CAAD,CAAR,CACH,CAF0B,CAAJ,EAAhB,CAAP,CAGD,CAED,MAAO,SAASI,CAAAA,qBAAT,CAA+BC,EAA/B,CAAmCH,UAAnC,CAA+CC,WAA/C,CAA4DG,IAA5D,CAAkE,CACvE,GAAMtD,CAAAA,IAAI,CAAGiD,UAAU,CAACC,UAAD,CAAaC,WAAb,CAAvB,CACAjB,oBAAoB,CAAC,CAACE,MAAM,CAAEiB,EAAT,CAAarD,IAAI,CAAJA,IAAb,CAAmBqC,QAAQ,CAAEiB,IAA7B,CAAD,CAApB,CACD","sourcesContent":["/* eslint-disable */\nimport { saveAs } from 'file-saver'\nimport XLSX from 'xlsx'\n\nfunction generateArray(table) {\n  var out = [];\n  var rows = table.querySelectorAll('tr');\n  var ranges = [];\n  for (var R = 0; R < rows.length; ++R) {\n    var outRow = [];\n    var row = rows[R];\n    var columns = row.querySelectorAll('td');\n    for (var C = 0; C < columns.length; ++C) {\n      var cell = columns[C];\n      var colspan = cell.getAttribute('colspan');\n      var rowspan = cell.getAttribute('rowspan');\n      var cellValue = cell.innerText;\n      if (cellValue !== \"\" && cellValue == +cellValue) cellValue = +cellValue;\n\n      //Skip ranges\n      ranges.forEach(function (range) {\n        if (R >= range.s.r && R <= range.e.r && outRow.length >= range.s.c && outRow.length <= range.e.c) {\n          for (var i = 0; i <= range.e.c - range.s.c; ++i) outRow.push(null);\n        }\n      });\n\n      //Handle Row Span\n      if (rowspan || colspan) {\n        rowspan = rowspan || 1;\n        colspan = colspan || 1;\n        ranges.push({\n          s: {\n            r: R,\n            c: outRow.length\n          },\n          e: {\n            r: R + rowspan - 1,\n            c: outRow.length + colspan - 1\n          }\n        });\n      };\n\n      //Handle Value\n      outRow.push(cellValue !== \"\" ? cellValue : null);\n\n      //Handle Colspan\n      if (colspan)\n        for (var k = 0; k < colspan - 1; ++k) outRow.push(null);\n    }\n    out.push(outRow);\n  }\n  return [out, ranges];\n};\n\nfunction datenum(v, date1904) {\n  if (date1904) v += 1462;\n  var epoch = Date.parse(v);\n  return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n}\n\nfunction sheet_from_array_of_arrays(data, opts) {\n  var ws = {};\n  var range = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  for (var R = 0; R != data.length; ++R) {\n    for (var C = 0; C != data[R].length; ++C) {\n      if (range.s.r > R) range.s.r = R;\n      if (range.s.c > C) range.s.c = C;\n      if (range.e.r < R) range.e.r = R;\n      if (range.e.c < C) range.e.c = C;\n      var cell = {\n        v: data[R][C]\n      };\n      if (cell.v == null) continue;\n      var cell_ref = XLSX.utils.encode_cell({\n        c: C,\n        r: R\n      });\n\n      if (typeof cell.v === 'number') cell.t = 'n';\n      else if (typeof cell.v === 'boolean') cell.t = 'b';\n      else if (cell.v instanceof Date) {\n        cell.t = 'n';\n        cell.z = XLSX.SSF._table[14];\n        cell.v = datenum(cell.v);\n      } else cell.t = 's';\n\n      ws[cell_ref] = cell;\n    }\n  }\n  if (range.s.c < 10000000) ws['!ref'] = XLSX.utils.encode_range(range);\n  return ws;\n}\n\nfunction Workbook() {\n  if (!(this instanceof Workbook)) return new Workbook();\n  this.SheetNames = [];\n  this.Sheets = {};\n}\n\nfunction s2ab(s) {\n  var buf = new ArrayBuffer(s.length);\n  var view = new Uint8Array(buf);\n  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n  return buf;\n}\n\nexport function export_table_to_excel(id) {\n  var theTable = document.getElementById(id);\n  var oo = generateArray(theTable);\n  var ranges = oo[1];\n\n  /* original data */\n  var data = oo[0];\n  var ws_name = \"SheetJS\";\n\n  var wb = new Workbook(),\n    ws = sheet_from_array_of_arrays(data);\n\n  /* add ranges to worksheet */\n  // ws['!cols'] = ['apple', 'banan'];\n  ws['!merges'] = ranges;\n\n  /* add worksheet to workbook */\n  wb.SheetNames.push(ws_name);\n  wb.Sheets[ws_name] = ws;\n\n  var wbout = XLSX.write(wb, {\n    bookType: 'xlsx',\n    bookSST: false,\n    type: 'binary'\n  });\n\n  saveAs(new Blob([s2ab(wbout)], {\n    type: \"application/octet-stream\"\n  }), \"test.xlsx\")\n}\n\nexport function export_json_to_excel({\n  multiHeader = [],\n  header,\n  data,\n  filename,\n  merges = [],\n  autoWidth = true,\n  bookType = 'xlsx'\n} = {}) {\n  /* original data */\n  filename = filename || 'excel-list'\n  data = [...data]\n  data.unshift(header);\n\n  for (let i = multiHeader.length - 1; i > -1; i--) {\n    data.unshift(multiHeader[i])\n  }\n\n  var ws_name = \"SheetJS\";\n  var wb = new Workbook(),\n    ws = sheet_from_array_of_arrays(data);\n\n  if (merges.length > 0) {\n    if (!ws['!merges']) ws['!merges'] = [];\n    merges.forEach(item => {\n      ws['!merges'].push(XLSX.utils.decode_range(item))\n    })\n  }\n\n  if (autoWidth) {\n    /*设置worksheet每列的最大宽度*/\n    const colWidth = data.map(row => row.map(val => {\n      /*先判断是否为null/undefined*/\n      if (val == null) {\n        return {\n          'wch': 10\n        };\n      }\n      /*再判断是否为中文*/\n      else if (val.toString().charCodeAt(0) > 255) {\n        return {\n          'wch': val.toString().length * 2\n        };\n      } else {\n        return {\n          'wch': val.toString().length\n        };\n      }\n    }))\n    /*以第一行为初始值*/\n    let result = colWidth[0];\n    for (let i = 1; i < colWidth.length; i++) {\n      for (let j = 0; j < colWidth[i].length; j++) {\n        if (result[j]['wch'] < colWidth[i][j]['wch']) {\n          result[j]['wch'] = colWidth[i][j]['wch'];\n        }\n      }\n    }\n    ws['!cols'] = result;\n  }\n\n  /* add worksheet to workbook */\n  wb.SheetNames.push(ws_name);\n  wb.Sheets[ws_name] = ws;\n\n  var wbout = XLSX.write(wb, {\n    bookType: bookType,\n    bookSST: false,\n    type: 'binary'\n  });\n  saveAs(new Blob([s2ab(wbout)], {\n    type: \"application/octet-stream\"\n  }), `${filename}.${bookType}`);\n}\n\nfunction formatJson(jsonSource, jsonFillter) {\n  return jsonSource.map(v => jsonFillter.map(j => {\n      return v[j]\n  }))\n}\n\nexport function export_json_to_excel2(th, jsonSource, jsonFillter, name) {\n  const data = formatJson(jsonSource, jsonFillter)\n  export_json_to_excel({header: th, data, filename: name})\n}"]},"metadata":{},"sourceType":"module"}
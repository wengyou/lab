{"ast":null,"code":"import\"antd/es/table/style/css\";import _Table from\"antd/es/table\";import\"antd/es/button/style/css\";import _Button from\"antd/es/button\";import\"antd/es/icon/style/css\";import _Icon from\"antd/es/icon\";import\"antd/es/modal/style/css\";import _Modal from\"antd/es/modal\";import _slicedToArray from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import\"antd/es/input/style/css\";import _Input from\"antd/es/input\";import\"antd/es/select/style/css\";import _Select from\"antd/es/select\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import*as course from\"../../redux/actionCreators/resource\";import*as admin from\"../../redux/actionCreators/admin\";var Option=_Select.Option;var Search=_Input.Search;var Reg=/^[\\s\\S]*.*[^\\s][\\s\\S]*$/;var TeacherCourse=function TeacherCourse(props){var taskTotal=props.taskTotal,teacherCourseFlag=props.teacherCourseFlag,userId=props.userId,courseResource=props.courseResource,handleFetchCourseRes=props.handleFetchCourseRes,handleDeleteTeacherCourse=props.handleDeleteTeacherCourse,handleSearchCourse=props.handleSearchCourse;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),selected=_useState2[0],setSelected=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),selectedRow=_useState4[0],setSelectedRow=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),deleteBtn=_useState6[0],setDeleteBtn=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),presentPage=_useState8[0],setPresentPage=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),arr=_useState10[0],setArr=_useState10[1];var _useState11=useState(\"courseName\"),_useState12=_slicedToArray(_useState11,2),searchFlag=_useState12[0],setSearchFlag=_useState12[1];var confirm=_Modal.confirm;useEffect(function(){handleFetchCourseRes(presentPage===1?{page:1,userId:userId}:Math.ceil(taskTotal/10)>presentPage?{page:presentPage,userId:userId}:{page:presentPage-1,userId:userId});},[teacherCourseFlag]);var columns=[{title:'实验课程',dataIndex:'courseName',key:'courseName'},{title:'教学班编号',dataIndex:'courseId',key:'courseId'},{title:'教学班备注',dataIndex:'remark',key:'remark'},{title:'课程编号',dataIndex:'courseNumber',key:'courseNumber'},{title:'课程教师',dataIndex:'teacherName',key:'teacherName'},{title:'发布时间',dataIndex:'addTime',key:'addTime'}];return/*#__PURE__*/React.createElement(\"div\",{style:{margin:\"0.625rem\"}},/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\"}},/*#__PURE__*/React.createElement(_Button,{disabled:deleteBtn,style:{margin:\" 0 0.625rem\"},onClick:function onClick(){return confirm({title:'确认删除吗?',onOk:function onOk(){setSelected([]);setDeleteBtn(true);selectedRow.map(function(e){return arr.push(e.teacherCourseId);});handleDeleteTeacherCourse({teacherCourseIdList:arr});setArr([]);},onCancel:function onCancel(){}});}},/*#__PURE__*/React.createElement(_Icon,{type:\"delete\"}),\"\\u5220\\u9664\\u8BFE\\u7A0B\"),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",flexWrap:\"nowrap\",width:\"20rem\"}},/*#__PURE__*/React.createElement(_Select,{defaultValue:\"courseName\",style:{width:\"5.625rem\"},onChange:function onChange(e){return setSearchFlag(e);}},/*#__PURE__*/React.createElement(Option,{value:\"courseName\"},\"\\u8BFE\\u7A0B\\u540D\"),/*#__PURE__*/React.createElement(Option,{value:\"teacherName\"},\"\\u6559\\u5E08\\u540D\")),/*#__PURE__*/React.createElement(Search,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u641C\\u7D22\\u5185\\u5BB9\",onSearch:function onSearch(value){Reg.test(value)?handleSearchCourse(searchFlag===\"teacherName\"?{page:1,teacherName:value,course:\"\",userId:userId}:{page:1,teacherName:\"\",course:value,userId:userId}):handleSearchCourse({page:1,teacherName:\"\",course:\"\",userId:userId});setPresentPage(1);},enterButton:true,style:{width:200}}))),/*#__PURE__*/React.createElement(_Table,{rowKey:function rowKey(record){return record.teacherCourseId;},columns:columns,dataSource:courseResource,pagination:{total:taskTotal,current:presentPage,onChange:function onChange(e){handleFetchCourseRes({page:e,userId:userId});setSelected([]);setPresentPage(e);}},rowSelection:{selectedRowKeys:selected,onChange:function onChange(selectedRowKeys,selectedRows){setSelectedRow(selectedRows);setSelected(selectedRowKeys);selectedRowKeys.length>0?setDeleteBtn(false):setDeleteBtn(true);}}}));};export default connect(function(state){return{taskTotal:state.getIn([\"course\",\"taskTotal\"]),courseResource:state.getIn([\"course\",\"courseResource\"]),courseTask:state.getIn([\"course\",\"courseTask\"]),userId:state.getIn([\"userMana\",\"common\",\"userId\"]),teacherCourseFlag:state.getIn([\"admin\",\"labCourse\",\"teacherCourseFlag\"])};},function(dispatch){return{handleFetchCourseRes:function handleFetchCourseRes(args){dispatch(course.fetchCourse(args));},handleSearchCourse:function handleSearchCourse(args){dispatch(course.fetchSearchCourse(args));},handleDeleteTeacherCourse:function handleDeleteTeacherCourse(args){dispatch(admin.deleteTeacherCourses(args));}};})(TeacherCourse);","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/components/Administrator/TeacherCourse.js"],"names":["React","useEffect","useState","connect","course","admin","Option","Search","Reg","TeacherCourse","props","taskTotal","teacherCourseFlag","userId","courseResource","handleFetchCourseRes","handleDeleteTeacherCourse","handleSearchCourse","selected","setSelected","selectedRow","setSelectedRow","deleteBtn","setDeleteBtn","presentPage","setPresentPage","arr","setArr","searchFlag","setSearchFlag","confirm","page","Math","ceil","columns","title","dataIndex","key","margin","display","onOk","map","e","push","teacherCourseId","teacherCourseIdList","onCancel","flexWrap","width","value","test","teacherName","record","total","current","onChange","selectedRowKeys","selectedRows","length","state","getIn","courseTask","dispatch","args","fetchCourse","fetchSearchCourse","deleteTeacherCourses"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {Table, Button, Icon, Modal, Select, Input} from \"antd\";\r\nimport * as course from \"../../redux/actionCreators/resource\";\r\nimport * as admin from \"../../redux/actionCreators/admin\";\r\nconst { Option } = Select;\r\nconst { Search } = Input;\r\nconst Reg = /^[\\s\\S]*.*[^\\s][\\s\\S]*$/;\r\n\r\nconst TeacherCourse = props => {\r\n    const {taskTotal,teacherCourseFlag,  userId, courseResource, handleFetchCourseRes, handleDeleteTeacherCourse, handleSearchCourse} = props;\r\n    const [selected, setSelected] = useState([]);\r\n    const [selectedRow, setSelectedRow] = useState([]);\r\n    const [deleteBtn, setDeleteBtn] = useState(true);\r\n    const [presentPage, setPresentPage] = useState(1);\r\n    const [arr, setArr] = useState([]);\r\n    const [searchFlag, setSearchFlag] = useState(\"courseName\");\r\n    const { confirm } = Modal;\r\n    useEffect(()=>{\r\n        handleFetchCourseRes(\r\n            presentPage === 1 ?\r\n                {page: 1, userId: userId} :\r\n                (Math.ceil(taskTotal / 10) > presentPage ?\r\n                        {page: presentPage, userId: userId} :\r\n                        {page: presentPage - 1, userId: userId}\r\n                ));\r\n    },[teacherCourseFlag]);\r\n    const columns = [\r\n        { title: '实验课程', dataIndex: 'courseName', key: 'courseName' },\r\n        { title: '教学班编号', dataIndex: 'courseId', key: 'courseId' },\r\n        { title: '教学班备注', dataIndex: 'remark', key: 'remark' },\r\n        { title: '课程编号', dataIndex: 'courseNumber', key: 'courseNumber' },\r\n        { title: '课程教师', dataIndex: 'teacherName', key: 'teacherName' },\r\n        { title: '发布时间', dataIndex: 'addTime', key: 'addTime' },\r\n    ];\r\n    return (\r\n        <div\r\n            style={{margin: \"0.625rem\",}}\r\n        >\r\n            <div\r\n                style={{display: \"flex\", }}\r\n            >\r\n                <Button\r\n                    disabled={deleteBtn}\r\n                    style={{margin: \" 0 0.625rem\"}}\r\n                    onClick={()=>confirm({\r\n                        title: '确认删除吗?',\r\n                        onOk() {\r\n                            setSelected([]);\r\n                            setDeleteBtn(true);\r\n                            selectedRow.map(e => (arr.push(e.teacherCourseId)));\r\n                            handleDeleteTeacherCourse({\r\n                                teacherCourseIdList: arr,\r\n                            });\r\n                            setArr([]);\r\n                        },\r\n                        onCancel() {\r\n                        },\r\n                    })}\r\n                >\r\n                    <Icon type={\"delete\"}/>\r\n                    删除课程\r\n                </Button>\r\n                <div  style={{display: \"flex\", flexWrap: \"nowrap\", width: \"20rem\"}}>\r\n                    <Select\r\n                        defaultValue={\"courseName\"}\r\n                        style={{ width: \"5.625rem\" }}\r\n                        onChange={e=>(setSearchFlag(e))}\r\n                    >\r\n                        <Option value={\"courseName\"}>课程名</Option>\r\n                        <Option value={\"teacherName\"}>教师名</Option>\r\n                    </Select>\r\n                    <Search\r\n                        placeholder=\"请输入搜索内容\"\r\n                        onSearch={(value) =>{\r\n                            Reg.test(value) ?\r\n                                handleSearchCourse(\r\n                                    searchFlag === \"teacherName\" ? {\r\n                                        page: 1,\r\n                                        teacherName: value,\r\n                                        course: \"\",\r\n                                        userId: userId,\r\n                                    } : {\r\n                                        page: 1,\r\n                                        teacherName: \"\",\r\n                                        course: value,\r\n                                        userId: userId\r\n                                    }\r\n                                ) : handleSearchCourse({\r\n                                        page: 1,\r\n                                        teacherName: \"\",\r\n                                        course: \"\",\r\n                                        userId: userId,\r\n                                });\r\n                            setPresentPage(1);\r\n                        }}\r\n                        enterButton\r\n                        style={{ width: 200 }}\r\n                    />\r\n                </div>\r\n            </div>\r\n            <Table\r\n                rowKey={record => record.teacherCourseId}\r\n                columns={columns}\r\n                dataSource={courseResource}\r\n                pagination={{\r\n                    total: taskTotal,\r\n                    current: presentPage,\r\n                    onChange: e => {\r\n                        handleFetchCourseRes({ page: e, userId: userId });\r\n                        setSelected([]);\r\n                        setPresentPage(e);\r\n                    },\r\n                }}\r\n\r\n                rowSelection ={{\r\n                    selectedRowKeys: selected,\r\n                    onChange: (selectedRowKeys, selectedRows) => {\r\n                        setSelectedRow(selectedRows);\r\n                        setSelected(selectedRowKeys);\r\n                        selectedRowKeys.length > 0 ? setDeleteBtn(false) : setDeleteBtn(true);\r\n                    }\r\n                }}\r\n            />\r\n        </div>\r\n    )\r\n\r\n};\r\nexport default connect(\r\n    state => ({\r\n        taskTotal: state.getIn([\"course\", \"taskTotal\"]),\r\n        courseResource: state.getIn([\"course\", \"courseResource\"]),\r\n        courseTask: state.getIn([\"course\", \"courseTask\"]),\r\n        userId: state.getIn([\"userMana\", \"common\", \"userId\"]),\r\n        teacherCourseFlag: state.getIn([\"admin\", \"labCourse\", \"teacherCourseFlag\"])\r\n    }),\r\n    dispatch => ({\r\n        handleFetchCourseRes(args){\r\n            dispatch(course.fetchCourse(args));\r\n        },\r\n        handleSearchCourse(args){\r\n            dispatch(course.fetchSearchCourse(args));\r\n        },\r\n        handleDeleteTeacherCourse(args){\r\n            dispatch(admin.deleteTeacherCourses(args))\r\n        },\r\n    }),\r\n)(TeacherCourse);\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\projects\\\\lab\\\\lab_2.0\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import\"antd/es/message/style/css\";import _message from\"antd/es/message\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(releaseAnnounce),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(editAnnounce),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(deleteAnnounce),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(rootAnnounceSaga);import{takeEvery,put,call}from\"redux-saga/effects\";import Service from\"../../../lib/Service\";import{ADMIN_RELEASE_ANNOUNCE,ADMIN_RELEASE_ANNOUNCE_SUCCESS,ADMIN_EDIT_ANNOUNCE,ADMIN_EDIT_ANNOUNCE_SUCCESS,ADMIN_DELETE_ANNOUNCE,ADMIN_DELETE_ANNOUNCE_SUCCESS}from\"../../../constants/actionTypes\";function releaseAnnounce(args){var _args$args,userName,title,content,file,formData,res;return _regeneratorRuntime.wrap(function releaseAnnounce$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_args$args=args.args,userName=_args$args.userName,title=_args$args.title,content=_args$args.content,file=_args$args.file;formData=new FormData();formData.append('userName',userName);formData.append('title',title);formData.append('content',content);formData.append('file',file);_context.next=9;return call(Service.post,\"admin/addAnnounce\",formData);case 9:res=_context.sent;_context.t0=res.data.error_code;_context.next=_context.t0===0?13:_context.t0===-1?17:_context.t0===1?19:21;break;case 13:_message.success(\"发布成功~\");_context.next=16;return put({type:ADMIN_RELEASE_ANNOUNCE_SUCCESS});case 16:return _context.abrupt(\"break\",22);case 17:_message.error(\"发布失败, 该文件已存在！\");return _context.abrupt(\"break\",22);case 19:_message.error(\"权限不足！\");return _context.abrupt(\"break\",22);case 21:return _context.abrupt(\"return\",0);case 22:_context.next=26;break;case 24:_context.prev=24;_context.t1=_context[\"catch\"](0);case 26:case\"end\":return _context.stop();}}},_marked,null,[[0,24]]);}function editAnnounce(args){var _args$args2,userName,title,content,file,announceId,formData,res;return _regeneratorRuntime.wrap(function editAnnounce$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_args$args2=args.args,userName=_args$args2.userName,title=_args$args2.title,content=_args$args2.content,file=_args$args2.file,announceId=_args$args2.announceId;formData=new FormData();formData.append('userName',userName);formData.append('title',title);formData.append('content',content);formData.append('file',file);formData.append('announceId',announceId);_context2.next=10;return call(Service.post,\"admin/updateAnnounce\",formData);case 10:res=_context2.sent;_context2.t0=res.data.error_code;_context2.next=_context2.t0===0?14:_context2.t0===-1?18:_context2.t0===1?20:22;break;case 14:_message.success(\"修改成功~\");_context2.next=17;return put({type:ADMIN_EDIT_ANNOUNCE_SUCCESS});case 17:return _context2.abrupt(\"break\",23);case 18:_message.error(\"修改失败！\");return _context2.abrupt(\"break\",23);case 20:_message.error(\"权限不足！\");return _context2.abrupt(\"break\",23);case 22:return _context2.abrupt(\"return\",0);case 23:_context2.next=27;break;case 25:_context2.prev=25;_context2.t1=_context2[\"catch\"](0);case 27:case\"end\":return _context2.stop();}}},_marked2,null,[[0,25]]);}function deleteAnnounce(arg){var announceId,formData,res;return _regeneratorRuntime.wrap(function deleteAnnounce$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;announceId=arg.announceId.announceId;formData=new FormData();formData.append(\"announceId\",announceId);_context3.next=6;return call(Service.post,\"admin/deleteAnnounce\",formData);case 6:res=_context3.sent;_context3.t0=res.data.error_code;_context3.next=_context3.t0===0?10:_context3.t0===-1?14:16;break;case 10:_context3.next=12;return put({type:ADMIN_DELETE_ANNOUNCE_SUCCESS});case 12:_message.success(res.data.message);return _context3.abrupt(\"break\",17);case 14:_message.error(\"删除失败！\");return _context3.abrupt(\"break\",17);case 16:return _context3.abrupt(\"return\",0);case 17:_context3.next=21;break;case 19:_context3.prev=19;_context3.t1=_context3[\"catch\"](0);case 21:case\"end\":return _context3.stop();}}},_marked3,null,[[0,19]]);}export default function rootAnnounceSaga(){return _regeneratorRuntime.wrap(function rootAnnounceSaga$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeEvery(ADMIN_RELEASE_ANNOUNCE,releaseAnnounce);case 2:_context4.next=4;return takeEvery(ADMIN_DELETE_ANNOUNCE,deleteAnnounce);case 4:_context4.next=6;return takeEvery(ADMIN_EDIT_ANNOUNCE,editAnnounce);case 6:case\"end\":return _context4.stop();}}},_marked4);}","map":{"version":3,"sources":["C:/projects/lab/lab_2.0/src/redux/sagas/adminSagas/labAnnounce.js"],"names":["releaseAnnounce","editAnnounce","deleteAnnounce","rootAnnounceSaga","takeEvery","put","call","Service","ADMIN_RELEASE_ANNOUNCE","ADMIN_RELEASE_ANNOUNCE_SUCCESS","ADMIN_EDIT_ANNOUNCE","ADMIN_EDIT_ANNOUNCE_SUCCESS","ADMIN_DELETE_ANNOUNCE","ADMIN_DELETE_ANNOUNCE_SUCCESS","args","userName","title","content","file","formData","FormData","append","post","res","data","error_code","success","type","error","announceId","arg","message"],"mappings":"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","sourcesContent":["import { takeEvery, put, call } from \"redux-saga/effects\";\r\nimport Service from \"../../../lib/Service\";\r\nimport { message } from \"antd\";\r\nimport {\r\n    ADMIN_RELEASE_ANNOUNCE,\r\n    ADMIN_RELEASE_ANNOUNCE_SUCCESS,\r\n    ADMIN_EDIT_ANNOUNCE,\r\n    ADMIN_EDIT_ANNOUNCE_SUCCESS,\r\n    ADMIN_DELETE_ANNOUNCE,\r\n    ADMIN_DELETE_ANNOUNCE_SUCCESS,\r\n} from \"../../../constants/actionTypes\";\r\n\r\nfunction *releaseAnnounce(args) {\r\n    try {\r\n        const {userName, title, content, file} = args.args;\r\n        const formData = new FormData();\r\n        formData.append('userName', userName);\r\n        formData.append('title', title);\r\n        formData.append('content', content);\r\n        formData.append('file', file);\r\n        const res = yield call(Service.post, `admin/addAnnounce`, formData);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                message.success(\"发布成功~\");\r\n                yield put({\r\n                    type: ADMIN_RELEASE_ANNOUNCE_SUCCESS,\r\n                });\r\n                break;\r\n            case -1:\r\n                message.error(\"发布失败, 该文件已存在！\");\r\n                break;\r\n            case 1:\r\n                message.error(\"权限不足！\");\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\nfunction *editAnnounce(args) {\r\n    try {\r\n        const {userName, title, content, file, announceId} = args.args;\r\n        const formData = new FormData();\r\n        formData.append('userName', userName);\r\n        formData.append('title', title);\r\n        formData.append('content', content);\r\n        formData.append('file', file);\r\n        formData.append('announceId', announceId);\r\n        const res = yield call(Service.post, `admin/updateAnnounce`, formData);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                message.success(\"修改成功~\");\r\n                yield put({\r\n                    type: ADMIN_EDIT_ANNOUNCE_SUCCESS,\r\n                });\r\n                break;\r\n            case -1:\r\n                message.error(\"修改失败！\");\r\n                break;\r\n            case 1:\r\n                message.error(\"权限不足！\");\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch (e) {\r\n\r\n    }\r\n}\r\nfunction* deleteAnnounce(arg) {\r\n    try {\r\n        const {announceId} = arg.announceId;\r\n        const formData = new FormData;\r\n        formData.append(\"announceId\", announceId );\r\n\r\n        const res = yield call(Service.post, `admin/deleteAnnounce`, formData);\r\n        switch (res.data.error_code) {\r\n            case 0:\r\n                yield put({\r\n                    type: ADMIN_DELETE_ANNOUNCE_SUCCESS,\r\n                });\r\n                message.success(res.data.message);\r\n                break;\r\n            case -1:\r\n                message.error(\"删除失败！\");\r\n                break;\r\n            default:\r\n                return 0;\r\n        }\r\n    }\r\n    catch(e){\r\n\r\n    }\r\n}\r\n\r\nexport default function* rootAnnounceSaga() {\r\n    yield takeEvery(ADMIN_RELEASE_ANNOUNCE, releaseAnnounce);\r\n    yield takeEvery(ADMIN_DELETE_ANNOUNCE, deleteAnnounce);\r\n    yield takeEvery(ADMIN_EDIT_ANNOUNCE, editAnnounce);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}